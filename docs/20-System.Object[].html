<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 19: Add-ins vs Scripts – Scripting Sparx Enterprise Architect: A Practical Handbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./21-System.Object[].html" rel="next">
<link href="./19-System.Object[].html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b4ddde2c4c77ed14ccfa95278770da4f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./20-System.Object[].html"><span class="chapter-title">Chapter 19: Add-ins vs Scripts</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Scripting Sparx Enterprise Architect: A Practical Handbook</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Scripting Sparx Enterprise Architect</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 1: Why Script EA?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 2: Automation Landscape</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3: Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 4: API Essentials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 5: Inside EA with JScript</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 6: External Automation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 7: Script Design Patterns</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 8: Object Details</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 9: Imports &amp; Exports</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 10: MDG-Aware Scripting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 11: Governance Scripts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 12: Cookbook of Examples</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 13: Why AI Helps</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 14: Prompt Engineering</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 15: AI Refactoring Partner</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 16: AI in Daily Workflow</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 17: Performance &amp; Scaling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 18: Integrating with Workflows</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-System.Object[].html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Chapter 19: Add-ins vs Scripts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 20: Troubleshooting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 21: Reference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix A: Scripting Constraints</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix B: External Automation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix C: Glossary of Terms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix D: Quick Reference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix E: External Automation Setup</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#scripts-as-the-first-line-of-automation" id="toc-scripts-as-the-first-line-of-automation" class="nav-link active" data-scroll-target="#scripts-as-the-first-line-of-automation">Scripts as the First Line of Automation</a></li>
  <li><a href="#add-ins-as-compiled-extensions" id="toc-add-ins-as-compiled-extensions" class="nav-link" data-scroll-target="#add-ins-as-compiled-extensions">Add-ins as Compiled Extensions</a></li>
  <li><a href="#why-move-from-script-to-add-in" id="toc-why-move-from-script-to-add-in" class="nav-link" data-scroll-target="#why-move-from-script-to-add-in">Why Move from Script to Add-in?</a></li>
  <li><a href="#trade-offs" id="toc-trade-offs" class="nav-link" data-scroll-target="#trade-offs">Trade-offs</a></li>
  <li><a href="#add-ins-and-governance" id="toc-add-ins-and-governance" class="nav-link" data-scroll-target="#add-ins-and-governance">Add-ins and Governance</a></li>
  <li><a href="#the-learning-curve" id="toc-the-learning-curve" class="nav-link" data-scroll-target="#the-learning-curve">The Learning Curve</a></li>
  <li><a href="#a-progressive-path" id="toc-a-progressive-path" class="nav-link" data-scroll-target="#a-progressive-path">A Progressive Path</a></li>
  <li><a href="#cultural-impact" id="toc-cultural-impact" class="nav-link" data-scroll-target="#cultural-impact">Cultural Impact</a></li>
  <li><a href="#risks-of-add-ins" id="toc-risks-of-add-ins" class="nav-link" data-scroll-target="#risks-of-add-ins">Risks of Add-ins</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a>
  <ul class="collapse">
  <li><a href="#minimal-c-add-in" id="toc-minimal-c-add-in" class="nav-link" data-scroll-target="#minimal-c-add-in">Minimal C# Add-in</a></li>
  <li><a href="#build-register-the-add-in" id="toc-build-register-the-add-in" class="nav-link" data-scroll-target="#build-register-the-add-in">Build &amp; Register the Add-in</a></li>
  </ul></li>
  <li><a href="#when-to-migrate-script-add-in" id="toc-when-to-migrate-script-add-in" class="nav-link" data-scroll-target="#when-to-migrate-script-add-in">When to Migrate Script → Add-in</a></li>
  <li><a href="#migration-example" id="toc-migration-example" class="nav-link" data-scroll-target="#migration-example">Migration Example</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">Chapter 19: Add-ins vs Scripts</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Up to this point, we have focused mainly on scripts that live inside Enterprise Architect or run against it externally through the automation interface. These approaches are flexible, fast to develop, and ideal for governance checks, imports and exports, and targeted utilities. But there comes a point when scripts start to feel limited. You may want permanent menus, event handlers that react when users create elements, or deeper integration with EA’s user interface. At this stage, you move beyond scripts and begin thinking in terms of <strong>Add-ins</strong>.</p>
<p>This chapter explores the boundary between scripts and add-ins. It explains what each approach is best suited for, why organisations sometimes make the leap to add-ins, and what the trade-offs are in terms of power, safety, and maintainability. The aim is not to suggest that every script should become an add-in, but to show you the decision space clearly so you can choose the right tool for the job.</p>
<section id="scripts-as-the-first-line-of-automation" class="level2">
<h2 class="anchored" data-anchor-id="scripts-as-the-first-line-of-automation">Scripts as the First Line of Automation</h2>
<p>Scripts are the natural starting point for automation in EA. They are:</p>
<ul>
<li><p><strong>Easy to create</strong>: no extra tools beyond EA itself.</p></li>
<li><p><strong>Portable</strong>: stored in the repository, available to all users.</p></li>
<li><p><strong>Quick to test</strong>: you can write a script in the morning and run it that afternoon.</p></li>
</ul>
<p>For governance, imports/exports, and small utilities, scripts are ideal. They reduce friction, allow experimentation, and empower modellers who are not professional developers.</p>
<p>However, scripts also have <strong>limitations</strong>:</p>
<ul>
<li><p>They cannot add permanent menus or toolbars.</p></li>
<li><p>They cannot hook into events (e.g.&nbsp;“element created”).</p></li>
<li><p>They are tied to a specific repository rather than installed globally.</p></li>
<li><p>They are confined to JScript or VBScript, with limited libraries.</p></li>
</ul>
<p>When you hit these walls, it is time to consider add-ins.</p>
</section>
<section id="add-ins-as-compiled-extensions" class="level2">
<h2 class="anchored" data-anchor-id="add-ins-as-compiled-extensions">Add-ins as Compiled Extensions</h2>
<p>An <strong>Add-in</strong> is a compiled .NET assembly (usually in C#) that EA loads at startup. It is registered in the Windows Registry under the EAAddins key, marked COM-visible, and referenced by EA as if it were part of the application.</p>
<p>Add-ins can:</p>
<ul>
<li><p>Add menus and toolbars to EA’s UI.</p></li>
<li><p>Respond to events like element creation, diagram opening, or project closing.</p></li>
<li><p>Use the full power of .NET libraries, from JSON parsing to REST APIs.</p></li>
<li><p>Provide custom docked windows and richer user interfaces.</p></li>
</ul>
<p>In short, add-ins let you extend EA itself, turning one-off utilities into permanent, user-friendly tools.</p>
</section>
<section id="why-move-from-script-to-add-in" class="level2">
<h2 class="anchored" data-anchor-id="why-move-from-script-to-add-in">Why Move from Script to Add-in?</h2>
<p>Organisations usually move from script to add-in for one or more of these reasons:</p>
<ul>
<li><p><strong>Distribution</strong>: a script stored in one repository is not visible in another; an add-in installed on all workstations is.</p></li>
<li><p><strong>Consistency</strong>: add-ins provide the same menus for everyone, ensuring a common experience.</p></li>
<li><p><strong>Events</strong>: only add-ins can react to events (e.g.&nbsp;auto-tag new elements).</p></li>
<li><p><strong>Professionalisation</strong>: mature utilities become part of a toolset rather than ad hoc snippets.</p></li>
<li><p><strong>Integration</strong>: add-ins can use advanced libraries and UI frameworks.</p></li>
</ul>
</section>
<section id="trade-offs" class="level2">
<h2 class="anchored" data-anchor-id="trade-offs">Trade-offs</h2>
<p>The move to add-ins brings benefits, but also costs.</p>
<p><strong>Advantages of Add-ins:</strong></p>
<ul>
<li><p>Richer features (menus, events, UI).</p></li>
<li><p>Strong typing (C#, VB.NET).</p></li>
<li><p>Access to modern libraries.</p></li>
<li><p>Professional distribution and versioning.</p></li>
</ul>
<p><strong>Disadvantages of Add-ins:</strong></p>
<ul>
<li><p>More setup (Visual Studio, COM registration).</p></li>
<li><p>Distribution overhead (must be installed on each machine).</p></li>
<li><p>Debugging complexity (requires attaching to EA process).</p></li>
<li><p>Higher governance burden (DLLs need version control and change management).</p></li>
</ul>
<p>In other words, add-ins are heavier. They make sense when a solution is stable and widely used, but they are overkill for experimental or repository-specific tasks.</p>
</section>
<section id="add-ins-and-governance" class="level2">
<h2 class="anchored" data-anchor-id="add-ins-and-governance">Add-ins and Governance</h2>
<p>One of the subtle reasons to move to add-ins is governance. Scripts are flexible but ephemeral; anyone can change them in the repository. Add-ins, by contrast, are compiled, versioned, and distributed. This makes them better suited to regulated environments where tools must be controlled.</p>
<p>For example, a bank may insist that only signed add-ins are used, ensuring all automation has passed security checks. Scripts may still exist for local use, but official tooling is delivered as add-ins.</p>
</section>
<section id="the-learning-curve" class="level2">
<h2 class="anchored" data-anchor-id="the-learning-curve">The Learning Curve</h2>
<p>Writing add-ins requires more development skill than writing scripts. You need to:</p>
<ul>
<li><p>Set up a Class Library project in Visual Studio.</p></li>
<li><p>Add a reference to Interop.EA.dll.</p></li>
<li><p>Mark the assembly COM-visible.</p></li>
<li><p>Register it with regasm or an installer.</p></li>
<li><p>Implement required methods like EA_Connect, EA_Disconnect, EA_GetMenuItems, and EA_MenuClick.</p></li>
</ul>
<p>This is more demanding than writing JScript in EA’s built-in editor. But it opens far greater possibilities.</p>
</section>
<section id="a-progressive-path" class="level2">
<h2 class="anchored" data-anchor-id="a-progressive-path">A Progressive Path</h2>
<p>A useful way to think about the script/add-in distinction is as a path:</p>
<ul>
<li><p><strong>Scripts</strong> — fast, flexible, repository-bound.</p></li>
<li><p><strong>External Automation</strong> — Python or C# utilities that integrate EA into enterprise workflows.</p></li>
<li><p><strong>Add-ins</strong> — compiled, distributed, integrated extensions.</p></li>
</ul>
<p>Teams often move along this path naturally. A script solves a local problem. Later it becomes an external utility. Finally, it matures into an add-in for permanent use. Understanding this path helps you decide when to invest in the extra effort of an add-in.</p>
</section>
<section id="cultural-impact" class="level2">
<h2 class="anchored" data-anchor-id="cultural-impact">Cultural Impact</h2>
<p>The choice between scripts and add-ins also shapes team culture. Scripts empower modellers; add-ins formalise tools. Too much reliance on add-ins can discourage experimentation. Too much reliance on scripts can create chaos. The healthiest culture balances the two: scripts for flexibility, add-ins for stability.</p>
</section>
<section id="risks-of-add-ins" class="level2">
<h2 class="anchored" data-anchor-id="risks-of-add-ins">Risks of Add-ins</h2>
<p>Because add-ins load at EA startup, errors in add-ins can be disruptive. A badly written add-in may prevent menus from loading, slow down EA, or crash the application. This risk means testing and version control are even more critical than for scripts.</p>
</section>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<section id="minimal-c-add-in" class="level3">
<h3 class="anchored" data-anchor-id="minimal-c-add-in">Minimal C# Add-in</h3>
<p>Here’s a <strong>minimal C# Add-in</strong>. It adds a menu under <strong>Specialize → MyAddin → Hello</strong>. When clicked, it shows a message box.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 19.1 - MyAddin.cs – Minimal EA Add-in</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" data-filename="Example 19.1 - MyAddin.cs – Minimal EA Add-in"><pre class="sourceCode numberSource cs number-lines code-with-copy"><code class="sourceCode cs"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">// Example 19.1 - MyAddin.cs – Minimal EA Add-in</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">// Purpose: Demonstrate how to build a COM-visible add-in</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">// Notes:</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">//   - Build as Class Library (.NET Framework, not .NET Core).</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">//   - Mark assembly COM-visible.</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">//   - Register DLL with regasm or installer.</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">using</span> System<span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="kw">using</span> System<span class="op">.</span><span class="fu">Runtime</span><span class="op">.</span><span class="fu">InteropServices</span><span class="op">;</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="kw">using</span> EA<span class="op">;</span> <span class="co">// Reference to Interop.EA.dll (from EA install folder)</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="kw">using</span> System<span class="op">.</span><span class="fu">Windows</span><span class="op">.</span><span class="fu">Forms</span><span class="op">;</span></span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="kw">namespace</span> MyAddin</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="op">{</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>    <span class="op">[</span><span class="fu">ComVisible</span><span class="op">(</span><span class="kw">true</span><span class="op">)]</span>                 <span class="co">// Required for COM</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>    <span class="op">[</span><span class="fu">ClassInterface</span><span class="op">(</span>ClassInterfaceType<span class="op">.</span><span class="fu">None</span><span class="op">)]</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>    <span class="kw">public</span> <span class="kw">class</span> MyAddinClass</span>
<span id="cb1-19"><a href="#cb1-19"></a>    <span class="op">{</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>        <span class="co">// EA calls this at connection</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>        <span class="kw">public</span> <span class="dt">string</span> <span class="fu">EA_Connect</span><span class="op">(</span>Repository Repository<span class="op">)</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>        <span class="op">{</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>            <span class="kw">return</span> <span class="st">"a string"</span><span class="op">;</span>         <span class="co">// Reserved, can be anything</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>        <span class="op">}</span></span>
<span id="cb1-25"><a href="#cb1-25"></a></span>
<span id="cb1-26"><a href="#cb1-26"></a>        <span class="kw">public</span> <span class="dt">void</span> <span class="fu">EA_Disconnect</span><span class="op">()</span></span>
<span id="cb1-27"><a href="#cb1-27"></a>        <span class="op">{</span></span>
<span id="cb1-28"><a href="#cb1-28"></a>            <span class="co">// Cleanup if needed</span></span>
<span id="cb1-29"><a href="#cb1-29"></a>        <span class="op">}</span></span>
<span id="cb1-30"><a href="#cb1-30"></a></span>
<span id="cb1-31"><a href="#cb1-31"></a>        <span class="co">// ---- Menu Integration ----</span></span>
<span id="cb1-32"><a href="#cb1-32"></a></span>
<span id="cb1-33"><a href="#cb1-33"></a>        <span class="co">// Tell EA which menu root to show</span></span>
<span id="cb1-34"><a href="#cb1-34"></a>        <span class="kw">public</span> <span class="dt">object</span> <span class="fu">EA_GetMenuItems</span><span class="op">(</span>Repository Repository<span class="op">,</span> <span class="dt">string</span> Location<span class="op">,</span> <span class="dt">string</span> MenuName<span class="op">)</span></span>
<span id="cb1-35"><a href="#cb1-35"></a>        <span class="op">{</span></span>
<span id="cb1-36"><a href="#cb1-36"></a>            <span class="kw">if</span> <span class="op">(</span>MenuName <span class="op">==</span> <span class="st">""</span><span class="op">)</span></span>
<span id="cb1-37"><a href="#cb1-37"></a>                <span class="kw">return</span> <span class="st">"MyAddin"</span><span class="op">;</span>      <span class="co">// Root menu</span></span>
<span id="cb1-38"><a href="#cb1-38"></a>            <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span>MenuName <span class="op">==</span> <span class="st">"MyAddin"</span><span class="op">)</span></span>
<span id="cb1-39"><a href="#cb1-39"></a>                <span class="kw">return</span> <span class="st">"Hello"</span><span class="op">;</span>        <span class="co">// Submenu item</span></span>
<span id="cb1-40"><a href="#cb1-40"></a>            <span class="kw">return</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb1-41"><a href="#cb1-41"></a>        <span class="op">}</span></span>
<span id="cb1-42"><a href="#cb1-42"></a></span>
<span id="cb1-43"><a href="#cb1-43"></a>        <span class="co">// Control enabled/disabled state</span></span>
<span id="cb1-44"><a href="#cb1-44"></a>        <span class="kw">public</span> <span class="dt">bool</span> <span class="fu">EA_GetMenuState</span><span class="op">(</span>Repository Repository<span class="op">,</span> <span class="dt">string</span> Location<span class="op">,</span> <span class="dt">string</span> MenuName<span class="op">,</span> <span class="dt">string</span> ItemName<span class="op">,</span> <span class="kw">ref</span> <span class="dt">bool</span> IsEnabled<span class="op">,</span> <span class="kw">ref</span> <span class="dt">bool</span> IsChecked<span class="op">)</span></span>
<span id="cb1-45"><a href="#cb1-45"></a>        <span class="op">{</span></span>
<span id="cb1-46"><a href="#cb1-46"></a>            IsEnabled <span class="op">=</span> <span class="kw">true</span><span class="op">;</span>          <span class="co">// Always enabled</span></span>
<span id="cb1-47"><a href="#cb1-47"></a>            <span class="kw">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb1-48"><a href="#cb1-48"></a>        <span class="op">}</span></span>
<span id="cb1-49"><a href="#cb1-49"></a></span>
<span id="cb1-50"><a href="#cb1-50"></a>        <span class="co">// Handle click events</span></span>
<span id="cb1-51"><a href="#cb1-51"></a>        <span class="kw">public</span> <span class="dt">void</span> <span class="fu">EA_MenuClick</span><span class="op">(</span>Repository Repository<span class="op">,</span> <span class="dt">string</span> Location<span class="op">,</span> <span class="dt">string</span> MenuName<span class="op">,</span> <span class="dt">string</span> ItemName<span class="op">)</span></span>
<span id="cb1-52"><a href="#cb1-52"></a>        <span class="op">{</span></span>
<span id="cb1-53"><a href="#cb1-53"></a>            <span class="kw">if</span> <span class="op">(</span>MenuName <span class="op">==</span> <span class="st">"MyAddin"</span> <span class="op">&amp;&amp;</span> ItemName <span class="op">==</span> <span class="st">"Hello"</span><span class="op">)</span></span>
<span id="cb1-54"><a href="#cb1-54"></a>            <span class="op">{</span></span>
<span id="cb1-55"><a href="#cb1-55"></a>                MessageBox<span class="op">.</span><span class="fu">Show</span><span class="op">(</span><span class="st">"Hello from MyAddin!"</span><span class="op">,</span> <span class="st">"EA Add-in"</span><span class="op">);</span></span>
<span id="cb1-56"><a href="#cb1-56"></a>            <span class="op">}</span></span>
<span id="cb1-57"><a href="#cb1-57"></a>        <span class="op">}</span></span>
<span id="cb1-58"><a href="#cb1-58"></a>    <span class="op">}</span></span>
<span id="cb1-59"><a href="#cb1-59"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="build-register-the-add-in" class="level3">
<h3 class="anchored" data-anchor-id="build-register-the-add-in">Build &amp; Register the Add-in</h3>
<ol type="1">
<li>In Visual Studio:</li>
</ol>
<ul>
<li><p>Create a <strong>Class Library (.NET Framework)</strong> project (e.g., .NET Framework 4.7.2).</p></li>
<li><p>Add reference to Interop.EA.dll (found in EA’s install folder).</p></li>
<li><p>Ensure AssemblyInfo.cs has [assembly: ComVisible(true)].</p></li>
</ul>
<ol start="2" type="1">
<li><p>Build the DLL.</p></li>
<li><p>Register it for COM (run as admin):</p></li>
<li><p>regasm MyAddin.dll /codebase</p></li>
<li><p>Add registry entry for EA (HKCU or HKLM):</p></li>
<li><p><code>\[HKEY_CURRENT_USER\Software\Sparx Systems\EAAddins\MyAddin\]</code></p></li>
<li><p>@=“MyAddin.MyAddinClass”</p></li>
<li><p>Restart EA → check <strong>Specialize → Manage Add-ins</strong>. Enable <strong>MyAddin</strong>.</p></li>
</ol>
</section>
</section>
<section id="when-to-migrate-script-add-in" class="level2">
<h2 class="anchored" data-anchor-id="when-to-migrate-script-add-in">When to Migrate Script → Add-in</h2>
<p>Stick with <strong>Scripts</strong> when:</p>
<ul>
<li><p>One-off bulk edits or imports.</p></li>
<li><p>Repository-specific governance checks.</p></li>
<li><p>You don’t need UI menus.</p></li>
</ul>
<p>Move to <strong>Add-ins</strong> when:</p>
<ul>
<li><p>You want consistent menu items for all users.</p></li>
<li><p>You need .NET libraries (e.g., JSON.NET, REST SDK).</p></li>
<li><p>You want event handling (e.g., auto-tag new elements).</p></li>
<li><p>Distribution is across many repositories.</p></li>
</ul>
</section>
<section id="migration-example" class="level2">
<h2 class="anchored" data-anchor-id="migration-example">Migration Example</h2>
<p><strong>Governance Script (inside EA)</strong> → “Enforce Owner tag on all Requirements.”<br>
When matured into an <strong>Add-in</strong>:</p>
<ul>
<li><p>Provide a permanent menu item <em>“Governance → Enforce Tags”</em>.</p></li>
<li><p>Use events: EA_OnElementCreated → auto-add Owner tag.</p></li>
<li><p>Add reporting form with filtering, progress bar, export button.</p></li>
</ul>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<ul>
<li><p><strong>Scripts</strong> are lightweight, repository-local, and quick.</p></li>
<li><p><strong>Add-ins</strong> are heavy-duty, system-wide, and extensible.</p></li>
<li><p>Migration path: prove with scripts → formalise as Add-in when stable.</p></li>
<li><p>Minimal Add-in = COM-visible C# class, a registry key, and menu methods.</p></li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script>

document.addEventListener('DOMContentLoaded', function () {

  // Prefer the margin sidebar if it exists; otherwise try the TOC sidebar.

  const margin = document.querySelector('#quarto-margin-sidebar, .margin-sidebar, .column-margin');

  const toc    = document.querySelector('nav#TOC');

  const sidebar = margin || (toc && toc.closest('.sidebar, .quarto-sidebar, .margin-sidebar'));



  if (!sidebar) return; // no margin column on this layout



  const holder = document.createElement('div');

  holder.className = 'cover-above-toc';

  holder.innerHTML = `

    <a href="index.html">

      <img src="images/cover.png" alt="Book cover" class="cover-above-toc__img" width="140" />

    </a>

  `;

  sidebar.prepend(holder);

});

</script>



<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./19-System.Object[].html" class="pagination-link" aria-label="Chapter 18: Integrating with Workflows">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Chapter 18: Integrating with Workflows</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./21-System.Object[].html" class="pagination-link" aria-label="Chapter 20: Troubleshooting">
        <span class="nav-page-text"><span class="chapter-title">Chapter 20: Troubleshooting</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu"># Chapter 19: Add-ins vs Scripts</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a>Up to this point, we have focused mainly on scripts that live inside</span>
<span id="cb2-4"><a href="#cb2-4"></a>Enterprise Architect or run against it externally through the automation</span>
<span id="cb2-5"><a href="#cb2-5"></a>interface. These approaches are flexible, fast to develop, and ideal for</span>
<span id="cb2-6"><a href="#cb2-6"></a>governance checks, imports and exports, and targeted utilities. But</span>
<span id="cb2-7"><a href="#cb2-7"></a>there comes a point when scripts start to feel limited. You may want</span>
<span id="cb2-8"><a href="#cb2-8"></a>permanent menus, event handlers that react when users create elements,</span>
<span id="cb2-9"><a href="#cb2-9"></a>or deeper integration with EA’s user interface. At this stage, you move</span>
<span id="cb2-10"><a href="#cb2-10"></a>beyond scripts and begin thinking in terms of **Add-ins**.</span>
<span id="cb2-11"><a href="#cb2-11"></a></span>
<span id="cb2-12"><a href="#cb2-12"></a>This chapter explores the boundary between scripts and add-ins. It</span>
<span id="cb2-13"><a href="#cb2-13"></a>explains what each approach is best suited for, why organisations</span>
<span id="cb2-14"><a href="#cb2-14"></a>sometimes make the leap to add-ins, and what the trade-offs are in terms</span>
<span id="cb2-15"><a href="#cb2-15"></a>of power, safety, and maintainability. The aim is not to suggest that</span>
<span id="cb2-16"><a href="#cb2-16"></a>every script should become an add-in, but to show you the decision space</span>
<span id="cb2-17"><a href="#cb2-17"></a>clearly so you can choose the right tool for the job.</span>
<span id="cb2-18"><a href="#cb2-18"></a></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="fu">## Scripts as the First Line of Automation</span></span>
<span id="cb2-20"><a href="#cb2-20"></a></span>
<span id="cb2-21"><a href="#cb2-21"></a>Scripts are the natural starting point for automation in EA. They are:</span>
<span id="cb2-22"><a href="#cb2-22"></a></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="ss">- </span>**Easy to create**: no extra tools beyond EA itself.</span>
<span id="cb2-24"><a href="#cb2-24"></a></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="ss">- </span>**Portable**: stored in the repository, available to all users.</span>
<span id="cb2-26"><a href="#cb2-26"></a></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="ss">- </span>**Quick to test**: you can write a script in the morning and run it</span>
<span id="cb2-28"><a href="#cb2-28"></a>  that afternoon.</span>
<span id="cb2-29"><a href="#cb2-29"></a></span>
<span id="cb2-30"><a href="#cb2-30"></a>For governance, imports/exports, and small utilities, scripts are ideal.</span>
<span id="cb2-31"><a href="#cb2-31"></a>They reduce friction, allow experimentation, and empower modellers who</span>
<span id="cb2-32"><a href="#cb2-32"></a>are not professional developers.</span>
<span id="cb2-33"><a href="#cb2-33"></a></span>
<span id="cb2-34"><a href="#cb2-34"></a>However, scripts also have **limitations**:</span>
<span id="cb2-35"><a href="#cb2-35"></a></span>
<span id="cb2-36"><a href="#cb2-36"></a><span class="ss">- </span>They cannot add permanent menus or toolbars.</span>
<span id="cb2-37"><a href="#cb2-37"></a></span>
<span id="cb2-38"><a href="#cb2-38"></a><span class="ss">- </span>They cannot hook into events (e.g. “element created”).</span>
<span id="cb2-39"><a href="#cb2-39"></a></span>
<span id="cb2-40"><a href="#cb2-40"></a><span class="ss">- </span>They are tied to a specific repository rather than installed globally.</span>
<span id="cb2-41"><a href="#cb2-41"></a></span>
<span id="cb2-42"><a href="#cb2-42"></a><span class="ss">- </span>They are confined to JScript or VBScript, with limited libraries.</span>
<span id="cb2-43"><a href="#cb2-43"></a></span>
<span id="cb2-44"><a href="#cb2-44"></a>When you hit these walls, it is time to consider add-ins.</span>
<span id="cb2-45"><a href="#cb2-45"></a></span>
<span id="cb2-46"><a href="#cb2-46"></a><span class="fu">## Add-ins as Compiled Extensions</span></span>
<span id="cb2-47"><a href="#cb2-47"></a></span>
<span id="cb2-48"><a href="#cb2-48"></a>An **Add-in** is a compiled .NET assembly (usually in C#) that EA loads</span>
<span id="cb2-49"><a href="#cb2-49"></a>at startup. It is registered in the Windows Registry under the EAAddins</span>
<span id="cb2-50"><a href="#cb2-50"></a>key, marked COM-visible, and referenced by EA as if it were part of the</span>
<span id="cb2-51"><a href="#cb2-51"></a>application.</span>
<span id="cb2-52"><a href="#cb2-52"></a></span>
<span id="cb2-53"><a href="#cb2-53"></a>Add-ins can:</span>
<span id="cb2-54"><a href="#cb2-54"></a></span>
<span id="cb2-55"><a href="#cb2-55"></a><span class="ss">- </span>Add menus and toolbars to EA’s UI.</span>
<span id="cb2-56"><a href="#cb2-56"></a></span>
<span id="cb2-57"><a href="#cb2-57"></a><span class="ss">- </span>Respond to events like element creation, diagram opening, or project</span>
<span id="cb2-58"><a href="#cb2-58"></a>  closing.</span>
<span id="cb2-59"><a href="#cb2-59"></a></span>
<span id="cb2-60"><a href="#cb2-60"></a><span class="ss">- </span>Use the full power of .NET libraries, from JSON parsing to REST APIs.</span>
<span id="cb2-61"><a href="#cb2-61"></a></span>
<span id="cb2-62"><a href="#cb2-62"></a><span class="ss">- </span>Provide custom docked windows and richer user interfaces.</span>
<span id="cb2-63"><a href="#cb2-63"></a></span>
<span id="cb2-64"><a href="#cb2-64"></a>In short, add-ins let you extend EA itself, turning one-off utilities</span>
<span id="cb2-65"><a href="#cb2-65"></a>into permanent, user-friendly tools.</span>
<span id="cb2-66"><a href="#cb2-66"></a></span>
<span id="cb2-67"><a href="#cb2-67"></a><span class="fu">## Why Move from Script to Add-in?</span></span>
<span id="cb2-68"><a href="#cb2-68"></a></span>
<span id="cb2-69"><a href="#cb2-69"></a>Organisations usually move from script to add-in for one or more of</span>
<span id="cb2-70"><a href="#cb2-70"></a>these reasons:</span>
<span id="cb2-71"><a href="#cb2-71"></a></span>
<span id="cb2-72"><a href="#cb2-72"></a><span class="ss">- </span>**Distribution**: a script stored in one repository is not visible in</span>
<span id="cb2-73"><a href="#cb2-73"></a>  another; an add-in installed on all workstations is.</span>
<span id="cb2-74"><a href="#cb2-74"></a></span>
<span id="cb2-75"><a href="#cb2-75"></a><span class="ss">- </span>**Consistency**: add-ins provide the same menus for everyone, ensuring</span>
<span id="cb2-76"><a href="#cb2-76"></a>  a common experience.</span>
<span id="cb2-77"><a href="#cb2-77"></a></span>
<span id="cb2-78"><a href="#cb2-78"></a><span class="ss">- </span>**Events**: only add-ins can react to events (e.g. auto-tag new</span>
<span id="cb2-79"><a href="#cb2-79"></a>  elements).</span>
<span id="cb2-80"><a href="#cb2-80"></a></span>
<span id="cb2-81"><a href="#cb2-81"></a><span class="ss">- </span>**Professionalisation**: mature utilities become part of a toolset</span>
<span id="cb2-82"><a href="#cb2-82"></a>  rather than ad hoc snippets.</span>
<span id="cb2-83"><a href="#cb2-83"></a></span>
<span id="cb2-84"><a href="#cb2-84"></a><span class="ss">- </span>**Integration**: add-ins can use advanced libraries and UI frameworks.</span>
<span id="cb2-85"><a href="#cb2-85"></a></span>
<span id="cb2-86"><a href="#cb2-86"></a><span class="fu">## Trade-offs</span></span>
<span id="cb2-87"><a href="#cb2-87"></a></span>
<span id="cb2-88"><a href="#cb2-88"></a>The move to add-ins brings benefits, but also costs.</span>
<span id="cb2-89"><a href="#cb2-89"></a></span>
<span id="cb2-90"><a href="#cb2-90"></a>**Advantages of Add-ins:**</span>
<span id="cb2-91"><a href="#cb2-91"></a></span>
<span id="cb2-92"><a href="#cb2-92"></a><span class="ss">- </span>Richer features (menus, events, UI).</span>
<span id="cb2-93"><a href="#cb2-93"></a></span>
<span id="cb2-94"><a href="#cb2-94"></a><span class="ss">- </span>Strong typing (C#, VB.NET).</span>
<span id="cb2-95"><a href="#cb2-95"></a></span>
<span id="cb2-96"><a href="#cb2-96"></a><span class="ss">- </span>Access to modern libraries.</span>
<span id="cb2-97"><a href="#cb2-97"></a></span>
<span id="cb2-98"><a href="#cb2-98"></a><span class="ss">- </span>Professional distribution and versioning.</span>
<span id="cb2-99"><a href="#cb2-99"></a></span>
<span id="cb2-100"><a href="#cb2-100"></a>**Disadvantages of Add-ins:**</span>
<span id="cb2-101"><a href="#cb2-101"></a></span>
<span id="cb2-102"><a href="#cb2-102"></a><span class="ss">- </span>More setup (Visual Studio, COM registration).</span>
<span id="cb2-103"><a href="#cb2-103"></a></span>
<span id="cb2-104"><a href="#cb2-104"></a><span class="ss">- </span>Distribution overhead (must be installed on each machine).</span>
<span id="cb2-105"><a href="#cb2-105"></a></span>
<span id="cb2-106"><a href="#cb2-106"></a><span class="ss">- </span>Debugging complexity (requires attaching to EA process).</span>
<span id="cb2-107"><a href="#cb2-107"></a></span>
<span id="cb2-108"><a href="#cb2-108"></a><span class="ss">- </span>Higher governance burden (DLLs need version control and change</span>
<span id="cb2-109"><a href="#cb2-109"></a>  management).</span>
<span id="cb2-110"><a href="#cb2-110"></a></span>
<span id="cb2-111"><a href="#cb2-111"></a>In other words, add-ins are heavier. They make sense when a solution is</span>
<span id="cb2-112"><a href="#cb2-112"></a>stable and widely used, but they are overkill for experimental or</span>
<span id="cb2-113"><a href="#cb2-113"></a>repository-specific tasks.</span>
<span id="cb2-114"><a href="#cb2-114"></a></span>
<span id="cb2-115"><a href="#cb2-115"></a><span class="fu">## Add-ins and Governance</span></span>
<span id="cb2-116"><a href="#cb2-116"></a></span>
<span id="cb2-117"><a href="#cb2-117"></a>One of the subtle reasons to move to add-ins is governance. Scripts are</span>
<span id="cb2-118"><a href="#cb2-118"></a>flexible but ephemeral; anyone can change them in the repository.</span>
<span id="cb2-119"><a href="#cb2-119"></a>Add-ins, by contrast, are compiled, versioned, and distributed. This</span>
<span id="cb2-120"><a href="#cb2-120"></a>makes them better suited to regulated environments where tools must be</span>
<span id="cb2-121"><a href="#cb2-121"></a>controlled.</span>
<span id="cb2-122"><a href="#cb2-122"></a></span>
<span id="cb2-123"><a href="#cb2-123"></a>For example, a bank may insist that only signed add-ins are used,</span>
<span id="cb2-124"><a href="#cb2-124"></a>ensuring all automation has passed security checks. Scripts may still</span>
<span id="cb2-125"><a href="#cb2-125"></a>exist for local use, but official tooling is delivered as add-ins.</span>
<span id="cb2-126"><a href="#cb2-126"></a></span>
<span id="cb2-127"><a href="#cb2-127"></a><span class="fu">## The Learning Curve</span></span>
<span id="cb2-128"><a href="#cb2-128"></a></span>
<span id="cb2-129"><a href="#cb2-129"></a>Writing add-ins requires more development skill than writing scripts.</span>
<span id="cb2-130"><a href="#cb2-130"></a>You need to:</span>
<span id="cb2-131"><a href="#cb2-131"></a></span>
<span id="cb2-132"><a href="#cb2-132"></a><span class="ss">- </span>Set up a Class Library project in Visual Studio.</span>
<span id="cb2-133"><a href="#cb2-133"></a></span>
<span id="cb2-134"><a href="#cb2-134"></a><span class="ss">- </span>Add a reference to Interop.EA.dll.</span>
<span id="cb2-135"><a href="#cb2-135"></a></span>
<span id="cb2-136"><a href="#cb2-136"></a><span class="ss">- </span>Mark the assembly COM-visible.</span>
<span id="cb2-137"><a href="#cb2-137"></a></span>
<span id="cb2-138"><a href="#cb2-138"></a><span class="ss">- </span>Register it with regasm or an installer.</span>
<span id="cb2-139"><a href="#cb2-139"></a></span>
<span id="cb2-140"><a href="#cb2-140"></a><span class="ss">- </span>Implement required methods like EA_Connect, EA_Disconnect,</span>
<span id="cb2-141"><a href="#cb2-141"></a>  EA_GetMenuItems, and EA_MenuClick.</span>
<span id="cb2-142"><a href="#cb2-142"></a></span>
<span id="cb2-143"><a href="#cb2-143"></a>This is more demanding than writing JScript in EA’s built-in editor. But</span>
<span id="cb2-144"><a href="#cb2-144"></a>it opens far greater possibilities.</span>
<span id="cb2-145"><a href="#cb2-145"></a></span>
<span id="cb2-146"><a href="#cb2-146"></a><span class="fu">## A Progressive Path</span></span>
<span id="cb2-147"><a href="#cb2-147"></a></span>
<span id="cb2-148"><a href="#cb2-148"></a>A useful way to think about the script/add-in distinction is as a path:</span>
<span id="cb2-149"><a href="#cb2-149"></a></span>
<span id="cb2-150"><a href="#cb2-150"></a><span class="ss">- </span>**Scripts** — fast, flexible, repository-bound.</span>
<span id="cb2-151"><a href="#cb2-151"></a></span>
<span id="cb2-152"><a href="#cb2-152"></a><span class="ss">- </span>**External Automation** — Python or C# utilities that integrate EA</span>
<span id="cb2-153"><a href="#cb2-153"></a>  into enterprise workflows.</span>
<span id="cb2-154"><a href="#cb2-154"></a></span>
<span id="cb2-155"><a href="#cb2-155"></a><span class="ss">- </span>**Add-ins** — compiled, distributed, integrated extensions.</span>
<span id="cb2-156"><a href="#cb2-156"></a></span>
<span id="cb2-157"><a href="#cb2-157"></a>Teams often move along this path naturally. A script solves a local</span>
<span id="cb2-158"><a href="#cb2-158"></a>problem. Later it becomes an external utility. Finally, it matures into</span>
<span id="cb2-159"><a href="#cb2-159"></a>an add-in for permanent use. Understanding this path helps you decide</span>
<span id="cb2-160"><a href="#cb2-160"></a>when to invest in the extra effort of an add-in.</span>
<span id="cb2-161"><a href="#cb2-161"></a></span>
<span id="cb2-162"><a href="#cb2-162"></a><span class="fu">## Cultural Impact</span></span>
<span id="cb2-163"><a href="#cb2-163"></a></span>
<span id="cb2-164"><a href="#cb2-164"></a>The choice between scripts and add-ins also shapes team culture. Scripts</span>
<span id="cb2-165"><a href="#cb2-165"></a>empower modellers; add-ins formalise tools. Too much reliance on add-ins</span>
<span id="cb2-166"><a href="#cb2-166"></a>can discourage experimentation. Too much reliance on scripts can create</span>
<span id="cb2-167"><a href="#cb2-167"></a>chaos. The healthiest culture balances the two: scripts for flexibility,</span>
<span id="cb2-168"><a href="#cb2-168"></a>add-ins for stability.</span>
<span id="cb2-169"><a href="#cb2-169"></a></span>
<span id="cb2-170"><a href="#cb2-170"></a><span class="fu">## Risks of Add-ins</span></span>
<span id="cb2-171"><a href="#cb2-171"></a></span>
<span id="cb2-172"><a href="#cb2-172"></a>Because add-ins load at EA startup, errors in add-ins can be disruptive.</span>
<span id="cb2-173"><a href="#cb2-173"></a>A badly written add-in may prevent menus from loading, slow down EA, or</span>
<span id="cb2-174"><a href="#cb2-174"></a>crash the application. This risk means testing and version control are</span>
<span id="cb2-175"><a href="#cb2-175"></a>even more critical than for scripts.</span>
<span id="cb2-176"><a href="#cb2-176"></a></span>
<span id="cb2-177"><a href="#cb2-177"></a><span class="fu">## Example</span></span>
<span id="cb2-178"><a href="#cb2-178"></a></span>
<span id="cb2-179"><a href="#cb2-179"></a><span class="fu">### Minimal C# Add-in</span></span>
<span id="cb2-180"><a href="#cb2-180"></a></span>
<span id="cb2-181"><a href="#cb2-181"></a>Here’s a **minimal C# Add-in**. It adds a menu under **Specialize →</span>
<span id="cb2-182"><a href="#cb2-182"></a>MyAddin → Hello**. When clicked, it shows a message box.</span>
<span id="cb2-183"><a href="#cb2-183"></a><span class="in">```{.cs filename="Example 19.1 - MyAddin.cs – Minimal EA Add-in"}</span></span>
<span id="cb2-184"><a href="#cb2-184"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb2-185"><a href="#cb2-185"></a><span class="co">// Example 19.1 - MyAddin.cs – Minimal EA Add-in</span></span>
<span id="cb2-186"><a href="#cb2-186"></a><span class="co">// Purpose: Demonstrate how to build a COM-visible add-in</span></span>
<span id="cb2-187"><a href="#cb2-187"></a><span class="co">// Notes:</span></span>
<span id="cb2-188"><a href="#cb2-188"></a><span class="co">//   - Build as Class Library (.NET Framework, not .NET Core).</span></span>
<span id="cb2-189"><a href="#cb2-189"></a><span class="co">//   - Mark assembly COM-visible.</span></span>
<span id="cb2-190"><a href="#cb2-190"></a><span class="co">//   - Register DLL with regasm or installer.</span></span>
<span id="cb2-191"><a href="#cb2-191"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb2-192"><a href="#cb2-192"></a><span class="kw">using</span> System<span class="op">;</span></span>
<span id="cb2-193"><a href="#cb2-193"></a><span class="kw">using</span> System<span class="op">.</span><span class="fu">Runtime</span><span class="op">.</span><span class="fu">InteropServices</span><span class="op">;</span></span>
<span id="cb2-194"><a href="#cb2-194"></a><span class="kw">using</span> EA<span class="op">;</span> <span class="co">// Reference to Interop.EA.dll (from EA install folder)</span></span>
<span id="cb2-195"><a href="#cb2-195"></a><span class="kw">using</span> System<span class="op">.</span><span class="fu">Windows</span><span class="op">.</span><span class="fu">Forms</span><span class="op">;</span></span>
<span id="cb2-196"><a href="#cb2-196"></a></span>
<span id="cb2-197"><a href="#cb2-197"></a><span class="kw">namespace</span> MyAddin</span>
<span id="cb2-198"><a href="#cb2-198"></a><span class="op">{</span></span>
<span id="cb2-199"><a href="#cb2-199"></a>    <span class="op">[</span><span class="fu">ComVisible</span><span class="op">(</span><span class="kw">true</span><span class="op">)]</span>                 <span class="co">// Required for COM</span></span>
<span id="cb2-200"><a href="#cb2-200"></a>    <span class="op">[</span><span class="fu">ClassInterface</span><span class="op">(</span>ClassInterfaceType<span class="op">.</span><span class="fu">None</span><span class="op">)]</span></span>
<span id="cb2-201"><a href="#cb2-201"></a>    <span class="kw">public</span> <span class="kw">class</span> MyAddinClass</span>
<span id="cb2-202"><a href="#cb2-202"></a>    <span class="op">{</span></span>
<span id="cb2-203"><a href="#cb2-203"></a>        <span class="co">// EA calls this at connection</span></span>
<span id="cb2-204"><a href="#cb2-204"></a>        <span class="kw">public</span> <span class="dt">string</span> <span class="fu">EA_Connect</span><span class="op">(</span>Repository Repository<span class="op">)</span></span>
<span id="cb2-205"><a href="#cb2-205"></a>        <span class="op">{</span></span>
<span id="cb2-206"><a href="#cb2-206"></a>            <span class="kw">return</span> <span class="st">"a string"</span><span class="op">;</span>         <span class="co">// Reserved, can be anything</span></span>
<span id="cb2-207"><a href="#cb2-207"></a>        <span class="op">}</span></span>
<span id="cb2-208"><a href="#cb2-208"></a></span>
<span id="cb2-209"><a href="#cb2-209"></a>        <span class="kw">public</span> <span class="dt">void</span> <span class="fu">EA_Disconnect</span><span class="op">()</span></span>
<span id="cb2-210"><a href="#cb2-210"></a>        <span class="op">{</span></span>
<span id="cb2-211"><a href="#cb2-211"></a>            <span class="co">// Cleanup if needed</span></span>
<span id="cb2-212"><a href="#cb2-212"></a>        <span class="op">}</span></span>
<span id="cb2-213"><a href="#cb2-213"></a></span>
<span id="cb2-214"><a href="#cb2-214"></a>        <span class="co">// ---- Menu Integration ----</span></span>
<span id="cb2-215"><a href="#cb2-215"></a></span>
<span id="cb2-216"><a href="#cb2-216"></a>        <span class="co">// Tell EA which menu root to show</span></span>
<span id="cb2-217"><a href="#cb2-217"></a>        <span class="kw">public</span> <span class="dt">object</span> <span class="fu">EA_GetMenuItems</span><span class="op">(</span>Repository Repository<span class="op">,</span> <span class="dt">string</span> Location<span class="op">,</span> <span class="dt">string</span> MenuName<span class="op">)</span></span>
<span id="cb2-218"><a href="#cb2-218"></a>        <span class="op">{</span></span>
<span id="cb2-219"><a href="#cb2-219"></a>            <span class="kw">if</span> <span class="op">(</span>MenuName <span class="op">==</span> <span class="st">""</span><span class="op">)</span></span>
<span id="cb2-220"><a href="#cb2-220"></a>                <span class="kw">return</span> <span class="st">"MyAddin"</span><span class="op">;</span>      <span class="co">// Root menu</span></span>
<span id="cb2-221"><a href="#cb2-221"></a>            <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span>MenuName <span class="op">==</span> <span class="st">"MyAddin"</span><span class="op">)</span></span>
<span id="cb2-222"><a href="#cb2-222"></a>                <span class="kw">return</span> <span class="st">"Hello"</span><span class="op">;</span>        <span class="co">// Submenu item</span></span>
<span id="cb2-223"><a href="#cb2-223"></a>            <span class="kw">return</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb2-224"><a href="#cb2-224"></a>        <span class="op">}</span></span>
<span id="cb2-225"><a href="#cb2-225"></a></span>
<span id="cb2-226"><a href="#cb2-226"></a>        <span class="co">// Control enabled/disabled state</span></span>
<span id="cb2-227"><a href="#cb2-227"></a>        <span class="kw">public</span> <span class="dt">bool</span> <span class="fu">EA_GetMenuState</span><span class="op">(</span>Repository Repository<span class="op">,</span> <span class="dt">string</span> Location<span class="op">,</span> <span class="dt">string</span> MenuName<span class="op">,</span> <span class="dt">string</span> ItemName<span class="op">,</span> <span class="kw">ref</span> <span class="dt">bool</span> IsEnabled<span class="op">,</span> <span class="kw">ref</span> <span class="dt">bool</span> IsChecked<span class="op">)</span></span>
<span id="cb2-228"><a href="#cb2-228"></a>        <span class="op">{</span></span>
<span id="cb2-229"><a href="#cb2-229"></a>            IsEnabled <span class="op">=</span> <span class="kw">true</span><span class="op">;</span>          <span class="co">// Always enabled</span></span>
<span id="cb2-230"><a href="#cb2-230"></a>            <span class="kw">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb2-231"><a href="#cb2-231"></a>        <span class="op">}</span></span>
<span id="cb2-232"><a href="#cb2-232"></a></span>
<span id="cb2-233"><a href="#cb2-233"></a>        <span class="co">// Handle click events</span></span>
<span id="cb2-234"><a href="#cb2-234"></a>        <span class="kw">public</span> <span class="dt">void</span> <span class="fu">EA_MenuClick</span><span class="op">(</span>Repository Repository<span class="op">,</span> <span class="dt">string</span> Location<span class="op">,</span> <span class="dt">string</span> MenuName<span class="op">,</span> <span class="dt">string</span> ItemName<span class="op">)</span></span>
<span id="cb2-235"><a href="#cb2-235"></a>        <span class="op">{</span></span>
<span id="cb2-236"><a href="#cb2-236"></a>            <span class="kw">if</span> <span class="op">(</span>MenuName <span class="op">==</span> <span class="st">"MyAddin"</span> <span class="op">&amp;&amp;</span> ItemName <span class="op">==</span> <span class="st">"Hello"</span><span class="op">)</span></span>
<span id="cb2-237"><a href="#cb2-237"></a>            <span class="op">{</span></span>
<span id="cb2-238"><a href="#cb2-238"></a>                MessageBox<span class="op">.</span><span class="fu">Show</span><span class="op">(</span><span class="st">"Hello from MyAddin!"</span><span class="op">,</span> <span class="st">"EA Add-in"</span><span class="op">);</span></span>
<span id="cb2-239"><a href="#cb2-239"></a>            <span class="op">}</span></span>
<span id="cb2-240"><a href="#cb2-240"></a>        <span class="op">}</span></span>
<span id="cb2-241"><a href="#cb2-241"></a>    <span class="op">}</span></span>
<span id="cb2-242"><a href="#cb2-242"></a><span class="op">}</span></span>
<span id="cb2-243"><a href="#cb2-243"></a><span class="in">```</span></span>
<span id="cb2-244"><a href="#cb2-244"></a></span>
<span id="cb2-245"><a href="#cb2-245"></a><span class="fu">### Build &amp; Register the Add-in</span></span>
<span id="cb2-246"><a href="#cb2-246"></a></span>
<span id="cb2-247"><a href="#cb2-247"></a><span class="ss">1.  </span>In Visual Studio:</span>
<span id="cb2-248"><a href="#cb2-248"></a></span>
<span id="cb2-249"><a href="#cb2-249"></a><span class="ss">- </span>Create a **Class Library (.NET Framework)** project (e.g., .NET</span>
<span id="cb2-250"><a href="#cb2-250"></a>  Framework 4.7.2).</span>
<span id="cb2-251"><a href="#cb2-251"></a></span>
<span id="cb2-252"><a href="#cb2-252"></a><span class="ss">- </span>Add reference to Interop.EA.dll (found in EA’s install folder).</span>
<span id="cb2-253"><a href="#cb2-253"></a></span>
<span id="cb2-254"><a href="#cb2-254"></a><span class="ss">- </span>Ensure AssemblyInfo.cs has <span class="sc">\[</span>assembly: ComVisible(true)<span class="sc">\]</span>.</span>
<span id="cb2-255"><a href="#cb2-255"></a></span>
<span id="cb2-256"><a href="#cb2-256"></a><span class="ss">2.  </span>Build the DLL.</span>
<span id="cb2-257"><a href="#cb2-257"></a></span>
<span id="cb2-258"><a href="#cb2-258"></a><span class="ss">3.  </span>Register it for COM (run as admin):</span>
<span id="cb2-259"><a href="#cb2-259"></a></span>
<span id="cb2-260"><a href="#cb2-260"></a><span class="ss">4.  </span>regasm MyAddin.dll /codebase</span>
<span id="cb2-261"><a href="#cb2-261"></a></span>
<span id="cb2-262"><a href="#cb2-262"></a><span class="ss">5.  </span>Add registry entry for EA (HKCU or HKLM):</span>
<span id="cb2-263"><a href="#cb2-263"></a></span>
<span id="cb2-264"><a href="#cb2-264"></a><span class="ss">6.  </span><span class="in">`\[HKEY_CURRENT_USER\Software\Sparx Systems\EAAddins\MyAddin\]`</span></span>
<span id="cb2-265"><a href="#cb2-265"></a></span>
<span id="cb2-266"><a href="#cb2-266"></a><span class="ss">7.  </span>@="MyAddin.MyAddinClass"</span>
<span id="cb2-267"><a href="#cb2-267"></a></span>
<span id="cb2-268"><a href="#cb2-268"></a><span class="ss">8.  </span>Restart EA → check **Specialize → Manage Add-ins**. Enable</span>
<span id="cb2-269"><a href="#cb2-269"></a>    **MyAddin**.</span>
<span id="cb2-270"><a href="#cb2-270"></a></span>
<span id="cb2-271"><a href="#cb2-271"></a><span class="fu">## When to Migrate Script → Add-in</span></span>
<span id="cb2-272"><a href="#cb2-272"></a></span>
<span id="cb2-273"><a href="#cb2-273"></a>Stick with **Scripts** when:</span>
<span id="cb2-274"><a href="#cb2-274"></a></span>
<span id="cb2-275"><a href="#cb2-275"></a><span class="ss">- </span>One-off bulk edits or imports.</span>
<span id="cb2-276"><a href="#cb2-276"></a></span>
<span id="cb2-277"><a href="#cb2-277"></a><span class="ss">- </span>Repository-specific governance checks.</span>
<span id="cb2-278"><a href="#cb2-278"></a></span>
<span id="cb2-279"><a href="#cb2-279"></a><span class="ss">- </span>You don’t need UI menus.</span>
<span id="cb2-280"><a href="#cb2-280"></a></span>
<span id="cb2-281"><a href="#cb2-281"></a>Move to **Add-ins** when:</span>
<span id="cb2-282"><a href="#cb2-282"></a></span>
<span id="cb2-283"><a href="#cb2-283"></a><span class="ss">- </span>You want consistent menu items for all users.</span>
<span id="cb2-284"><a href="#cb2-284"></a></span>
<span id="cb2-285"><a href="#cb2-285"></a><span class="ss">- </span>You need .NET libraries (e.g., JSON.NET, REST SDK).</span>
<span id="cb2-286"><a href="#cb2-286"></a></span>
<span id="cb2-287"><a href="#cb2-287"></a><span class="ss">- </span>You want event handling (e.g., auto-tag new elements).</span>
<span id="cb2-288"><a href="#cb2-288"></a></span>
<span id="cb2-289"><a href="#cb2-289"></a><span class="ss">- </span>Distribution is across many repositories.</span>
<span id="cb2-290"><a href="#cb2-290"></a></span>
<span id="cb2-291"><a href="#cb2-291"></a><span class="fu">## Migration Example</span></span>
<span id="cb2-292"><a href="#cb2-292"></a></span>
<span id="cb2-293"><a href="#cb2-293"></a>**Governance Script (inside EA)** → “Enforce Owner tag on all</span>
<span id="cb2-294"><a href="#cb2-294"></a>Requirements.”  </span>
<span id="cb2-295"><a href="#cb2-295"></a>When matured into an **Add-in**:</span>
<span id="cb2-296"><a href="#cb2-296"></a></span>
<span id="cb2-297"><a href="#cb2-297"></a><span class="ss">- </span>Provide a permanent menu item *“Governance → Enforce Tags”*.</span>
<span id="cb2-298"><a href="#cb2-298"></a></span>
<span id="cb2-299"><a href="#cb2-299"></a><span class="ss">- </span>Use events: EA_OnElementCreated → auto-add Owner tag.</span>
<span id="cb2-300"><a href="#cb2-300"></a></span>
<span id="cb2-301"><a href="#cb2-301"></a><span class="ss">- </span>Add reporting form with filtering, progress bar, export button.</span>
<span id="cb2-302"><a href="#cb2-302"></a></span>
<span id="cb2-303"><a href="#cb2-303"></a><span class="fu">## Summary</span></span>
<span id="cb2-304"><a href="#cb2-304"></a></span>
<span id="cb2-305"><a href="#cb2-305"></a><span class="ss">- </span>**Scripts** are lightweight, repository-local, and quick.</span>
<span id="cb2-306"><a href="#cb2-306"></a></span>
<span id="cb2-307"><a href="#cb2-307"></a><span class="ss">- </span>**Add-ins** are heavy-duty, system-wide, and extensible.</span>
<span id="cb2-308"><a href="#cb2-308"></a></span>
<span id="cb2-309"><a href="#cb2-309"></a><span class="ss">- </span>Migration path: prove with scripts → formalise as Add-in when stable.</span>
<span id="cb2-310"><a href="#cb2-310"></a></span>
<span id="cb2-311"><a href="#cb2-311"></a><span class="ss">- </span>Minimal Add-in = COM-visible C# class, a registry key, and menu</span>
<span id="cb2-312"><a href="#cb2-312"></a>  methods.</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>