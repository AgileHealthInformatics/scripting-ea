<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 15: AI Refactoring Partner – Scripting Sparx Enterprise Architect: A Practical Handbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./17-System.Object[].html" rel="next">
<link href="./15-System.Object[].html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b4ddde2c4c77ed14ccfa95278770da4f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./16-System.Object[].html"><span class="chapter-title">Chapter 15: AI Refactoring Partner</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Scripting Sparx Enterprise Architect: A Practical Handbook</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Scripting Sparx Enterprise Architect</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 1: Why Script EA?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 2: Automation Landscape</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3: Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 4: API Essentials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 5: Inside EA with JScript</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 6: External Automation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 7: Script Design Patterns</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 8: Object Details</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 9: Imports &amp; Exports</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 10: MDG-Aware Scripting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 11: Governance Scripts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 12: Cookbook of Examples</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 13: Why AI Helps</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 14: Prompt Engineering</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-System.Object[].html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Chapter 15: AI Refactoring Partner</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 16: AI in Daily Workflow</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 17: Performance &amp; Scaling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 18: Integrating with Workflows</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 19: Add-ins vs Scripts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 20: Troubleshooting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 21: Reference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix A: Scripting Constraints</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix B: External Automation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix C: Glossary of Terms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix D: Quick Reference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix E: External Automation Setup</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#why-refactoring-matters-in-ea-scripting" id="toc-why-refactoring-matters-in-ea-scripting" class="nav-link active" data-scroll-target="#why-refactoring-matters-in-ea-scripting">Why Refactoring Matters in EA Scripting</a></li>
  <li><a href="#the-ai-advantage-in-refactoring" id="toc-the-ai-advantage-in-refactoring" class="nav-link" data-scroll-target="#the-ai-advantage-in-refactoring">The AI Advantage in Refactoring</a></li>
  <li><a href="#common-refactoring-needs" id="toc-common-refactoring-needs" class="nav-link" data-scroll-target="#common-refactoring-needs">Common Refactoring Needs</a></li>
  <li><a href="#risks-of-ai-refactoring" id="toc-risks-of-ai-refactoring" class="nav-link" data-scroll-target="#risks-of-ai-refactoring">Risks of AI Refactoring</a></li>
  <li><a href="#a-humanai-workflow-for-refactoring" id="toc-a-humanai-workflow-for-refactoring" class="nav-link" data-scroll-target="#a-humanai-workflow-for-refactoring">A Human–AI Workflow for Refactoring</a></li>
  <li><a href="#ai-for-documentation-retrofitting" id="toc-ai-for-documentation-retrofitting" class="nav-link" data-scroll-target="#ai-for-documentation-retrofitting">AI for Documentation Retrofitting</a></li>
  <li><a href="#refactoring-for-governance" id="toc-refactoring-for-governance" class="nav-link" data-scroll-target="#refactoring-for-governance">Refactoring for Governance</a></li>
  <li><a href="#beyond-ea-refactoring-across-languages" id="toc-beyond-ea-refactoring-across-languages" class="nav-link" data-scroll-target="#beyond-ea-refactoring-across-languages">Beyond EA: Refactoring Across Languages</a></li>
  <li><a href="#the-cultural-impact-of-refactoring-with-ai" id="toc-the-cultural-impact-of-refactoring-with-ai" class="nav-link" data-scroll-target="#the-cultural-impact-of-refactoring-with-ai">The Cultural Impact of Refactoring with AI</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a>
  <ul class="collapse">
  <li><a href="#converting-vbscript-to-jscript" id="toc-converting-vbscript-to-jscript" class="nav-link" data-scroll-target="#converting-vbscript-to-jscript">Converting VBScript to JScript</a></li>
  <li><a href="#adding-a-structured-header" id="toc-adding-a-structured-header" class="nav-link" data-scroll-target="#adding-a-structured-header">Adding a Structured Header</a></li>
  <li><a href="#refactoring-for-safety-add-dry_run" id="toc-refactoring-for-safety-add-dry_run" class="nav-link" data-scroll-target="#refactoring-for-safety-add-dry_run">Refactoring for Safety (Add DRY_RUN)</a></li>
  <li><a href="#breaking-down-monoliths" id="toc-breaking-down-monoliths" class="nav-link" data-scroll-target="#breaking-down-monoliths">Breaking Down Monoliths</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">Chapter 15: AI Refactoring Partner</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Writing new scripts from scratch is only part of the automation journey. In practice, most of the scripts you will encounter in Enterprise Architect are not greenfield creations. They are legacy fragments copied from colleagues, utilities downloaded from forums, or quick fixes you wrote six months ago and barely remember. Over time, these fragments accumulate into a patchwork library that works but is inconsistent, risky, and hard to maintain.</p>
<p>Refactoring is the process of improving code without changing its intended behaviour. It is about making scripts more readable, more consistent, safer, and easier to share. For EA scripting, refactoring often means adding missing headers, introducing dry-run flags, standardising logging, or converting old VBScript into JScript.</p>
<p>This is where artificial intelligence comes into its own as a <strong>refactoring partner</strong>. While AI can generate new scripts, it is especially powerful at taking existing ones and restructuring them. Given clear instructions, it can modernise syntax, add comments, and apply safety patterns. Of course, AI cannot be trusted blindly, but with human oversight it becomes a force multiplier for improving script quality.</p>
<section id="why-refactoring-matters-in-ea-scripting" class="level2">
<h2 class="anchored" data-anchor-id="why-refactoring-matters-in-ea-scripting">Why Refactoring Matters in EA Scripting</h2>
<p>There are several reasons refactoring is essential:</p>
<ul>
<li><p><strong>Consistency</strong>: a mixed library of VBScript and JScript makes it hard for teams to share and reuse.</p></li>
<li><p><strong>Safety</strong>: older scripts may lack dry-run flags or logging, making them risky.</p></li>
<li><p><strong>Clarity</strong>: many scripts lack headers or comments, leaving future readers confused.</p></li>
<li><p><strong>Maintainability</strong>: scripts with inconsistent style are harder to debug or adapt.</p></li>
<li><p><strong>Governance</strong>: in regulated environments, scripts must demonstrate safety and traceability.</p></li>
</ul>
<p>Refactoring turns a messy script into a clean, well-documented artefact that you can safely run and confidently share.</p>
</section>
<section id="the-ai-advantage-in-refactoring" class="level2">
<h2 class="anchored" data-anchor-id="the-ai-advantage-in-refactoring">The AI Advantage in Refactoring</h2>
<p>Traditional refactoring is manual: you read old code, spot issues, and rewrite. AI can accelerate this by doing the heavy lifting:</p>
<ul>
<li><p>Translate VBScript into JScript ES3.</p></li>
<li><p>Insert a standard header block with purpose, usage, safety, and update history.</p></li>
<li><p>Replace unsupported features (forEach, let, const) with EA-compatible constructs.</p></li>
<li><p>Add dry-run wrappers around destructive operations.</p></li>
<li><p>Insert comments explaining each step.</p></li>
</ul>
<p>You still need to review the output, but AI removes much of the tedium. Instead of spending hours rewriting loops, you can focus on reviewing safety and correctness.</p>
</section>
<section id="common-refactoring-needs" class="level2">
<h2 class="anchored" data-anchor-id="common-refactoring-needs">Common Refactoring Needs</h2>
<p>In EA scripting, the most frequent refactoring needs include:</p>
<ol type="1">
<li><p><strong>VBScript to JScript migration</strong><br>
Many legacy scripts were written in VBScript. Translating them by hand is slow; AI can do it in seconds.</p></li>
<li><p><strong>Adding safety scaffolding</strong><br>
Scripts without dry-run or logging are dangerous. AI can wrap actions in if (!DRY_RUN) and add log statements.</p></li>
<li><p><strong>Commenting and documentation</strong><br>
Many scripts are just raw code. AI can add structured comments that explain purpose and usage.</p></li>
<li><p><strong>Standardising patterns</strong><br>
Replace ad-hoc loops with a Find/Filter/Apply structure. Replace forward deletion with backward deletion.</p></li>
<li><p><strong>Splitting monoliths</strong><br>
Some scripts try to do too much at once. AI can help break them into smaller functions with clear responsibilities.</p></li>
</ol>
</section>
<section id="risks-of-ai-refactoring" class="level2">
<h2 class="anchored" data-anchor-id="risks-of-ai-refactoring">Risks of AI Refactoring</h2>
<p>While AI is powerful, it is not infallible. Risks include:</p>
<ul>
<li><p><strong>Hallucinated methods</strong>: inserting functions that don’t exist in EA (e.g., .forEach).</p></li>
<li><p><strong>Over-modernisation</strong>: using ES6 syntax not supported in EA’s JScript ES3 runtime.</p></li>
<li><p><strong>Silent changes</strong>: accidentally altering behaviour while “refactoring.”</p></li>
<li><p><strong>Over-commenting</strong>: adding comments that explain the obvious but miss the critical.</p></li>
</ul>
<p>That is why human review is non-negotiable. AI can propose changes, but you must check every line.</p>
</section>
<section id="a-humanai-workflow-for-refactoring" class="level2">
<h2 class="anchored" data-anchor-id="a-humanai-workflow-for-refactoring">A Human–AI Workflow for Refactoring</h2>
<p>A safe refactoring workflow looks like this:</p>
<ol type="1">
<li><p><strong>Select a script</strong> — choose one that needs improvement (e.g., lacks dry-run, VBScript only).</p></li>
<li><p><strong>Prompt AI clearly</strong> — specify: <em>“Refactor this into JScript ES3, add DRY_RUN, add comments, keep functionality the same.”</em></p></li>
<li><p><strong>Review output</strong> — check loops, updates, stereotypes, and API calls.</p></li>
<li><p><strong>Test in sandbox</strong> — run dry-run mode on a small package.</p></li>
<li><p><strong>Iterate</strong> — adjust prompt or script until correct.</p></li>
<li><p><strong>Adopt as standard</strong> — store the refactored script in Git with version history.</p></li>
</ol>
<p>This workflow ensures that AI accelerates without undermining trust.</p>
</section>
<section id="ai-for-documentation-retrofitting" class="level2">
<h2 class="anchored" data-anchor-id="ai-for-documentation-retrofitting">AI for Documentation Retrofitting</h2>
<p>One of the least glamorous but most valuable uses of AI is adding <strong>documentation headers</strong>. You can paste a bare script into AI and ask: <em>“Add a standard EA script header with purpose, usage, assumptions, safety, dependencies, and update history.”</em> AI will generate a block that matches the conventions established earlier in this book.</p>
<p>Over time, this makes your library far more navigable. Anyone can open a script and know immediately what it does and how to use it.</p>
</section>
<section id="refactoring-for-governance" class="level2">
<h2 class="anchored" data-anchor-id="refactoring-for-governance">Refactoring for Governance</h2>
<p>Refactoring is not just a technical hygiene exercise; it supports governance. In many organisations, scripts themselves are part of the audit trail. Regulators may ask: how do you ensure automation is safe? Refactored scripts with dry-run, logs, and headers are evidence of governance in action.</p>
<p>AI can help align scripts with these governance requirements, ensuring safety features are never omitted.</p>
</section>
<section id="beyond-ea-refactoring-across-languages" class="level2">
<h2 class="anchored" data-anchor-id="beyond-ea-refactoring-across-languages">Beyond EA: Refactoring Across Languages</h2>
<p>Although this chapter focuses on EA’s internal scripting, the same principles apply to external automation. AI can refactor Python scripts to improve logging, or C# scripts to adopt better patterns. The value of AI as a refactoring partner extends across the entire EA automation ecosystem.</p>
</section>
<section id="the-cultural-impact-of-refactoring-with-ai" class="level2">
<h2 class="anchored" data-anchor-id="the-cultural-impact-of-refactoring-with-ai">The Cultural Impact of Refactoring with AI</h2>
<p>When teams see that AI can quickly improve old scripts, they become more willing to use and share automation. Instead of hoarding fragile snippets, they submit them for refactoring. Over time, this raises the baseline quality of the entire script library.</p>
<p>AI thus plays a cultural role: it makes refactoring less of a chore, more of a routine practice.</p>
</section>
<section id="examples" class="level2">
<h2 class="anchored" data-anchor-id="examples">Examples</h2>
<section id="converting-vbscript-to-jscript" class="level3">
<h3 class="anchored" data-anchor-id="converting-vbscript-to-jscript">Converting VBScript to JScript</h3>
<p>Many older EA repositories contain <strong>VBScript snippets</strong>. These work, but are verbose and unfamiliar to modern developers. AI can help you convert them to JScript.</p>
<section id="original-vbscript" class="level4">
<h4 class="anchored" data-anchor-id="original-vbscript">Original VBScript</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource .vbscript number-lines code-with-copy"><code class="sourceCode"><span id="cb1-1"><a href="#cb1-1"></a>' List all element names in selected package (VBScript)</span>
<span id="cb1-2"><a href="#cb1-2"></a>!INC Local Scripts.EAConstants-VBScript</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a>sub main()</span>
<span id="cb1-5"><a href="#cb1-5"></a>    dim pkg</span>
<span id="cb1-6"><a href="#cb1-6"></a>    set pkg = Repository.GetTreeSelectedPackage()</span>
<span id="cb1-7"><a href="#cb1-7"></a>    if pkg is nothing then</span>
<span id="cb1-8"><a href="#cb1-8"></a>        Session.Prompt "Select a package.", promptOK</span>
<span id="cb1-9"><a href="#cb1-9"></a>        exit sub</span>
<span id="cb1-10"><a href="#cb1-10"></a>    end if</span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a>    dim els, i</span>
<span id="cb1-13"><a href="#cb1-13"></a>    set els = pkg.Elements</span>
<span id="cb1-14"><a href="#cb1-14"></a>    for i = 0 to els.Count - 1</span>
<span id="cb1-15"><a href="#cb1-15"></a>        Session.Output "Element: " &amp; els.GetAt(i).Name</span>
<span id="cb1-16"><a href="#cb1-16"></a>    next</span>
<span id="cb1-17"><a href="#cb1-17"></a>end sub</span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a>main</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="ai-assisted-conversion-corrected-jscript" class="level4">
<h4 class="anchored" data-anchor-id="ai-assisted-conversion-corrected-jscript">AI-Assisted Conversion (Corrected JScript)</h4>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 15.1 - ListElements_JS.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" data-filename="Example 15.1 - ListElements_JS.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">// Example 15.1 - ListElements_JS.js – JScript (ES3)</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">// Purpose: Converted from VBScript using AI refactoring</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">// Notes: ES3 only, no modern JS features</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb2-9"><a href="#cb2-9"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) {</span>
<span id="cb2-11"><a href="#cb2-11"></a>        Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>    }</span>
<span id="cb2-14"><a href="#cb2-14"></a></span>
<span id="cb2-15"><a href="#cb2-15"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb2-17"><a href="#cb2-17"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb2-18"><a href="#cb2-18"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Element: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>    }</span>
<span id="cb2-20"><a href="#cb2-20"></a>}</span>
<span id="cb2-21"><a href="#cb2-21"></a></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="adding-a-structured-header" class="level3">
<h3 class="anchored" data-anchor-id="adding-a-structured-header">Adding a Structured Header</h3>
<p>Scripts often start life as quick hacks. Over time, they become hard to reuse because they lack documentation. AI can automatically generate a <strong>structured header</strong> in your house style.</p>
<section id="before-minimal" class="level4">
<h4 class="anchored" data-anchor-id="before-minimal">Before (minimal)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode numberSource .js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="cf">if</span> (<span class="op">!</span>pkg) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a>Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Selected package: "</span> <span class="op">+</span> pkg<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a>}</span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="after-ai-generated-header-corrections" class="level4">
<h4 class="anchored" data-anchor-id="after-ai-generated-header-corrections">After (AI-generated header + corrections)</h4>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 15.2 - ShowSelectedPackage.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" data-filename="Example 15.2 - ShowSelectedPackage.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">// Example 15.2 - ShowSelectedPackage.js – JScript (ES3)</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">// Purpose: Output the name of the selected package</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">// Usage: Select a package in the Project Browser → run script</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">// Assumptions: User selects a package; ES3 runtime only</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">// Safety: Read-only, no modifications</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">// Dependencies: none</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">// Update history: 1.0 initial</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb4-13"><a href="#cb4-13"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) {</span>
<span id="cb4-15"><a href="#cb4-15"></a>        Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Please select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span></span>
<span id="cb4-16"><a href="#cb4-16"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb4-17"><a href="#cb4-17"></a>    }</span>
<span id="cb4-18"><a href="#cb4-18"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Selected package: "</span> <span class="op">+</span> pkg<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb4-19"><a href="#cb4-19"></a>}</span>
<span id="cb4-20"><a href="#cb4-20"></a></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="refactoring-for-safety-add-dry_run" class="level3">
<h3 class="anchored" data-anchor-id="refactoring-for-safety-add-dry_run">Refactoring for Safety (Add DRY_RUN)</h3>
<p>AI can retrofit your script with <strong>dry-run and logging</strong>.</p>
<section id="original-script-unsafe" class="level4">
<h4 class="anchored" data-anchor-id="original-script-unsafe">Original Script (unsafe)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode numberSource .js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb5-4"><a href="#cb5-4"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb5-7"><a href="#cb5-7"></a>        els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">.</span><span class="at">Name</span> <span class="op">=</span> <span class="st">"Test_"</span> <span class="op">+</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">.</span><span class="at">Name</span><span class="op">;</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>        els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>    }</span>
<span id="cb5-10"><a href="#cb5-10"></a>    Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(pkg<span class="op">.</span><span class="at">PackageID</span>)<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>}</span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="refactored-with-dry_run" class="level4">
<h4 class="anchored" data-anchor-id="refactored-with-dry_run">Refactored with DRY_RUN</h4>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 15.3 - SafeRename.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" data-filename="Example 15.3 - SafeRename.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">// Example 15.3 - SafeRename.js – JScript (ES3)</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">// Purpose: Prefix all element names with "Test_"</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">// Safety: DRY_RUN enabled by default; logs actions</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="kw">var</span> DRY_RUN <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>    <span class="kw">var</span> PREFIX <span class="op">=</span> <span class="st">"Test_"</span><span class="op">;</span></span>
<span id="cb6-11"><a href="#cb6-11"></a></span>
<span id="cb6-12"><a href="#cb6-12"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb6-14"><a href="#cb6-14"></a></span>
<span id="cb6-15"><a href="#cb6-15"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb6-16"><a href="#cb6-16"></a>    <span class="kw">var</span> changed<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-17"><a href="#cb6-17"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb6-18"><a href="#cb6-18"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>        <span class="kw">var</span> newName <span class="op">=</span> PREFIX <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span><span class="op">;</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Would rename: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span> <span class="op">+</span> <span class="st">" → "</span> <span class="op">+</span> newName)<span class="op">;</span></span>
<span id="cb6-21"><a href="#cb6-21"></a>        <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) {</span>
<span id="cb6-22"><a href="#cb6-22"></a>            e<span class="op">.</span><span class="at">Name</span> <span class="op">=</span> newName<span class="op">;</span></span>
<span id="cb6-23"><a href="#cb6-23"></a>            e<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span></span>
<span id="cb6-24"><a href="#cb6-24"></a>            changed<span class="op">++;</span></span>
<span id="cb6-25"><a href="#cb6-25"></a>        }</span>
<span id="cb6-26"><a href="#cb6-26"></a>    }</span>
<span id="cb6-27"><a href="#cb6-27"></a>    <span class="cf">if</span> (<span class="op">!</span>DRY_RUN <span class="op">&amp;&amp;</span> changed<span class="op">&gt;</span><span class="dv">0</span>) Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(pkg<span class="op">.</span><span class="at">PackageID</span>)<span class="op">;</span></span>
<span id="cb6-28"><a href="#cb6-28"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Total processed: "</span> <span class="op">+</span> els<span class="op">.</span><span class="at">Count</span> <span class="op">+</span> <span class="st">", Changed: "</span> <span class="op">+</span> changed <span class="op">+</span> <span class="st">", Dry-run="</span> <span class="op">+</span> DRY_RUN)<span class="op">;</span></span>
<span id="cb6-29"><a href="#cb6-29"></a>}</span>
<span id="cb6-30"><a href="#cb6-30"></a></span>
<span id="cb6-31"><a href="#cb6-31"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="breaking-down-monoliths" class="level3">
<h3 class="anchored" data-anchor-id="breaking-down-monoliths">Breaking Down Monoliths</h3>
<p>AI can also split a long monolithic script into <strong>functions</strong>, making it easier to maintain.</p>
<section id="before-all-inline" class="level4">
<h4 class="anchored" data-anchor-id="before-all-inline">Before (all inline)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode numberSource .js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb7-2"><a href="#cb7-2"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb7-5"><a href="#cb7-5"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>        <span class="cf">if</span> (e<span class="op">.</span><span class="at">Type</span> <span class="op">==</span> <span class="st">"Requirement"</span> <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="at">Notes</span> <span class="op">==</span> <span class="st">""</span>) {</span>
<span id="cb7-7"><a href="#cb7-7"></a>            Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Requirement missing notes: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>        }</span>
<span id="cb7-9"><a href="#cb7-9"></a>    }</span>
<span id="cb7-10"><a href="#cb7-10"></a>}</span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="after-refactored-into-functions" class="level4">
<h4 class="anchored" data-anchor-id="after-refactored-into-functions">After (refactored into functions)</h4>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 15.4 - CheckMissingNotes.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" data-filename="Example 15.4 - CheckMissingNotes.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">// Example 15.4 - CheckMissingNotes.js – JScript (ES3)</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">// Purpose: Report Requirements without notes</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">// Refactored to improve maintainability</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="kw">var</span> pkg <span class="op">=</span> <span class="fu">getSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb8-14"><a href="#cb8-14"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>        <span class="cf">if</span> (<span class="fu">isRequirementMissingNotes</span>(e)) {</span>
<span id="cb8-16"><a href="#cb8-16"></a>            Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Requirement missing notes: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>        }</span>
<span id="cb8-18"><a href="#cb8-18"></a>    }</span>
<span id="cb8-19"><a href="#cb8-19"></a>}</span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">// Get the currently selected package, with safety check</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="kw">function</span> <span class="fu">getSelectedPackage</span>() {</span>
<span id="cb8-22"><a href="#cb8-22"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) {</span>
<span id="cb8-24"><a href="#cb8-24"></a>        Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span></span>
<span id="cb8-25"><a href="#cb8-25"></a>        <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb8-26"><a href="#cb8-26"></a>    }</span>
<span id="cb8-27"><a href="#cb8-27"></a>    <span class="cf">return</span> pkg<span class="op">;</span></span>
<span id="cb8-28"><a href="#cb8-28"></a>}</span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="co">// Check if element is a Requirement with empty notes</span></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="kw">function</span> <span class="fu">isRequirementMissingNotes</span>(e) {</span>
<span id="cb8-31"><a href="#cb8-31"></a>    <span class="cf">return</span> e<span class="op">.</span><span class="at">Type</span> <span class="op">==</span> <span class="st">"Requirement"</span> <span class="op">&amp;&amp;</span> <span class="fu">trim</span>(e<span class="op">.</span><span class="at">Notes</span>) <span class="op">==</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb8-32"><a href="#cb8-32"></a>}</span>
<span id="cb8-33"><a href="#cb8-33"></a><span class="kw">function</span> <span class="fu">trim</span>(str) {</span>
<span id="cb8-34"><a href="#cb8-34"></a>    <span class="cf">if</span> (str <span class="op">==</span> <span class="kw">null</span>) <span class="cf">return</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb8-35"><a href="#cb8-35"></a>    <span class="cf">return</span> <span class="bu">String</span>(str)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">^\s+|\s+$</span><span class="ss">/g</span><span class="op">,</span> <span class="st">""</span>)<span class="op">;</span></span>
<span id="cb8-36"><a href="#cb8-36"></a>}</span>
<span id="cb8-37"><a href="#cb8-37"></a></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>AI is a powerful refactoring partner:</p>
<ul>
<li><p><strong>Language conversion</strong>: VBScript → JScript → Python.</p></li>
<li><p><strong>Documentation</strong>: auto-generate structured headers.</p></li>
<li><p><strong>Safety</strong>: add DRY_RUN, logs, and RefreshModelView.</p></li>
<li><p><strong>Maintainability</strong>: break monolithic scripts into functions.</p></li>
</ul>
<p>You remain in control: AI does the heavy lifting, but you apply corrections to keep everything <strong>valid for EA’s JScript ES3 runtime</strong>.</p>
<p>In the next chapter, we’ll explore <strong>Chapter 16 – AI in Daily Workflow</strong>, showing how to build a <em>prompt library</em> and integrate AI-assisted scripting into your modelling practice.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script>

document.addEventListener('DOMContentLoaded', function () {

  // Prefer the margin sidebar if it exists; otherwise try the TOC sidebar.

  const margin = document.querySelector('#quarto-margin-sidebar, .margin-sidebar, .column-margin');

  const toc    = document.querySelector('nav#TOC');

  const sidebar = margin || (toc && toc.closest('.sidebar, .quarto-sidebar, .margin-sidebar'));



  if (!sidebar) return; // no margin column on this layout



  const holder = document.createElement('div');

  holder.className = 'cover-above-toc';

  holder.innerHTML = `

    <a href="index.html">

      <img src="images/cover.png" alt="Book cover" class="cover-above-toc__img" width="140" />

    </a>

  `;

  sidebar.prepend(holder);

});

</script>



<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./15-System.Object[].html" class="pagination-link" aria-label="Chapter 14: Prompt Engineering">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Chapter 14: Prompt Engineering</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./17-System.Object[].html" class="pagination-link" aria-label="Chapter 16: AI in Daily Workflow">
        <span class="nav-page-text"><span class="chapter-title">Chapter 16: AI in Daily Workflow</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu"># Chapter 15: AI Refactoring Partner</span></span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a>Writing new scripts from scratch is only part of the automation journey.</span>
<span id="cb9-4"><a href="#cb9-4"></a>In practice, most of the scripts you will encounter in Enterprise</span>
<span id="cb9-5"><a href="#cb9-5"></a>Architect are not greenfield creations. They are legacy fragments copied</span>
<span id="cb9-6"><a href="#cb9-6"></a>from colleagues, utilities downloaded from forums, or quick fixes you</span>
<span id="cb9-7"><a href="#cb9-7"></a>wrote six months ago and barely remember. Over time, these fragments</span>
<span id="cb9-8"><a href="#cb9-8"></a>accumulate into a patchwork library that works but is inconsistent,</span>
<span id="cb9-9"><a href="#cb9-9"></a>risky, and hard to maintain.</span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a>Refactoring is the process of improving code without changing its</span>
<span id="cb9-12"><a href="#cb9-12"></a>intended behaviour. It is about making scripts more readable, more</span>
<span id="cb9-13"><a href="#cb9-13"></a>consistent, safer, and easier to share. For EA scripting, refactoring</span>
<span id="cb9-14"><a href="#cb9-14"></a>often means adding missing headers, introducing dry-run flags,</span>
<span id="cb9-15"><a href="#cb9-15"></a>standardising logging, or converting old VBScript into JScript.</span>
<span id="cb9-16"><a href="#cb9-16"></a></span>
<span id="cb9-17"><a href="#cb9-17"></a>This is where artificial intelligence comes into its own as a</span>
<span id="cb9-18"><a href="#cb9-18"></a>**refactoring partner**. While AI can generate new scripts, it is</span>
<span id="cb9-19"><a href="#cb9-19"></a>especially powerful at taking existing ones and restructuring them.</span>
<span id="cb9-20"><a href="#cb9-20"></a>Given clear instructions, it can modernise syntax, add comments, and</span>
<span id="cb9-21"><a href="#cb9-21"></a>apply safety patterns. Of course, AI cannot be trusted blindly, but with</span>
<span id="cb9-22"><a href="#cb9-22"></a>human oversight it becomes a force multiplier for improving script</span>
<span id="cb9-23"><a href="#cb9-23"></a>quality.</span>
<span id="cb9-24"><a href="#cb9-24"></a></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="fu">## Why Refactoring Matters in EA Scripting</span></span>
<span id="cb9-26"><a href="#cb9-26"></a></span>
<span id="cb9-27"><a href="#cb9-27"></a>There are several reasons refactoring is essential:</span>
<span id="cb9-28"><a href="#cb9-28"></a></span>
<span id="cb9-29"><a href="#cb9-29"></a><span class="ss">- </span>**Consistency**: a mixed library of VBScript and JScript makes it hard</span>
<span id="cb9-30"><a href="#cb9-30"></a>  for teams to share and reuse.</span>
<span id="cb9-31"><a href="#cb9-31"></a></span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="ss">- </span>**Safety**: older scripts may lack dry-run flags or logging, making</span>
<span id="cb9-33"><a href="#cb9-33"></a>  them risky.</span>
<span id="cb9-34"><a href="#cb9-34"></a></span>
<span id="cb9-35"><a href="#cb9-35"></a><span class="ss">- </span>**Clarity**: many scripts lack headers or comments, leaving future</span>
<span id="cb9-36"><a href="#cb9-36"></a>  readers confused.</span>
<span id="cb9-37"><a href="#cb9-37"></a></span>
<span id="cb9-38"><a href="#cb9-38"></a><span class="ss">- </span>**Maintainability**: scripts with inconsistent style are harder to</span>
<span id="cb9-39"><a href="#cb9-39"></a>  debug or adapt.</span>
<span id="cb9-40"><a href="#cb9-40"></a></span>
<span id="cb9-41"><a href="#cb9-41"></a><span class="ss">- </span>**Governance**: in regulated environments, scripts must demonstrate</span>
<span id="cb9-42"><a href="#cb9-42"></a>  safety and traceability.</span>
<span id="cb9-43"><a href="#cb9-43"></a></span>
<span id="cb9-44"><a href="#cb9-44"></a>Refactoring turns a messy script into a clean, well-documented artefact</span>
<span id="cb9-45"><a href="#cb9-45"></a>that you can safely run and confidently share.</span>
<span id="cb9-46"><a href="#cb9-46"></a></span>
<span id="cb9-47"><a href="#cb9-47"></a><span class="fu">## The AI Advantage in Refactoring</span></span>
<span id="cb9-48"><a href="#cb9-48"></a></span>
<span id="cb9-49"><a href="#cb9-49"></a>Traditional refactoring is manual: you read old code, spot issues, and</span>
<span id="cb9-50"><a href="#cb9-50"></a>rewrite. AI can accelerate this by doing the heavy lifting:</span>
<span id="cb9-51"><a href="#cb9-51"></a></span>
<span id="cb9-52"><a href="#cb9-52"></a><span class="ss">- </span>Translate VBScript into JScript ES3.</span>
<span id="cb9-53"><a href="#cb9-53"></a></span>
<span id="cb9-54"><a href="#cb9-54"></a><span class="ss">- </span>Insert a standard header block with purpose, usage, safety, and update</span>
<span id="cb9-55"><a href="#cb9-55"></a>  history.</span>
<span id="cb9-56"><a href="#cb9-56"></a></span>
<span id="cb9-57"><a href="#cb9-57"></a><span class="ss">- </span>Replace unsupported features (forEach, let, const) with EA-compatible</span>
<span id="cb9-58"><a href="#cb9-58"></a>  constructs.</span>
<span id="cb9-59"><a href="#cb9-59"></a></span>
<span id="cb9-60"><a href="#cb9-60"></a><span class="ss">- </span>Add dry-run wrappers around destructive operations.</span>
<span id="cb9-61"><a href="#cb9-61"></a></span>
<span id="cb9-62"><a href="#cb9-62"></a><span class="ss">- </span>Insert comments explaining each step.</span>
<span id="cb9-63"><a href="#cb9-63"></a></span>
<span id="cb9-64"><a href="#cb9-64"></a>You still need to review the output, but AI removes much of the tedium.</span>
<span id="cb9-65"><a href="#cb9-65"></a>Instead of spending hours rewriting loops, you can focus on reviewing</span>
<span id="cb9-66"><a href="#cb9-66"></a>safety and correctness.</span>
<span id="cb9-67"><a href="#cb9-67"></a></span>
<span id="cb9-68"><a href="#cb9-68"></a><span class="fu">## Common Refactoring Needs</span></span>
<span id="cb9-69"><a href="#cb9-69"></a></span>
<span id="cb9-70"><a href="#cb9-70"></a>In EA scripting, the most frequent refactoring needs include:</span>
<span id="cb9-71"><a href="#cb9-71"></a></span>
<span id="cb9-72"><a href="#cb9-72"></a><span class="ss">1.  </span>**VBScript to JScript migration**  </span>
<span id="cb9-73"><a href="#cb9-73"></a>    Many legacy scripts were written in VBScript. Translating them by</span>
<span id="cb9-74"><a href="#cb9-74"></a>    hand is slow; AI can do it in seconds.</span>
<span id="cb9-75"><a href="#cb9-75"></a></span>
<span id="cb9-76"><a href="#cb9-76"></a><span class="ss">2.  </span>**Adding safety scaffolding**  </span>
<span id="cb9-77"><a href="#cb9-77"></a>    Scripts without dry-run or logging are dangerous. AI can wrap</span>
<span id="cb9-78"><a href="#cb9-78"></a>    actions in if (!DRY_RUN) and add log statements.</span>
<span id="cb9-79"><a href="#cb9-79"></a></span>
<span id="cb9-80"><a href="#cb9-80"></a><span class="ss">3.  </span>**Commenting and documentation**  </span>
<span id="cb9-81"><a href="#cb9-81"></a>    Many scripts are just raw code. AI can add structured comments that</span>
<span id="cb9-82"><a href="#cb9-82"></a>    explain purpose and usage.</span>
<span id="cb9-83"><a href="#cb9-83"></a></span>
<span id="cb9-84"><a href="#cb9-84"></a><span class="ss">4.  </span>**Standardising patterns**  </span>
<span id="cb9-85"><a href="#cb9-85"></a>    Replace ad-hoc loops with a Find/Filter/Apply structure. Replace</span>
<span id="cb9-86"><a href="#cb9-86"></a>    forward deletion with backward deletion.</span>
<span id="cb9-87"><a href="#cb9-87"></a></span>
<span id="cb9-88"><a href="#cb9-88"></a><span class="ss">5.  </span>**Splitting monoliths**  </span>
<span id="cb9-89"><a href="#cb9-89"></a>    Some scripts try to do too much at once. AI can help break them into</span>
<span id="cb9-90"><a href="#cb9-90"></a>    smaller functions with clear responsibilities.</span>
<span id="cb9-91"><a href="#cb9-91"></a></span>
<span id="cb9-92"><a href="#cb9-92"></a><span class="fu">## Risks of AI Refactoring</span></span>
<span id="cb9-93"><a href="#cb9-93"></a></span>
<span id="cb9-94"><a href="#cb9-94"></a>While AI is powerful, it is not infallible. Risks include:</span>
<span id="cb9-95"><a href="#cb9-95"></a></span>
<span id="cb9-96"><a href="#cb9-96"></a><span class="ss">- </span>**Hallucinated methods**: inserting functions that don’t exist in EA</span>
<span id="cb9-97"><a href="#cb9-97"></a>  (e.g., .forEach).</span>
<span id="cb9-98"><a href="#cb9-98"></a></span>
<span id="cb9-99"><a href="#cb9-99"></a><span class="ss">- </span>**Over-modernisation**: using ES6 syntax not supported in EA’s JScript</span>
<span id="cb9-100"><a href="#cb9-100"></a>  ES3 runtime.</span>
<span id="cb9-101"><a href="#cb9-101"></a></span>
<span id="cb9-102"><a href="#cb9-102"></a><span class="ss">- </span>**Silent changes**: accidentally altering behaviour while</span>
<span id="cb9-103"><a href="#cb9-103"></a>  “refactoring.”</span>
<span id="cb9-104"><a href="#cb9-104"></a></span>
<span id="cb9-105"><a href="#cb9-105"></a><span class="ss">- </span>**Over-commenting**: adding comments that explain the obvious but miss</span>
<span id="cb9-106"><a href="#cb9-106"></a>  the critical.</span>
<span id="cb9-107"><a href="#cb9-107"></a></span>
<span id="cb9-108"><a href="#cb9-108"></a>That is why human review is non-negotiable. AI can propose changes, but</span>
<span id="cb9-109"><a href="#cb9-109"></a>you must check every line.</span>
<span id="cb9-110"><a href="#cb9-110"></a></span>
<span id="cb9-111"><a href="#cb9-111"></a><span class="fu">## A Human–AI Workflow for Refactoring</span></span>
<span id="cb9-112"><a href="#cb9-112"></a></span>
<span id="cb9-113"><a href="#cb9-113"></a>A safe refactoring workflow looks like this:</span>
<span id="cb9-114"><a href="#cb9-114"></a></span>
<span id="cb9-115"><a href="#cb9-115"></a><span class="ss">1.  </span>**Select a script** — choose one that needs improvement (e.g., lacks</span>
<span id="cb9-116"><a href="#cb9-116"></a>    dry-run, VBScript only).</span>
<span id="cb9-117"><a href="#cb9-117"></a></span>
<span id="cb9-118"><a href="#cb9-118"></a><span class="ss">2.  </span>**Prompt AI clearly** — specify: *“Refactor this into JScript ES3,</span>
<span id="cb9-119"><a href="#cb9-119"></a>    add DRY_RUN, add comments, keep functionality the same.”*</span>
<span id="cb9-120"><a href="#cb9-120"></a></span>
<span id="cb9-121"><a href="#cb9-121"></a><span class="ss">3.  </span>**Review output** — check loops, updates, stereotypes, and API</span>
<span id="cb9-122"><a href="#cb9-122"></a>    calls.</span>
<span id="cb9-123"><a href="#cb9-123"></a></span>
<span id="cb9-124"><a href="#cb9-124"></a><span class="ss">4.  </span>**Test in sandbox** — run dry-run mode on a small package.</span>
<span id="cb9-125"><a href="#cb9-125"></a></span>
<span id="cb9-126"><a href="#cb9-126"></a><span class="ss">5.  </span>**Iterate** — adjust prompt or script until correct.</span>
<span id="cb9-127"><a href="#cb9-127"></a></span>
<span id="cb9-128"><a href="#cb9-128"></a><span class="ss">6.  </span>**Adopt as standard** — store the refactored script in Git with</span>
<span id="cb9-129"><a href="#cb9-129"></a>    version history.</span>
<span id="cb9-130"><a href="#cb9-130"></a></span>
<span id="cb9-131"><a href="#cb9-131"></a>This workflow ensures that AI accelerates without undermining trust.</span>
<span id="cb9-132"><a href="#cb9-132"></a></span>
<span id="cb9-133"><a href="#cb9-133"></a><span class="fu">## AI for Documentation Retrofitting</span></span>
<span id="cb9-134"><a href="#cb9-134"></a></span>
<span id="cb9-135"><a href="#cb9-135"></a>One of the least glamorous but most valuable uses of AI is adding</span>
<span id="cb9-136"><a href="#cb9-136"></a>**documentation headers**. You can paste a bare script into AI and ask:</span>
<span id="cb9-137"><a href="#cb9-137"></a>*“Add a standard EA script header with purpose, usage, assumptions,</span>
<span id="cb9-138"><a href="#cb9-138"></a>safety, dependencies, and update history.”* AI will generate a block</span>
<span id="cb9-139"><a href="#cb9-139"></a>that matches the conventions established earlier in this book.</span>
<span id="cb9-140"><a href="#cb9-140"></a></span>
<span id="cb9-141"><a href="#cb9-141"></a>Over time, this makes your library far more navigable. Anyone can open a</span>
<span id="cb9-142"><a href="#cb9-142"></a>script and know immediately what it does and how to use it.</span>
<span id="cb9-143"><a href="#cb9-143"></a></span>
<span id="cb9-144"><a href="#cb9-144"></a><span class="fu">## Refactoring for Governance</span></span>
<span id="cb9-145"><a href="#cb9-145"></a></span>
<span id="cb9-146"><a href="#cb9-146"></a>Refactoring is not just a technical hygiene exercise; it supports</span>
<span id="cb9-147"><a href="#cb9-147"></a>governance. In many organisations, scripts themselves are part of the</span>
<span id="cb9-148"><a href="#cb9-148"></a>audit trail. Regulators may ask: how do you ensure automation is safe?</span>
<span id="cb9-149"><a href="#cb9-149"></a>Refactored scripts with dry-run, logs, and headers are evidence of</span>
<span id="cb9-150"><a href="#cb9-150"></a>governance in action.</span>
<span id="cb9-151"><a href="#cb9-151"></a></span>
<span id="cb9-152"><a href="#cb9-152"></a>AI can help align scripts with these governance requirements, ensuring</span>
<span id="cb9-153"><a href="#cb9-153"></a>safety features are never omitted.</span>
<span id="cb9-154"><a href="#cb9-154"></a></span>
<span id="cb9-155"><a href="#cb9-155"></a><span class="fu">## Beyond EA: Refactoring Across Languages</span></span>
<span id="cb9-156"><a href="#cb9-156"></a></span>
<span id="cb9-157"><a href="#cb9-157"></a>Although this chapter focuses on EA’s internal scripting, the same</span>
<span id="cb9-158"><a href="#cb9-158"></a>principles apply to external automation. AI can refactor Python scripts</span>
<span id="cb9-159"><a href="#cb9-159"></a>to improve logging, or C# scripts to adopt better patterns. The value of</span>
<span id="cb9-160"><a href="#cb9-160"></a>AI as a refactoring partner extends across the entire EA automation</span>
<span id="cb9-161"><a href="#cb9-161"></a>ecosystem.</span>
<span id="cb9-162"><a href="#cb9-162"></a></span>
<span id="cb9-163"><a href="#cb9-163"></a><span class="fu">## The Cultural Impact of Refactoring with AI</span></span>
<span id="cb9-164"><a href="#cb9-164"></a></span>
<span id="cb9-165"><a href="#cb9-165"></a>When teams see that AI can quickly improve old scripts, they become more</span>
<span id="cb9-166"><a href="#cb9-166"></a>willing to use and share automation. Instead of hoarding fragile</span>
<span id="cb9-167"><a href="#cb9-167"></a>snippets, they submit them for refactoring. Over time, this raises the</span>
<span id="cb9-168"><a href="#cb9-168"></a>baseline quality of the entire script library.</span>
<span id="cb9-169"><a href="#cb9-169"></a></span>
<span id="cb9-170"><a href="#cb9-170"></a>AI thus plays a cultural role: it makes refactoring less of a chore,</span>
<span id="cb9-171"><a href="#cb9-171"></a>more of a routine practice.</span>
<span id="cb9-172"><a href="#cb9-172"></a></span>
<span id="cb9-173"><a href="#cb9-173"></a><span class="fu">## Examples</span></span>
<span id="cb9-174"><a href="#cb9-174"></a></span>
<span id="cb9-175"><a href="#cb9-175"></a><span class="fu">### Converting VBScript to JScript</span></span>
<span id="cb9-176"><a href="#cb9-176"></a></span>
<span id="cb9-177"><a href="#cb9-177"></a>Many older EA repositories contain **VBScript snippets**. These work,</span>
<span id="cb9-178"><a href="#cb9-178"></a>but are verbose and unfamiliar to modern developers. AI can help you</span>
<span id="cb9-179"><a href="#cb9-179"></a>convert them to JScript.</span>
<span id="cb9-180"><a href="#cb9-180"></a></span>
<span id="cb9-181"><a href="#cb9-181"></a><span class="fu">#### Original VBScript</span></span>
<span id="cb9-182"><a href="#cb9-182"></a></span>
<span id="cb9-183"><a href="#cb9-183"></a><span class="in">``` .VBScript </span></span>
<span id="cb9-184"><a href="#cb9-184"></a><span class="in">' List all element names in selected package (VBScript)</span></span>
<span id="cb9-185"><a href="#cb9-185"></a><span class="in">!INC Local Scripts.EAConstants-VBScript</span></span>
<span id="cb9-186"><a href="#cb9-186"></a></span>
<span id="cb9-187"><a href="#cb9-187"></a><span class="in">sub main()</span></span>
<span id="cb9-188"><a href="#cb9-188"></a><span class="in">    dim pkg</span></span>
<span id="cb9-189"><a href="#cb9-189"></a><span class="in">    set pkg = Repository.GetTreeSelectedPackage()</span></span>
<span id="cb9-190"><a href="#cb9-190"></a><span class="in">    if pkg is nothing then</span></span>
<span id="cb9-191"><a href="#cb9-191"></a><span class="in">        Session.Prompt "Select a package.", promptOK</span></span>
<span id="cb9-192"><a href="#cb9-192"></a><span class="in">        exit sub</span></span>
<span id="cb9-193"><a href="#cb9-193"></a><span class="in">    end if</span></span>
<span id="cb9-194"><a href="#cb9-194"></a></span>
<span id="cb9-195"><a href="#cb9-195"></a><span class="in">    dim els, i</span></span>
<span id="cb9-196"><a href="#cb9-196"></a><span class="in">    set els = pkg.Elements</span></span>
<span id="cb9-197"><a href="#cb9-197"></a><span class="in">    for i = 0 to els.Count - 1</span></span>
<span id="cb9-198"><a href="#cb9-198"></a><span class="in">        Session.Output "Element: " &amp; els.GetAt(i).Name</span></span>
<span id="cb9-199"><a href="#cb9-199"></a><span class="in">    next</span></span>
<span id="cb9-200"><a href="#cb9-200"></a><span class="in">end sub</span></span>
<span id="cb9-201"><a href="#cb9-201"></a></span>
<span id="cb9-202"><a href="#cb9-202"></a><span class="in">main</span></span>
<span id="cb9-203"><a href="#cb9-203"></a></span>
<span id="cb9-204"><a href="#cb9-204"></a><span class="in">```</span></span>
<span id="cb9-205"><a href="#cb9-205"></a></span>
<span id="cb9-206"><a href="#cb9-206"></a><span class="fu">#### AI-Assisted Conversion (Corrected JScript)</span></span>
<span id="cb9-207"><a href="#cb9-207"></a></span>
<span id="cb9-208"><a href="#cb9-208"></a><span class="in">```{.js filename="Example 15.1 - ListElements_JS.js – JScript (ES3)"}</span></span>
<span id="cb9-209"><a href="#cb9-209"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb9-210"><a href="#cb9-210"></a><span class="co">// Example 15.1 - ListElements_JS.js – JScript (ES3)</span></span>
<span id="cb9-211"><a href="#cb9-211"></a><span class="co">// Purpose: Converted from VBScript using AI refactoring</span></span>
<span id="cb9-212"><a href="#cb9-212"></a><span class="co">// Notes: ES3 only, no modern JS features</span></span>
<span id="cb9-213"><a href="#cb9-213"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb9-214"><a href="#cb9-214"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb9-215"><a href="#cb9-215"></a></span>
<span id="cb9-216"><a href="#cb9-216"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb9-217"><a href="#cb9-217"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb9-218"><a href="#cb9-218"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) {</span>
<span id="cb9-219"><a href="#cb9-219"></a>        Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span></span>
<span id="cb9-220"><a href="#cb9-220"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb9-221"><a href="#cb9-221"></a>    }</span>
<span id="cb9-222"><a href="#cb9-222"></a></span>
<span id="cb9-223"><a href="#cb9-223"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb9-224"><a href="#cb9-224"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb9-225"><a href="#cb9-225"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb9-226"><a href="#cb9-226"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Element: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb9-227"><a href="#cb9-227"></a>    }</span>
<span id="cb9-228"><a href="#cb9-228"></a>}</span>
<span id="cb9-229"><a href="#cb9-229"></a></span>
<span id="cb9-230"><a href="#cb9-230"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb9-231"><a href="#cb9-231"></a><span class="in">```</span></span>
<span id="cb9-232"><a href="#cb9-232"></a></span>
<span id="cb9-233"><a href="#cb9-233"></a><span class="fu">### Adding a Structured Header</span></span>
<span id="cb9-234"><a href="#cb9-234"></a></span>
<span id="cb9-235"><a href="#cb9-235"></a>Scripts often start life as quick hacks. Over time, they become hard to</span>
<span id="cb9-236"><a href="#cb9-236"></a>reuse because they lack documentation. AI can automatically generate a</span>
<span id="cb9-237"><a href="#cb9-237"></a>**structured header** in your house style.</span>
<span id="cb9-238"><a href="#cb9-238"></a></span>
<span id="cb9-239"><a href="#cb9-239"></a><span class="fu">#### Before (minimal)</span></span>
<span id="cb9-240"><a href="#cb9-240"></a><span class="in">``` .js</span></span>
<span id="cb9-241"><a href="#cb9-241"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb9-242"><a href="#cb9-242"></a></span>
<span id="cb9-243"><a href="#cb9-243"></a><span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb9-244"><a href="#cb9-244"></a></span>
<span id="cb9-245"><a href="#cb9-245"></a><span class="cf">if</span> (<span class="op">!</span>pkg) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb9-246"><a href="#cb9-246"></a></span>
<span id="cb9-247"><a href="#cb9-247"></a>Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Selected package: "</span> <span class="op">+</span> pkg<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb9-248"><a href="#cb9-248"></a></span>
<span id="cb9-249"><a href="#cb9-249"></a>}</span>
<span id="cb9-250"><a href="#cb9-250"></a></span>
<span id="cb9-251"><a href="#cb9-251"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb9-252"><a href="#cb9-252"></a><span class="in">```</span></span>
<span id="cb9-253"><a href="#cb9-253"></a><span class="fu">#### After (AI-generated header + corrections)</span></span>
<span id="cb9-254"><a href="#cb9-254"></a><span class="in">```{.js filename="Example 15.2 - ShowSelectedPackage.js – JScript (ES3)"}</span></span>
<span id="cb9-255"><a href="#cb9-255"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb9-256"><a href="#cb9-256"></a><span class="co">// Example 15.2 - ShowSelectedPackage.js – JScript (ES3)</span></span>
<span id="cb9-257"><a href="#cb9-257"></a><span class="co">// Purpose: Output the name of the selected package</span></span>
<span id="cb9-258"><a href="#cb9-258"></a><span class="co">// Usage: Select a package in the Project Browser → run script</span></span>
<span id="cb9-259"><a href="#cb9-259"></a><span class="co">// Assumptions: User selects a package; ES3 runtime only</span></span>
<span id="cb9-260"><a href="#cb9-260"></a><span class="co">// Safety: Read-only, no modifications</span></span>
<span id="cb9-261"><a href="#cb9-261"></a><span class="co">// Dependencies: none</span></span>
<span id="cb9-262"><a href="#cb9-262"></a><span class="co">// Update history: 1.0 initial</span></span>
<span id="cb9-263"><a href="#cb9-263"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb9-264"><a href="#cb9-264"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb9-265"><a href="#cb9-265"></a></span>
<span id="cb9-266"><a href="#cb9-266"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb9-267"><a href="#cb9-267"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb9-268"><a href="#cb9-268"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) {</span>
<span id="cb9-269"><a href="#cb9-269"></a>        Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Please select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span></span>
<span id="cb9-270"><a href="#cb9-270"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb9-271"><a href="#cb9-271"></a>    }</span>
<span id="cb9-272"><a href="#cb9-272"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Selected package: "</span> <span class="op">+</span> pkg<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb9-273"><a href="#cb9-273"></a>}</span>
<span id="cb9-274"><a href="#cb9-274"></a></span>
<span id="cb9-275"><a href="#cb9-275"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb9-276"><a href="#cb9-276"></a><span class="in">```</span></span>
<span id="cb9-277"><a href="#cb9-277"></a></span>
<span id="cb9-278"><a href="#cb9-278"></a><span class="fu">### Refactoring for Safety (Add DRY_RUN)</span></span>
<span id="cb9-279"><a href="#cb9-279"></a></span>
<span id="cb9-280"><a href="#cb9-280"></a>AI can retrofit your script with **dry-run and logging**.</span>
<span id="cb9-281"><a href="#cb9-281"></a></span>
<span id="cb9-282"><a href="#cb9-282"></a><span class="fu">#### Original Script (unsafe)</span></span>
<span id="cb9-283"><a href="#cb9-283"></a><span class="in">``` .js</span></span>
<span id="cb9-284"><a href="#cb9-284"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb9-285"><a href="#cb9-285"></a></span>
<span id="cb9-286"><a href="#cb9-286"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb9-287"><a href="#cb9-287"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb9-288"><a href="#cb9-288"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb9-289"><a href="#cb9-289"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb9-290"><a href="#cb9-290"></a>        els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">.</span><span class="at">Name</span> <span class="op">=</span> <span class="st">"Test_"</span> <span class="op">+</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">.</span><span class="at">Name</span><span class="op">;</span></span>
<span id="cb9-291"><a href="#cb9-291"></a>        els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span></span>
<span id="cb9-292"><a href="#cb9-292"></a>    }</span>
<span id="cb9-293"><a href="#cb9-293"></a>    Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(pkg<span class="op">.</span><span class="at">PackageID</span>)<span class="op">;</span></span>
<span id="cb9-294"><a href="#cb9-294"></a>}</span>
<span id="cb9-295"><a href="#cb9-295"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb9-296"><a href="#cb9-296"></a><span class="in">```</span></span>
<span id="cb9-297"><a href="#cb9-297"></a></span>
<span id="cb9-298"><a href="#cb9-298"></a><span class="fu">#### Refactored with DRY_RUN</span></span>
<span id="cb9-299"><a href="#cb9-299"></a><span class="in">```{.js filename="Example 15.3 - SafeRename.js – JScript (ES3)"}</span></span>
<span id="cb9-300"><a href="#cb9-300"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb9-301"><a href="#cb9-301"></a><span class="co">// Example 15.3 - SafeRename.js – JScript (ES3)</span></span>
<span id="cb9-302"><a href="#cb9-302"></a><span class="co">// Purpose: Prefix all element names with "Test_"</span></span>
<span id="cb9-303"><a href="#cb9-303"></a><span class="co">// Safety: DRY_RUN enabled by default; logs actions</span></span>
<span id="cb9-304"><a href="#cb9-304"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb9-305"><a href="#cb9-305"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb9-306"><a href="#cb9-306"></a></span>
<span id="cb9-307"><a href="#cb9-307"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb9-308"><a href="#cb9-308"></a>    <span class="kw">var</span> DRY_RUN <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb9-309"><a href="#cb9-309"></a>    <span class="kw">var</span> PREFIX <span class="op">=</span> <span class="st">"Test_"</span><span class="op">;</span></span>
<span id="cb9-310"><a href="#cb9-310"></a></span>
<span id="cb9-311"><a href="#cb9-311"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb9-312"><a href="#cb9-312"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb9-313"><a href="#cb9-313"></a></span>
<span id="cb9-314"><a href="#cb9-314"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb9-315"><a href="#cb9-315"></a>    <span class="kw">var</span> changed<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-316"><a href="#cb9-316"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb9-317"><a href="#cb9-317"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb9-318"><a href="#cb9-318"></a>        <span class="kw">var</span> newName <span class="op">=</span> PREFIX <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span><span class="op">;</span></span>
<span id="cb9-319"><a href="#cb9-319"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Would rename: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span> <span class="op">+</span> <span class="st">" → "</span> <span class="op">+</span> newName)<span class="op">;</span></span>
<span id="cb9-320"><a href="#cb9-320"></a>        <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) {</span>
<span id="cb9-321"><a href="#cb9-321"></a>            e<span class="op">.</span><span class="at">Name</span> <span class="op">=</span> newName<span class="op">;</span></span>
<span id="cb9-322"><a href="#cb9-322"></a>            e<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span></span>
<span id="cb9-323"><a href="#cb9-323"></a>            changed<span class="op">++;</span></span>
<span id="cb9-324"><a href="#cb9-324"></a>        }</span>
<span id="cb9-325"><a href="#cb9-325"></a>    }</span>
<span id="cb9-326"><a href="#cb9-326"></a>    <span class="cf">if</span> (<span class="op">!</span>DRY_RUN <span class="op">&amp;&amp;</span> changed<span class="op">&gt;</span><span class="dv">0</span>) Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(pkg<span class="op">.</span><span class="at">PackageID</span>)<span class="op">;</span></span>
<span id="cb9-327"><a href="#cb9-327"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Total processed: "</span> <span class="op">+</span> els<span class="op">.</span><span class="at">Count</span> <span class="op">+</span> <span class="st">", Changed: "</span> <span class="op">+</span> changed <span class="op">+</span> <span class="st">", Dry-run="</span> <span class="op">+</span> DRY_RUN)<span class="op">;</span></span>
<span id="cb9-328"><a href="#cb9-328"></a>}</span>
<span id="cb9-329"><a href="#cb9-329"></a></span>
<span id="cb9-330"><a href="#cb9-330"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb9-331"><a href="#cb9-331"></a><span class="in">```</span></span>
<span id="cb9-332"><a href="#cb9-332"></a></span>
<span id="cb9-333"><a href="#cb9-333"></a><span class="fu">### Breaking Down Monoliths</span></span>
<span id="cb9-334"><a href="#cb9-334"></a></span>
<span id="cb9-335"><a href="#cb9-335"></a>AI can also split a long monolithic script into **functions**, making it</span>
<span id="cb9-336"><a href="#cb9-336"></a>easier to maintain.</span>
<span id="cb9-337"><a href="#cb9-337"></a></span>
<span id="cb9-338"><a href="#cb9-338"></a><span class="fu">#### Before (all inline)</span></span>
<span id="cb9-339"><a href="#cb9-339"></a><span class="in">``` .js</span></span>
<span id="cb9-340"><a href="#cb9-340"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb9-341"><a href="#cb9-341"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb9-342"><a href="#cb9-342"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb9-343"><a href="#cb9-343"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb9-344"><a href="#cb9-344"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb9-345"><a href="#cb9-345"></a>        <span class="cf">if</span> (e<span class="op">.</span><span class="at">Type</span> <span class="op">==</span> <span class="st">"Requirement"</span> <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="at">Notes</span> <span class="op">==</span> <span class="st">""</span>) {</span>
<span id="cb9-346"><a href="#cb9-346"></a>            Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Requirement missing notes: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb9-347"><a href="#cb9-347"></a>        }</span>
<span id="cb9-348"><a href="#cb9-348"></a>    }</span>
<span id="cb9-349"><a href="#cb9-349"></a>}</span>
<span id="cb9-350"><a href="#cb9-350"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb9-351"><a href="#cb9-351"></a><span class="in">```</span></span>
<span id="cb9-352"><a href="#cb9-352"></a></span>
<span id="cb9-353"><a href="#cb9-353"></a><span class="fu">#### After (refactored into functions)</span></span>
<span id="cb9-354"><a href="#cb9-354"></a><span class="in">```{.js filename="Example 15.4 - CheckMissingNotes.js – JScript (ES3)"}</span></span>
<span id="cb9-355"><a href="#cb9-355"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb9-356"><a href="#cb9-356"></a><span class="co">// Example 15.4 - CheckMissingNotes.js – JScript (ES3)</span></span>
<span id="cb9-357"><a href="#cb9-357"></a><span class="co">// Purpose: Report Requirements without notes</span></span>
<span id="cb9-358"><a href="#cb9-358"></a><span class="co">// Refactored to improve maintainability</span></span>
<span id="cb9-359"><a href="#cb9-359"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb9-360"><a href="#cb9-360"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb9-361"><a href="#cb9-361"></a></span>
<span id="cb9-362"><a href="#cb9-362"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb9-363"><a href="#cb9-363"></a>    <span class="kw">var</span> pkg <span class="op">=</span> <span class="fu">getSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb9-364"><a href="#cb9-364"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb9-365"><a href="#cb9-365"></a></span>
<span id="cb9-366"><a href="#cb9-366"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb9-367"><a href="#cb9-367"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb9-368"><a href="#cb9-368"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb9-369"><a href="#cb9-369"></a>        <span class="cf">if</span> (<span class="fu">isRequirementMissingNotes</span>(e)) {</span>
<span id="cb9-370"><a href="#cb9-370"></a>            Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Requirement missing notes: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb9-371"><a href="#cb9-371"></a>        }</span>
<span id="cb9-372"><a href="#cb9-372"></a>    }</span>
<span id="cb9-373"><a href="#cb9-373"></a>}</span>
<span id="cb9-374"><a href="#cb9-374"></a><span class="co">// Get the currently selected package, with safety check</span></span>
<span id="cb9-375"><a href="#cb9-375"></a><span class="kw">function</span> <span class="fu">getSelectedPackage</span>() {</span>
<span id="cb9-376"><a href="#cb9-376"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb9-377"><a href="#cb9-377"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) {</span>
<span id="cb9-378"><a href="#cb9-378"></a>        Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span></span>
<span id="cb9-379"><a href="#cb9-379"></a>        <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb9-380"><a href="#cb9-380"></a>    }</span>
<span id="cb9-381"><a href="#cb9-381"></a>    <span class="cf">return</span> pkg<span class="op">;</span></span>
<span id="cb9-382"><a href="#cb9-382"></a>}</span>
<span id="cb9-383"><a href="#cb9-383"></a><span class="co">// Check if element is a Requirement with empty notes</span></span>
<span id="cb9-384"><a href="#cb9-384"></a><span class="kw">function</span> <span class="fu">isRequirementMissingNotes</span>(e) {</span>
<span id="cb9-385"><a href="#cb9-385"></a>    <span class="cf">return</span> e<span class="op">.</span><span class="at">Type</span> <span class="op">==</span> <span class="st">"Requirement"</span> <span class="op">&amp;&amp;</span> <span class="fu">trim</span>(e<span class="op">.</span><span class="at">Notes</span>) <span class="op">==</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb9-386"><a href="#cb9-386"></a>}</span>
<span id="cb9-387"><a href="#cb9-387"></a><span class="kw">function</span> <span class="fu">trim</span>(str) {</span>
<span id="cb9-388"><a href="#cb9-388"></a>    <span class="cf">if</span> (str <span class="op">==</span> <span class="kw">null</span>) <span class="cf">return</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb9-389"><a href="#cb9-389"></a>    <span class="cf">return</span> <span class="bu">String</span>(str)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">^\s+|\s+$</span><span class="ss">/g</span><span class="op">,</span> <span class="st">""</span>)<span class="op">;</span></span>
<span id="cb9-390"><a href="#cb9-390"></a>}</span>
<span id="cb9-391"><a href="#cb9-391"></a></span>
<span id="cb9-392"><a href="#cb9-392"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb9-393"><a href="#cb9-393"></a><span class="in">```</span></span>
<span id="cb9-394"><a href="#cb9-394"></a></span>
<span id="cb9-395"><a href="#cb9-395"></a><span class="fu">## Summary</span></span>
<span id="cb9-396"><a href="#cb9-396"></a></span>
<span id="cb9-397"><a href="#cb9-397"></a>AI is a powerful refactoring partner:</span>
<span id="cb9-398"><a href="#cb9-398"></a></span>
<span id="cb9-399"><a href="#cb9-399"></a><span class="ss">- </span>**Language conversion**: VBScript → JScript → Python.</span>
<span id="cb9-400"><a href="#cb9-400"></a></span>
<span id="cb9-401"><a href="#cb9-401"></a><span class="ss">- </span>**Documentation**: auto-generate structured headers.</span>
<span id="cb9-402"><a href="#cb9-402"></a></span>
<span id="cb9-403"><a href="#cb9-403"></a><span class="ss">- </span>**Safety**: add DRY_RUN, logs, and RefreshModelView.</span>
<span id="cb9-404"><a href="#cb9-404"></a></span>
<span id="cb9-405"><a href="#cb9-405"></a><span class="ss">- </span>**Maintainability**: break monolithic scripts into functions.</span>
<span id="cb9-406"><a href="#cb9-406"></a></span>
<span id="cb9-407"><a href="#cb9-407"></a>You remain in control: AI does the heavy lifting, but you apply</span>
<span id="cb9-408"><a href="#cb9-408"></a>corrections to keep everything **valid for EA’s JScript ES3 runtime**.</span>
<span id="cb9-409"><a href="#cb9-409"></a></span>
<span id="cb9-410"><a href="#cb9-410"></a>In the next chapter, we’ll explore **Chapter 16 – AI in Daily</span>
<span id="cb9-411"><a href="#cb9-411"></a>Workflow**, showing how to build a *prompt library* and integrate</span>
<span id="cb9-412"><a href="#cb9-412"></a>AI-assisted scripting into your modelling practice.</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>