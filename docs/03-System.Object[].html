<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 2: Automation Landscape – Scripting Sparx Enterprise Architect: A Practical Handbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-System.Object[].html" rel="next">
<link href="./02-System.Object[].html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b4ddde2c4c77ed14ccfa95278770da4f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<!-- Google tag (gtag.js) -->

<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-B63WMQH4CK"></script>

<script>

  window.dataLayer = window.dataLayer || [];

  function gtag(){dataLayer.push(arguments);}

  gtag('js', new Date());

  gtag('config', 'G-B63WMQH4CK');

</script>



<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-System.Object[].html"><span class="chapter-title">Chapter 2: Automation Landscape</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Scripting Sparx Enterprise Architect: A Practical Handbook</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Scripting Sparx Enterprise Architect</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 1: Why Script EA?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-System.Object[].html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Chapter 2: Automation Landscape</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3: Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 4: API Essentials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 5: Inside EA with JScript</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 6: External Automation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 7: Script Design Patterns</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 8: Object Details</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 9: Imports &amp; Exports</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 10: MDG-Aware Scripting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 11: Governance Scripts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 12: Cookbook of Examples</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 13: Why AI Helps</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 14: Prompt Engineering</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 15: AI Refactoring Partner</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 16: AI in Daily Workflow</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 17: Performance &amp; Scaling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 18: Integrating with Workflows</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 19: Add-ins vs Scripts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 20: Troubleshooting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 21: Reference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix A: Scripting Constraints</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix B: External Automation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix C: Glossary of Terms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix D: Quick Reference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix E: External Automation Setup</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#built-in-script-engine" id="toc-built-in-script-engine" class="nav-link active" data-scroll-target="#built-in-script-engine">Built-In Script Engine</a></li>
  <li><a href="#scripting-options" id="toc-scripting-options" class="nav-link" data-scroll-target="#scripting-options">Scripting options</a></li>
  <li><a href="#external-automation" id="toc-external-automation" class="nav-link" data-scroll-target="#external-automation">External Automation</a></li>
  <li><a href="#hello-ea-examples" id="toc-hello-ea-examples" class="nav-link" data-scroll-target="#hello-ea-examples">“Hello EA” Examples</a></li>
  <li><a href="#comparing-the-three" id="toc-comparing-the-three" class="nav-link" data-scroll-target="#comparing-the-three">Comparing the Three</a></li>
  <li><a href="#the-role-of-com" id="toc-the-role-of-com" class="nav-link" data-scroll-target="#the-role-of-com">The Role of COM</a></li>
  <li><a href="#choosing-the-right-tool" id="toc-choosing-the-right-tool" class="nav-link" data-scroll-target="#choosing-the-right-tool">Choosing the Right Tool</a></li>
  <li><a href="#safety-in-each-layer" id="toc-safety-in-each-layer" class="nav-link" data-scroll-target="#safety-in-each-layer">Safety in Each Layer</a></li>
  <li><a href="#shaping-automation-practice" id="toc-shaping-automation-practice" class="nav-link" data-scroll-target="#shaping-automation-practice">Shaping Automation Practice</a></li>
  <li><a href="#looking-ahead" id="toc-looking-ahead" class="nav-link" data-scroll-target="#looking-ahead">Looking Ahead</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">Chapter 2: Automation Landscape</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Before you can write useful scripts, you need to understand the landscape. Enterprise Architect gives you several ways to automate its behaviour, both from within the tool and from the outside. Each option comes with strengths and limitations. Choosing the right one depends on your goals, your tolerance for risk, and the skills of your team.</p>
<section id="built-in-script-engine" class="level2">
<h2 class="anchored" data-anchor-id="built-in-script-engine">Built-In Script Engine</h2>
<p>Enterprise Architect includes a scripting window where you can create, edit, and run scripts directly inside the repository. These scripts are stored with the model and organised into groups. They can be invoked from menus or context menus, which makes them perfect for quick automation tasks or shared governance checks.</p>
<p>The scripting window offers three “languages”: <strong>VBScript, JScript, and JavaScript</strong>. At first glance this looks like a generous choice. In practice, all three map back to Microsoft’s legacy scripting engines — which means you are working with very old language runtimes.</p>
</section>
<section id="scripting-options" class="level2">
<h2 class="anchored" data-anchor-id="scripting-options">Scripting options</h2>
<p>When creating a script in EA you are prompted to select one of the following:</p>
<p><strong>VBScript</strong></p>
<ul>
<li><p>Microsoft Visual Basic Scripting Edition.</p></li>
<li><p>Looks and feels like writing macros in Excel or classic Visual Basic.</p></li>
<li><p>Verbose but accessible to non-developers.</p></li>
<li><p>Still supported inside EA, but deprecated by Microsoft in Windows.</p></li>
<li><p>Weak library support; relies heavily on the EA API and ActiveX.</p></li>
</ul>
<p><strong>JScript</strong></p>
<ul>
<li><p>Microsoft’s implementation of <strong>ECMAScript 3 (1999)</strong>.</p></li>
<li><p>Very similar to early JavaScript, but locked at that level.</p></li>
<li><p>No modern JavaScript features: no let, const, arrow functions, JSON libraries, or array helpers such as map or filter.</p></li>
<li><p>Requires “old school” loops and helper functions for common tasks.</p></li>
<li><p>This is EA’s most commonly used internal scripting option.</p></li>
</ul>
<p><strong>JavaScript</strong> (as labelled in EA)</p>
<ul>
<li><p>Misleading. Selecting “JavaScript” in EA simply invokes the same JScript engine.</p></li>
<li><p>No ES5/ES6+ features, despite the familiar name.</p></li>
<li><p>Treat “JavaScript” and “JScript” as identical inside EA.</p></li>
</ul>
<p><strong>In short:</strong> inside EA you are working with either VBScript or JScript (ES3). If you want modern features, you need to step outside.</p>
</section>
<section id="external-automation" class="level2">
<h2 class="anchored" data-anchor-id="external-automation">External Automation</h2>
<p>You are not limited to the internal scripting engine. EA exposes its entire object model through a <strong>COM interface</strong>. Any COM-aware language can connect and manipulate the repository. This makes it possible to use modern languages with modern tooling.</p>
<p>Typical external options include:</p>
<ul>
<li><p><strong>C#</strong> (the richest support, with type libraries).</p></li>
<li><p><strong>Python</strong> via pywin32.</p></li>
<li><p><strong>PowerShell, Perl, Java</strong>, and others via COM bridges.</p></li>
</ul>
<p>External automation runs outside EA and does not live in the repository. It is well-suited to integration with CI/CD pipelines, registries, Jira, Confluence, or analytics platforms.</p>
</section>
<section id="hello-ea-examples" class="level2">
<h2 class="anchored" data-anchor-id="hello-ea-examples">“Hello EA” Examples</h2>
<p>The following examples illustrate the same simple task: list the names of all elements in the package currently selected in the Project Browser. Seeing the same logic in three languages highlights their differences.</p>
<p><strong>VBScript</strong> (inside EA)</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 2.1 - HelloEA in VBScript</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" data-filename="Example 2.1 - HelloEA in VBScript"><pre class="sourceCode numberSource vbscript number-lines code-with-copy"><code class="sourceCode"><span id="cb1-1"><a href="#cb1-1"></a>' -------------------------------------------------------</span>
<span id="cb1-2"><a href="#cb1-2"></a>' Example 2.1 - HelloEA in VBScript</span>
<span id="cb1-3"><a href="#cb1-3"></a>' Purpose: Output the names of all elements in the</span>
<span id="cb1-4"><a href="#cb1-4"></a>' selected package in the Project Browser.</span>
<span id="cb1-5"><a href="#cb1-5"></a>' -------------------------------------------------------</span>
<span id="cb1-6"><a href="#cb1-6"></a>!INC Local Scripts.EAConstants-VBScript</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a>sub main()</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a>' Get the selected package</span>
<span id="cb1-11"><a href="#cb1-11"></a>dim package</span>
<span id="cb1-12"><a href="#cb1-12"></a>set package = Repository.GetTreeSelectedPackage()</span>
<span id="cb1-13"><a href="#cb1-13"></a>if package is nothing then</span>
<span id="cb1-14"><a href="#cb1-14"></a>Session.Prompt "Please select a package in the Project Browser.",</span>
<span id="cb1-15"><a href="#cb1-15"></a>promptOK</span>
<span id="cb1-16"><a href="#cb1-16"></a>exit sub</span>
<span id="cb1-17"><a href="#cb1-17"></a>end if</span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a>' Get the collection of elements in the package</span>
<span id="cb1-20"><a href="#cb1-20"></a>dim elements</span>
<span id="cb1-21"><a href="#cb1-21"></a>set elements = package.Elements</span>
<span id="cb1-22"><a href="#cb1-22"></a>' Loop through the collection</span>
<span id="cb1-23"><a href="#cb1-23"></a>dim i</span>
<span id="cb1-24"><a href="#cb1-24"></a>for i = 0 to elements.Count - 1</span>
<span id="cb1-25"><a href="#cb1-25"></a>dim element</span>
<span id="cb1-26"><a href="#cb1-26"></a>set element = elements.GetAt(i) ' EA collections use GetAt()</span>
<span id="cb1-27"><a href="#cb1-27"></a>Session.Output "Element: " &amp; element.Name</span>
<span id="cb1-28"><a href="#cb1-28"></a>next</span>
<span id="cb1-29"><a href="#cb1-29"></a>end sub</span>
<span id="cb1-30"><a href="#cb1-30"></a></span>
<span id="cb1-31"><a href="#cb1-31"></a>main</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>JScript</strong> (inside EA)</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 2.2 - HelloEA in JScript</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" data-filename="Example 2.2 - HelloEA in JScript"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">// Example 2.2 - HelloEA in JScript</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">// Purpose: Output the names of all elements in the</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">// selected package in the Project Browser.</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="kw">function</span> <span class="fu">main</span>() </span>
<span id="cb2-9"><a href="#cb2-9"></a>{</span>
<span id="cb2-10"><a href="#cb2-10"></a>  <span class="co">// Get the selected package</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>  <span class="kw">var</span> <span class="im">package</span> <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="im">package</span>) </span>
<span id="cb2-13"><a href="#cb2-13"></a>    {</span>
<span id="cb2-14"><a href="#cb2-14"></a>    Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Please select a package in the Project Browser."</span><span class="op">,</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>    promptOK)<span class="op">;</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>    <span class="cf">return</span><span class="op">;</span></span>
<span id="cb2-17"><a href="#cb2-17"></a>    }</span>
<span id="cb2-18"><a href="#cb2-18"></a></span>
<span id="cb2-19"><a href="#cb2-19"></a>  <span class="co">// Get the collection of elements in the package</span></span>
<span id="cb2-20"><a href="#cb2-20"></a>  <span class="kw">var</span> elements <span class="op">=</span> <span class="im">package</span><span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb2-21"><a href="#cb2-21"></a>  </span>
<span id="cb2-22"><a href="#cb2-22"></a>  <span class="co">// Loop through the collection</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>  <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i \<span class="op">&lt;</span> elements<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) </span>
<span id="cb2-24"><a href="#cb2-24"></a>    {</span>
<span id="cb2-25"><a href="#cb2-25"></a>    <span class="kw">var</span> element <span class="op">=</span> elements<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span> <span class="co">// EA collections are not arrays</span></span>
<span id="cb2-26"><a href="#cb2-26"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Element: "</span> <span class="op">+</span> element<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb2-27"><a href="#cb2-27"></a>    }</span>
<span id="cb2-28"><a href="#cb2-28"></a>}</span>
<span id="cb2-29"><a href="#cb2-29"></a></span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Python</strong> (external via pywin32)</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 2.3 - HelloEA in Python</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" data-filename="Example 2.3 - HelloEA in Python"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># -------------------------------------------------------</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co"># Example 2.3 - HelloEA in Python</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># Purpose: Output the names of all elements in the</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># selected package in the Project Browser.</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co"># Notes:</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co"># - Requires EA to be running.</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co"># - Requires pywin32 package installed.</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co"># -------------------------------------------------------</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="im">import</span> win32com.client</span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co"># Connect to the running EA instance</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>ea <span class="op">=</span> win32com.client.Dispatch(<span class="st">"EA.App"</span>)</span>
<span id="cb3-13"><a href="#cb3-13"></a>repository <span class="op">=</span> ea.Repository</span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co"># Get the currently selected package</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>package <span class="op">=</span> repository.GetTreeSelectedPackage()</span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="cf">if</span> <span class="kw">not</span> package:</span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="bu">print</span>(<span class="st">"Please select a package in the Project Browser."</span>)</span>
<span id="cb3-18"><a href="#cb3-18"></a>exit(<span class="dv">0</span>)</span>
<span id="cb3-19"><a href="#cb3-19"></a></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co"># Get the collection of elements in the package</span></span>
<span id="cb3-21"><a href="#cb3-21"></a>elements <span class="op">=</span> package.Elements</span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co"># Loop through the collection</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(elements.Count):</span>
<span id="cb3-24"><a href="#cb3-24"></a>element <span class="op">=</span> elements.GetAt(i) \<span class="co"># EA collections expose GetAt()</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="bu">print</span>(<span class="st">"Element:"</span>, element.Name)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="comparing-the-three" class="level2">
<h2 class="anchored" data-anchor-id="comparing-the-three">Comparing the Three</h2>
<ul>
<li><p><strong>VBScript</strong> feels like a 1990s macro language. Clear for beginners but verbose.</p></li>
<li><p><strong>JScript</strong> is terser, familiar to anyone with Java/C-style backgrounds, but limited to ES3 features.</p></li>
<li><p><strong>Python</strong> is modern, expressive, and integrates with rich libraries — but requires external automation and setup.</p></li>
</ul>
</section>
<section id="the-role-of-com" class="level2">
<h2 class="anchored" data-anchor-id="the-role-of-com">The Role of COM</h2>
<p>At the heart of both external automation and add-ins is <strong>COM</strong> (Component Object Model). EA exposes its Repository object through COM. This is what allows C#, Python, or Java to talk to EA.</p>
<p>COM is old, and sometimes brittle, but it is also the glue that allows EA to integrate with the wider world. The Interop.EA.dll assembly is the .NET wrapper over this COM interface. For Python, pywin32 plays the same role. For Java, jacob or similar libraries provide bindings.</p>
<p>Understanding COM isn’t strictly necessary to write scripts, but it explains why <strong>bitness matters</strong> (32-bit EA requires 32-bit Python), why <strong>registration matters</strong> (DLLs must be registered), and why debugging sometimes feels awkward.</p>
</section>
<section id="choosing-the-right-tool" class="level2">
<h2 class="anchored" data-anchor-id="choosing-the-right-tool">Choosing the Right Tool</h2>
<p>A simple selection matrix helps:</p>
<ul>
<li><p>Quick fixes and governance checks inside EA → JScript.</p></li>
<li><p>For teams with strong Visual Basic heritage → VBScript.</p></li>
<li><p>For data-heavy tasks, JSON, or integration pipelines → external automation (Python or C#).</p></li>
<li><p>For stable, long-lived features → migrate scripts into Add-ins.</p></li>
</ul>
</section>
<section id="safety-in-each-layer" class="level2">
<h2 class="anchored" data-anchor-id="safety-in-each-layer">Safety in Each Layer</h2>
<p>Each automation option carries its own risks:</p>
<ul>
<li><p><strong>Internal scripts</strong>: no undo, dangerous if dry-run is not used.</p></li>
<li><p><strong>External automation</strong>: risk of version mismatch (32/64-bit), risk of corrupting repos if SQL writes are used incorrectly.</p></li>
<li><p><strong>Add-ins</strong>: risk of startup errors breaking EA menus; heavier debugging burden.</p></li>
</ul>
<p>The best safety net in all cases is to <strong>test on a dummy repository first</strong>, use <strong>dry-run patterns</strong>, and maintain <strong>version control</strong> for your scripts or add-ins.</p>
</section>
<section id="shaping-automation-practice" class="level2">
<h2 class="anchored" data-anchor-id="shaping-automation-practice">Shaping Automation Practice</h2>
<p>For many organisations, the EA automation landscape evolves in phases:</p>
<ol type="1">
<li><p><strong>Exploration</strong> — a modeller writes small scripts to rename things or export CSV.</p></li>
<li><p><strong>Consolidation</strong> — a team shares scripts across repositories, with common helpers.</p></li>
<li><p><strong>Integration</strong> — external automation ties EA to Jira, Confluence, Git.</p></li>
<li><p><strong>Productisation</strong> — stable solutions become add-ins with menus and event handlers.</p></li>
</ol>
<p>Knowing where you are in this journey helps you decide which option to invest in.</p>
<p>Preparing for the Examples</p>
<p>The rest of this chapter will show practical code samples for each automation mode: internal scripts in JScript, external COM automation in C# and Python, and a glimpse of add-in structure. These examples are fully commented, showing how to set up, how to log safely, and how to use dry-run modes.</p>
<p>Before diving into the code, remember:</p>
<ol type="1">
<li><p><strong>Internal scripts</strong> are your first tool.</p></li>
<li><p><strong>External automation</strong> connects EA to the wider enterprise.</p></li>
<li><p><strong>Add-ins</strong> formalise solutions into products.</p></li>
</ol>
<p>This layered landscape is what makes EA unusually flexible: it can serve a single modeller working on a small project, or an enterprise team building integrations across systems.</p>
</section>
<section id="looking-ahead" class="level2">
<h2 class="anchored" data-anchor-id="looking-ahead">Looking Ahead</h2>
<p>The next chapter dives into <strong>EA API Essentials</strong>. We will explore the 80/20 of the object model: Repository, Package, Element, Connector, Attribute, and TaggedValue. We will also see why methods like Update() and RefreshModelView() are so critical. With this foundation, you will be ready to write scripts that safely and effectively manipulate your models.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script>

document.addEventListener('DOMContentLoaded', function () {

  // Prefer the margin sidebar if it exists; otherwise try the TOC sidebar.

  const margin = document.querySelector('#quarto-margin-sidebar, .margin-sidebar, .column-margin');

  const toc    = document.querySelector('nav#TOC');

  const sidebar = margin || (toc && toc.closest('.sidebar, .quarto-sidebar, .margin-sidebar'));



  if (!sidebar) return; // no margin column on this layout



  const holder = document.createElement('div');

  holder.className = 'cover-above-toc';

  holder.innerHTML = `

    <a href="index.html">

      <img src="images/cover.png" alt="Book cover" class="cover-above-toc__img" width="140" />

    </a>

  `;

  sidebar.prepend(holder);

});

</script>



<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-System.Object[].html" class="pagination-link" aria-label="Chapter 1: Why Script EA?">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Chapter 1: Why Script EA?</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-System.Object[].html" class="pagination-link" aria-label="Chapter 3: Getting Started">
        <span class="nav-page-text"><span class="chapter-title">Chapter 3: Getting Started</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu"># Chapter 2: Automation Landscape</span></span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>Before you can write useful scripts, you need to understand the</span>
<span id="cb4-4"><a href="#cb4-4"></a>landscape. Enterprise Architect gives you several ways to automate its</span>
<span id="cb4-5"><a href="#cb4-5"></a>behaviour, both from within the tool and from the outside. Each option</span>
<span id="cb4-6"><a href="#cb4-6"></a>comes with strengths and limitations. Choosing the right one depends on</span>
<span id="cb4-7"><a href="#cb4-7"></a>your goals, your tolerance for risk, and the skills of your team.</span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="fu">## Built-In Script Engine</span></span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a>Enterprise Architect includes a scripting window where you can create,</span>
<span id="cb4-12"><a href="#cb4-12"></a>edit, and run scripts directly inside the repository. These scripts are</span>
<span id="cb4-13"><a href="#cb4-13"></a>stored with the model and organised into groups. They can be invoked</span>
<span id="cb4-14"><a href="#cb4-14"></a>from menus or context menus, which makes them perfect for quick</span>
<span id="cb4-15"><a href="#cb4-15"></a>automation tasks or shared governance checks.</span>
<span id="cb4-16"><a href="#cb4-16"></a></span>
<span id="cb4-17"><a href="#cb4-17"></a>The scripting window offers three “languages”: **VBScript, JScript, and</span>
<span id="cb4-18"><a href="#cb4-18"></a>JavaScript**. At first glance this looks like a generous choice. In</span>
<span id="cb4-19"><a href="#cb4-19"></a>practice, all three map back to Microsoft’s legacy scripting engines —</span>
<span id="cb4-20"><a href="#cb4-20"></a>which means you are working with very old language runtimes.</span>
<span id="cb4-21"><a href="#cb4-21"></a></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="fu">## Scripting options</span></span>
<span id="cb4-23"><a href="#cb4-23"></a></span>
<span id="cb4-24"><a href="#cb4-24"></a>When creating a script in EA you are prompted to select one of the</span>
<span id="cb4-25"><a href="#cb4-25"></a>following:</span>
<span id="cb4-26"><a href="#cb4-26"></a></span>
<span id="cb4-27"><a href="#cb4-27"></a>**VBScript**</span>
<span id="cb4-28"><a href="#cb4-28"></a></span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="ss">- </span>Microsoft Visual Basic Scripting Edition.</span>
<span id="cb4-30"><a href="#cb4-30"></a></span>
<span id="cb4-31"><a href="#cb4-31"></a><span class="ss">- </span>Looks and feels like writing macros in Excel or classic Visual Basic.</span>
<span id="cb4-32"><a href="#cb4-32"></a></span>
<span id="cb4-33"><a href="#cb4-33"></a><span class="ss">- </span>Verbose but accessible to non-developers.</span>
<span id="cb4-34"><a href="#cb4-34"></a></span>
<span id="cb4-35"><a href="#cb4-35"></a><span class="ss">- </span>Still supported inside EA, but deprecated by Microsoft in Windows.</span>
<span id="cb4-36"><a href="#cb4-36"></a></span>
<span id="cb4-37"><a href="#cb4-37"></a><span class="ss">- </span>Weak library support; relies heavily on the EA API and ActiveX.</span>
<span id="cb4-38"><a href="#cb4-38"></a></span>
<span id="cb4-39"><a href="#cb4-39"></a>**JScript**</span>
<span id="cb4-40"><a href="#cb4-40"></a></span>
<span id="cb4-41"><a href="#cb4-41"></a><span class="ss">- </span>Microsoft’s implementation of **ECMAScript 3 (1999)**.</span>
<span id="cb4-42"><a href="#cb4-42"></a></span>
<span id="cb4-43"><a href="#cb4-43"></a><span class="ss">- </span>Very similar to early JavaScript, but locked at that level.</span>
<span id="cb4-44"><a href="#cb4-44"></a></span>
<span id="cb4-45"><a href="#cb4-45"></a><span class="ss">- </span>No modern JavaScript features: no let, const, arrow functions, JSON</span>
<span id="cb4-46"><a href="#cb4-46"></a>  libraries, or array helpers such as map or filter.</span>
<span id="cb4-47"><a href="#cb4-47"></a></span>
<span id="cb4-48"><a href="#cb4-48"></a><span class="ss">- </span>Requires “old school” loops and helper functions for common tasks.</span>
<span id="cb4-49"><a href="#cb4-49"></a></span>
<span id="cb4-50"><a href="#cb4-50"></a><span class="ss">- </span>This is EA’s most commonly used internal scripting option.</span>
<span id="cb4-51"><a href="#cb4-51"></a></span>
<span id="cb4-52"><a href="#cb4-52"></a>**JavaScript** (as labelled in EA)</span>
<span id="cb4-53"><a href="#cb4-53"></a></span>
<span id="cb4-54"><a href="#cb4-54"></a><span class="ss">- </span>Misleading. Selecting “JavaScript” in EA simply invokes the same</span>
<span id="cb4-55"><a href="#cb4-55"></a>  JScript engine.</span>
<span id="cb4-56"><a href="#cb4-56"></a></span>
<span id="cb4-57"><a href="#cb4-57"></a><span class="ss">- </span>No ES5/ES6+ features, despite the familiar name.</span>
<span id="cb4-58"><a href="#cb4-58"></a></span>
<span id="cb4-59"><a href="#cb4-59"></a><span class="ss">- </span>Treat “JavaScript” and “JScript” as identical inside EA.</span>
<span id="cb4-60"><a href="#cb4-60"></a></span>
<span id="cb4-61"><a href="#cb4-61"></a>**In short:** inside EA you are working with either VBScript or JScript</span>
<span id="cb4-62"><a href="#cb4-62"></a>(ES3). If you want modern features, you need to step outside.</span>
<span id="cb4-63"><a href="#cb4-63"></a></span>
<span id="cb4-64"><a href="#cb4-64"></a><span class="fu">## External Automation</span></span>
<span id="cb4-65"><a href="#cb4-65"></a></span>
<span id="cb4-66"><a href="#cb4-66"></a>You are not limited to the internal scripting engine. EA exposes its</span>
<span id="cb4-67"><a href="#cb4-67"></a>entire object model through a **COM interface**. Any COM-aware language</span>
<span id="cb4-68"><a href="#cb4-68"></a>can connect and manipulate the repository. This makes it possible to use</span>
<span id="cb4-69"><a href="#cb4-69"></a>modern languages with modern tooling.</span>
<span id="cb4-70"><a href="#cb4-70"></a></span>
<span id="cb4-71"><a href="#cb4-71"></a>Typical external options include:</span>
<span id="cb4-72"><a href="#cb4-72"></a></span>
<span id="cb4-73"><a href="#cb4-73"></a><span class="ss">- </span>**C#** (the richest support, with type libraries).</span>
<span id="cb4-74"><a href="#cb4-74"></a></span>
<span id="cb4-75"><a href="#cb4-75"></a><span class="ss">- </span>**Python** via pywin32.</span>
<span id="cb4-76"><a href="#cb4-76"></a></span>
<span id="cb4-77"><a href="#cb4-77"></a><span class="ss">- </span>**PowerShell, Perl, Java**, and others via COM bridges.</span>
<span id="cb4-78"><a href="#cb4-78"></a></span>
<span id="cb4-79"><a href="#cb4-79"></a>External automation runs outside EA and does not live in the repository.</span>
<span id="cb4-80"><a href="#cb4-80"></a>It is well-suited to integration with CI/CD pipelines, registries, Jira,</span>
<span id="cb4-81"><a href="#cb4-81"></a>Confluence, or analytics platforms.</span>
<span id="cb4-82"><a href="#cb4-82"></a></span>
<span id="cb4-83"><a href="#cb4-83"></a><span class="fu">## “Hello EA” Examples</span></span>
<span id="cb4-84"><a href="#cb4-84"></a></span>
<span id="cb4-85"><a href="#cb4-85"></a>The following examples illustrate the same simple task: list the names</span>
<span id="cb4-86"><a href="#cb4-86"></a>of all elements in the package currently selected in the Project</span>
<span id="cb4-87"><a href="#cb4-87"></a>Browser. Seeing the same logic in three languages highlights their</span>
<span id="cb4-88"><a href="#cb4-88"></a>differences.</span>
<span id="cb4-89"><a href="#cb4-89"></a></span>
<span id="cb4-90"><a href="#cb4-90"></a>**VBScript** (inside EA)</span>
<span id="cb4-91"><a href="#cb4-91"></a><span class="in">```{.vbscript filename="Example 2.1 - HelloEA in VBScript"}</span></span>
<span id="cb4-92"><a href="#cb4-92"></a><span class="in">' -------------------------------------------------------</span></span>
<span id="cb4-93"><a href="#cb4-93"></a><span class="in">' Example 2.1 - HelloEA in VBScript</span></span>
<span id="cb4-94"><a href="#cb4-94"></a><span class="in">' Purpose: Output the names of all elements in the</span></span>
<span id="cb4-95"><a href="#cb4-95"></a><span class="in">' selected package in the Project Browser.</span></span>
<span id="cb4-96"><a href="#cb4-96"></a><span class="in">' -------------------------------------------------------</span></span>
<span id="cb4-97"><a href="#cb4-97"></a><span class="in">!INC Local Scripts.EAConstants-VBScript</span></span>
<span id="cb4-98"><a href="#cb4-98"></a></span>
<span id="cb4-99"><a href="#cb4-99"></a><span class="in">sub main()</span></span>
<span id="cb4-100"><a href="#cb4-100"></a></span>
<span id="cb4-101"><a href="#cb4-101"></a><span class="in">' Get the selected package</span></span>
<span id="cb4-102"><a href="#cb4-102"></a><span class="in">dim package</span></span>
<span id="cb4-103"><a href="#cb4-103"></a><span class="in">set package = Repository.GetTreeSelectedPackage()</span></span>
<span id="cb4-104"><a href="#cb4-104"></a><span class="in">if package is nothing then</span></span>
<span id="cb4-105"><a href="#cb4-105"></a><span class="in">Session.Prompt "Please select a package in the Project Browser.",</span></span>
<span id="cb4-106"><a href="#cb4-106"></a><span class="in">promptOK</span></span>
<span id="cb4-107"><a href="#cb4-107"></a><span class="in">exit sub</span></span>
<span id="cb4-108"><a href="#cb4-108"></a><span class="in">end if</span></span>
<span id="cb4-109"><a href="#cb4-109"></a></span>
<span id="cb4-110"><a href="#cb4-110"></a><span class="in">' Get the collection of elements in the package</span></span>
<span id="cb4-111"><a href="#cb4-111"></a><span class="in">dim elements</span></span>
<span id="cb4-112"><a href="#cb4-112"></a><span class="in">set elements = package.Elements</span></span>
<span id="cb4-113"><a href="#cb4-113"></a><span class="in">' Loop through the collection</span></span>
<span id="cb4-114"><a href="#cb4-114"></a><span class="in">dim i</span></span>
<span id="cb4-115"><a href="#cb4-115"></a><span class="in">for i = 0 to elements.Count - 1</span></span>
<span id="cb4-116"><a href="#cb4-116"></a><span class="in">dim element</span></span>
<span id="cb4-117"><a href="#cb4-117"></a><span class="in">set element = elements.GetAt(i) ' EA collections use GetAt()</span></span>
<span id="cb4-118"><a href="#cb4-118"></a><span class="in">Session.Output "Element: " &amp; element.Name</span></span>
<span id="cb4-119"><a href="#cb4-119"></a><span class="in">next</span></span>
<span id="cb4-120"><a href="#cb4-120"></a><span class="in">end sub</span></span>
<span id="cb4-121"><a href="#cb4-121"></a></span>
<span id="cb4-122"><a href="#cb4-122"></a><span class="in">main</span></span>
<span id="cb4-123"><a href="#cb4-123"></a><span class="in">```</span></span>
<span id="cb4-124"><a href="#cb4-124"></a></span>
<span id="cb4-125"><a href="#cb4-125"></a>**JScript** (inside EA)</span>
<span id="cb4-126"><a href="#cb4-126"></a><span class="in">```{.js filename="Example 2.2 - HelloEA in JScript"}</span></span>
<span id="cb4-127"><a href="#cb4-127"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb4-128"><a href="#cb4-128"></a><span class="co">// Example 2.2 - HelloEA in JScript</span></span>
<span id="cb4-129"><a href="#cb4-129"></a><span class="co">// Purpose: Output the names of all elements in the</span></span>
<span id="cb4-130"><a href="#cb4-130"></a><span class="co">// selected package in the Project Browser.</span></span>
<span id="cb4-131"><a href="#cb4-131"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb4-132"><a href="#cb4-132"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb4-133"><a href="#cb4-133"></a></span>
<span id="cb4-134"><a href="#cb4-134"></a><span class="kw">function</span> <span class="fu">main</span>() </span>
<span id="cb4-135"><a href="#cb4-135"></a>{</span>
<span id="cb4-136"><a href="#cb4-136"></a>  <span class="co">// Get the selected package</span></span>
<span id="cb4-137"><a href="#cb4-137"></a>  <span class="kw">var</span> <span class="im">package</span> <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb4-138"><a href="#cb4-138"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="im">package</span>) </span>
<span id="cb4-139"><a href="#cb4-139"></a>    {</span>
<span id="cb4-140"><a href="#cb4-140"></a>    Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Please select a package in the Project Browser."</span><span class="op">,</span></span>
<span id="cb4-141"><a href="#cb4-141"></a>    promptOK)<span class="op">;</span></span>
<span id="cb4-142"><a href="#cb4-142"></a>    <span class="cf">return</span><span class="op">;</span></span>
<span id="cb4-143"><a href="#cb4-143"></a>    }</span>
<span id="cb4-144"><a href="#cb4-144"></a></span>
<span id="cb4-145"><a href="#cb4-145"></a>  <span class="co">// Get the collection of elements in the package</span></span>
<span id="cb4-146"><a href="#cb4-146"></a>  <span class="kw">var</span> elements <span class="op">=</span> <span class="im">package</span><span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb4-147"><a href="#cb4-147"></a>  </span>
<span id="cb4-148"><a href="#cb4-148"></a>  <span class="co">// Loop through the collection</span></span>
<span id="cb4-149"><a href="#cb4-149"></a>  <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i \<span class="op">&lt;</span> elements<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) </span>
<span id="cb4-150"><a href="#cb4-150"></a>    {</span>
<span id="cb4-151"><a href="#cb4-151"></a>    <span class="kw">var</span> element <span class="op">=</span> elements<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span> <span class="co">// EA collections are not arrays</span></span>
<span id="cb4-152"><a href="#cb4-152"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Element: "</span> <span class="op">+</span> element<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb4-153"><a href="#cb4-153"></a>    }</span>
<span id="cb4-154"><a href="#cb4-154"></a>}</span>
<span id="cb4-155"><a href="#cb4-155"></a></span>
<span id="cb4-156"><a href="#cb4-156"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb4-157"><a href="#cb4-157"></a><span class="in">```</span></span>
<span id="cb4-158"><a href="#cb4-158"></a></span>
<span id="cb4-159"><a href="#cb4-159"></a>**Python** (external via pywin32)</span>
<span id="cb4-160"><a href="#cb4-160"></a><span class="in">```{.python filename="Example 2.3 - HelloEA in Python"}</span></span>
<span id="cb4-161"><a href="#cb4-161"></a><span class="co"># -------------------------------------------------------</span></span>
<span id="cb4-162"><a href="#cb4-162"></a><span class="co"># Example 2.3 - HelloEA in Python</span></span>
<span id="cb4-163"><a href="#cb4-163"></a><span class="co"># Purpose: Output the names of all elements in the</span></span>
<span id="cb4-164"><a href="#cb4-164"></a><span class="co"># selected package in the Project Browser.</span></span>
<span id="cb4-165"><a href="#cb4-165"></a><span class="co"># Notes:</span></span>
<span id="cb4-166"><a href="#cb4-166"></a><span class="co"># - Requires EA to be running.</span></span>
<span id="cb4-167"><a href="#cb4-167"></a><span class="co"># - Requires pywin32 package installed.</span></span>
<span id="cb4-168"><a href="#cb4-168"></a><span class="co"># -------------------------------------------------------</span></span>
<span id="cb4-169"><a href="#cb4-169"></a><span class="im">import</span> win32com.client</span>
<span id="cb4-170"><a href="#cb4-170"></a></span>
<span id="cb4-171"><a href="#cb4-171"></a><span class="co"># Connect to the running EA instance</span></span>
<span id="cb4-172"><a href="#cb4-172"></a>ea <span class="op">=</span> win32com.client.Dispatch(<span class="st">"EA.App"</span>)</span>
<span id="cb4-173"><a href="#cb4-173"></a>repository <span class="op">=</span> ea.Repository</span>
<span id="cb4-174"><a href="#cb4-174"></a><span class="co"># Get the currently selected package</span></span>
<span id="cb4-175"><a href="#cb4-175"></a>package <span class="op">=</span> repository.GetTreeSelectedPackage()</span>
<span id="cb4-176"><a href="#cb4-176"></a><span class="cf">if</span> <span class="kw">not</span> package:</span>
<span id="cb4-177"><a href="#cb4-177"></a><span class="bu">print</span>(<span class="st">"Please select a package in the Project Browser."</span>)</span>
<span id="cb4-178"><a href="#cb4-178"></a>exit(<span class="dv">0</span>)</span>
<span id="cb4-179"><a href="#cb4-179"></a></span>
<span id="cb4-180"><a href="#cb4-180"></a><span class="co"># Get the collection of elements in the package</span></span>
<span id="cb4-181"><a href="#cb4-181"></a>elements <span class="op">=</span> package.Elements</span>
<span id="cb4-182"><a href="#cb4-182"></a><span class="co"># Loop through the collection</span></span>
<span id="cb4-183"><a href="#cb4-183"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(elements.Count):</span>
<span id="cb4-184"><a href="#cb4-184"></a>element <span class="op">=</span> elements.GetAt(i) \<span class="co"># EA collections expose GetAt()</span></span>
<span id="cb4-185"><a href="#cb4-185"></a><span class="bu">print</span>(<span class="st">"Element:"</span>, element.Name)</span>
<span id="cb4-186"><a href="#cb4-186"></a><span class="in">```</span></span>
<span id="cb4-187"><a href="#cb4-187"></a></span>
<span id="cb4-188"><a href="#cb4-188"></a><span class="fu">## Comparing the Three</span></span>
<span id="cb4-189"><a href="#cb4-189"></a></span>
<span id="cb4-190"><a href="#cb4-190"></a><span class="ss">- </span>**VBScript** feels like a 1990s macro language. Clear for beginners</span>
<span id="cb4-191"><a href="#cb4-191"></a>  but verbose.</span>
<span id="cb4-192"><a href="#cb4-192"></a></span>
<span id="cb4-193"><a href="#cb4-193"></a><span class="ss">- </span>**JScript** is terser, familiar to anyone with Java/C-style</span>
<span id="cb4-194"><a href="#cb4-194"></a>  backgrounds, but limited to ES3 features.</span>
<span id="cb4-195"><a href="#cb4-195"></a></span>
<span id="cb4-196"><a href="#cb4-196"></a><span class="ss">- </span>**Python** is modern, expressive, and integrates with rich libraries —</span>
<span id="cb4-197"><a href="#cb4-197"></a>  but requires external automation and setup.</span>
<span id="cb4-198"><a href="#cb4-198"></a></span>
<span id="cb4-199"><a href="#cb4-199"></a><span class="fu">## The Role of COM</span></span>
<span id="cb4-200"><a href="#cb4-200"></a></span>
<span id="cb4-201"><a href="#cb4-201"></a>At the heart of both external automation and add-ins is **COM**</span>
<span id="cb4-202"><a href="#cb4-202"></a>(Component Object Model). EA exposes its Repository object through COM.</span>
<span id="cb4-203"><a href="#cb4-203"></a>This is what allows C#, Python, or Java to talk to EA.</span>
<span id="cb4-204"><a href="#cb4-204"></a></span>
<span id="cb4-205"><a href="#cb4-205"></a>COM is old, and sometimes brittle, but it is also the glue that allows</span>
<span id="cb4-206"><a href="#cb4-206"></a>EA to integrate with the wider world. The Interop.EA.dll assembly is the</span>
<span id="cb4-207"><a href="#cb4-207"></a>.NET wrapper over this COM interface. For Python, pywin32 plays the same</span>
<span id="cb4-208"><a href="#cb4-208"></a>role. For Java, jacob or similar libraries provide bindings.</span>
<span id="cb4-209"><a href="#cb4-209"></a></span>
<span id="cb4-210"><a href="#cb4-210"></a>Understanding COM isn’t strictly necessary to write scripts, but it</span>
<span id="cb4-211"><a href="#cb4-211"></a>explains why **bitness matters** (32-bit EA requires 32-bit Python), why</span>
<span id="cb4-212"><a href="#cb4-212"></a>**registration matters** (DLLs must be registered), and why debugging</span>
<span id="cb4-213"><a href="#cb4-213"></a>sometimes feels awkward.</span>
<span id="cb4-214"><a href="#cb4-214"></a></span>
<span id="cb4-215"><a href="#cb4-215"></a><span class="fu">## Choosing the Right Tool</span></span>
<span id="cb4-216"><a href="#cb4-216"></a></span>
<span id="cb4-217"><a href="#cb4-217"></a>A simple selection matrix helps:</span>
<span id="cb4-218"><a href="#cb4-218"></a></span>
<span id="cb4-219"><a href="#cb4-219"></a><span class="ss">- </span>Quick fixes and governance checks inside EA → JScript.</span>
<span id="cb4-220"><a href="#cb4-220"></a></span>
<span id="cb4-221"><a href="#cb4-221"></a><span class="ss">- </span>For teams with strong Visual Basic heritage → VBScript.</span>
<span id="cb4-222"><a href="#cb4-222"></a></span>
<span id="cb4-223"><a href="#cb4-223"></a><span class="ss">- </span>For data-heavy tasks, JSON, or integration pipelines → external</span>
<span id="cb4-224"><a href="#cb4-224"></a>  automation (Python or C#).</span>
<span id="cb4-225"><a href="#cb4-225"></a></span>
<span id="cb4-226"><a href="#cb4-226"></a><span class="ss">- </span>For stable, long-lived features → migrate scripts into Add-ins.</span>
<span id="cb4-227"><a href="#cb4-227"></a></span>
<span id="cb4-228"><a href="#cb4-228"></a><span class="fu">## Safety in Each Layer</span></span>
<span id="cb4-229"><a href="#cb4-229"></a></span>
<span id="cb4-230"><a href="#cb4-230"></a>Each automation option carries its own risks:</span>
<span id="cb4-231"><a href="#cb4-231"></a></span>
<span id="cb4-232"><a href="#cb4-232"></a><span class="ss">- </span>**Internal scripts**: no undo, dangerous if dry-run is not used.</span>
<span id="cb4-233"><a href="#cb4-233"></a></span>
<span id="cb4-234"><a href="#cb4-234"></a><span class="ss">- </span>**External automation**: risk of version mismatch (32/64-bit), risk of</span>
<span id="cb4-235"><a href="#cb4-235"></a>  corrupting repos if SQL writes are used incorrectly.</span>
<span id="cb4-236"><a href="#cb4-236"></a></span>
<span id="cb4-237"><a href="#cb4-237"></a><span class="ss">- </span>**Add-ins**: risk of startup errors breaking EA menus; heavier</span>
<span id="cb4-238"><a href="#cb4-238"></a>  debugging burden.</span>
<span id="cb4-239"><a href="#cb4-239"></a></span>
<span id="cb4-240"><a href="#cb4-240"></a>The best safety net in all cases is to **test on a dummy repository</span>
<span id="cb4-241"><a href="#cb4-241"></a>first**, use **dry-run patterns**, and maintain **version control** for</span>
<span id="cb4-242"><a href="#cb4-242"></a>your scripts or add-ins.</span>
<span id="cb4-243"><a href="#cb4-243"></a></span>
<span id="cb4-244"><a href="#cb4-244"></a><span class="fu">## Shaping Automation Practice</span></span>
<span id="cb4-245"><a href="#cb4-245"></a></span>
<span id="cb4-246"><a href="#cb4-246"></a>For many organisations, the EA automation landscape evolves in phases:</span>
<span id="cb4-247"><a href="#cb4-247"></a></span>
<span id="cb4-248"><a href="#cb4-248"></a><span class="ss">1.  </span>**Exploration** — a modeller writes small scripts to rename things</span>
<span id="cb4-249"><a href="#cb4-249"></a>    or export CSV.</span>
<span id="cb4-250"><a href="#cb4-250"></a></span>
<span id="cb4-251"><a href="#cb4-251"></a><span class="ss">2.  </span>**Consolidation** — a team shares scripts across repositories, with</span>
<span id="cb4-252"><a href="#cb4-252"></a>    common helpers.</span>
<span id="cb4-253"><a href="#cb4-253"></a></span>
<span id="cb4-254"><a href="#cb4-254"></a><span class="ss">3.  </span>**Integration** — external automation ties EA to Jira, Confluence,</span>
<span id="cb4-255"><a href="#cb4-255"></a>    Git.</span>
<span id="cb4-256"><a href="#cb4-256"></a></span>
<span id="cb4-257"><a href="#cb4-257"></a><span class="ss">4.  </span>**Productisation** — stable solutions become add-ins with menus and</span>
<span id="cb4-258"><a href="#cb4-258"></a>    event handlers.</span>
<span id="cb4-259"><a href="#cb4-259"></a></span>
<span id="cb4-260"><a href="#cb4-260"></a>Knowing where you are in this journey helps you decide which option to</span>
<span id="cb4-261"><a href="#cb4-261"></a>invest in.</span>
<span id="cb4-262"><a href="#cb4-262"></a></span>
<span id="cb4-263"><a href="#cb4-263"></a>Preparing for the Examples</span>
<span id="cb4-264"><a href="#cb4-264"></a></span>
<span id="cb4-265"><a href="#cb4-265"></a>The rest of this chapter will show practical code samples for each</span>
<span id="cb4-266"><a href="#cb4-266"></a>automation mode: internal scripts in JScript, external COM automation in</span>
<span id="cb4-267"><a href="#cb4-267"></a>C# and Python, and a glimpse of add-in structure. These examples are</span>
<span id="cb4-268"><a href="#cb4-268"></a>fully commented, showing how to set up, how to log safely, and how to</span>
<span id="cb4-269"><a href="#cb4-269"></a>use dry-run modes.</span>
<span id="cb4-270"><a href="#cb4-270"></a></span>
<span id="cb4-271"><a href="#cb4-271"></a>Before diving into the code, remember:</span>
<span id="cb4-272"><a href="#cb4-272"></a></span>
<span id="cb4-273"><a href="#cb4-273"></a><span class="ss">1.  </span>**Internal scripts** are your first tool.</span>
<span id="cb4-274"><a href="#cb4-274"></a></span>
<span id="cb4-275"><a href="#cb4-275"></a><span class="ss">2.  </span>**External automation** connects EA to the wider enterprise.</span>
<span id="cb4-276"><a href="#cb4-276"></a></span>
<span id="cb4-277"><a href="#cb4-277"></a><span class="ss">3.  </span>**Add-ins** formalise solutions into products.</span>
<span id="cb4-278"><a href="#cb4-278"></a></span>
<span id="cb4-279"><a href="#cb4-279"></a>This layered landscape is what makes EA unusually flexible: it can serve</span>
<span id="cb4-280"><a href="#cb4-280"></a>a single modeller working on a small project, or an enterprise team</span>
<span id="cb4-281"><a href="#cb4-281"></a>building integrations across systems.</span>
<span id="cb4-282"><a href="#cb4-282"></a></span>
<span id="cb4-283"><a href="#cb4-283"></a><span class="fu">## Looking Ahead</span></span>
<span id="cb4-284"><a href="#cb4-284"></a></span>
<span id="cb4-285"><a href="#cb4-285"></a>The next chapter dives into **EA API Essentials**. We will explore the</span>
<span id="cb4-286"><a href="#cb4-286"></a>80/20 of the object model: Repository, Package, Element, Connector,</span>
<span id="cb4-287"><a href="#cb4-287"></a>Attribute, and TaggedValue. We will also see why methods like Update()</span>
<span id="cb4-288"><a href="#cb4-288"></a>and RefreshModelView() are so critical. With this foundation, you will</span>
<span id="cb4-289"><a href="#cb4-289"></a>be ready to write scripts that safely and effectively manipulate your</span>
<span id="cb4-290"><a href="#cb4-290"></a>models.</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>