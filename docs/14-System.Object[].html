<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 13: Why AI Helps – Scripting Sparx Enterprise Architect: A Practical Handbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./15-System.Object[].html" rel="next">
<link href="./13-System.Object[].html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b4ddde2c4c77ed14ccfa95278770da4f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./14-System.Object[].html"><span class="chapter-title">Chapter 13: Why AI Helps</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Scripting Sparx Enterprise Architect: A Practical Handbook</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Scripting Sparx Enterprise Architect</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 1: Why Script EA?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 2: Automation Landscape</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3: Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 4: API Essentials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 5: Inside EA with JScript</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 6: External Automation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 7: Script Design Patterns</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 8: Object Details</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 9: Imports &amp; Exports</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 10: MDG-Aware Scripting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 11: Governance Scripts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 12: Cookbook of Examples</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-System.Object[].html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Chapter 13: Why AI Helps</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 14: Prompt Engineering</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 15: AI Refactoring Partner</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 16: AI in Daily Workflow</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 17: Performance &amp; Scaling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 18: Integrating with Workflows</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 19: Add-ins vs Scripts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 20: Troubleshooting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 21: Reference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix A: Scripting Constraints</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix B: External Automation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix C: Glossary of Terms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix D: Quick Reference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix E: External Automation Setup</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#benefits" id="toc-benefits" class="nav-link active" data-scroll-target="#benefits">Benefits</a>
  <ul class="collapse">
  <li><a href="#the-blank-page-problem" id="toc-the-blank-page-problem" class="nav-link" data-scroll-target="#the-blank-page-problem">The Blank Page Problem</a></li>
  <li><a href="#ai-as-a-pattern-generator" id="toc-ai-as-a-pattern-generator" class="nav-link" data-scroll-target="#ai-as-a-pattern-generator">AI as a Pattern Generator</a></li>
  <li><a href="#ai-as-a-translator" id="toc-ai-as-a-translator" class="nav-link" data-scroll-target="#ai-as-a-translator">AI as a Translator</a></li>
  <li><a href="#ai-as-a-refactoring-partner" id="toc-ai-as-a-refactoring-partner" class="nav-link" data-scroll-target="#ai-as-a-refactoring-partner">AI as a Refactoring Partner</a></li>
  <li><a href="#ai-for-documentation-and-training" id="toc-ai-for-documentation-and-training" class="nav-link" data-scroll-target="#ai-for-documentation-and-training">AI for Documentation and Training</a></li>
  </ul></li>
  <li><a href="#using-ai-safely" id="toc-using-ai-safely" class="nav-link" data-scroll-target="#using-ai-safely">Using AI Safely</a></li>
  <li><a href="#ai-and-learning" id="toc-ai-and-learning" class="nav-link" data-scroll-target="#ai-and-learning">AI and Learning</a></li>
  <li><a href="#ai-in-daily-workflow" id="toc-ai-in-daily-workflow" class="nav-link" data-scroll-target="#ai-in-daily-workflow">AI in Daily Workflow</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a>
  <ul class="collapse">
  <li><a href="#ai-generated-vs-corrected" id="toc-ai-generated-vs-corrected" class="nav-link" data-scroll-target="#ai-generated-vs-corrected">AI-generated vs Corrected</a></li>
  <li><a href="#ai-assisted-refactoring" id="toc-ai-assisted-refactoring" class="nav-link" data-scroll-target="#ai-assisted-refactoring">AI-Assisted Refactoring</a></li>
  </ul></li>
  <li><a href="#using-ai-for-documentation" id="toc-using-ai-for-documentation" class="nav-link" data-scroll-target="#using-ai-for-documentation">Using AI for Documentation</a></li>
  <li><a href="#best-practices-for-ai-assisted-scripting" id="toc-best-practices-for-ai-assisted-scripting" class="nav-link" data-scroll-target="#best-practices-for-ai-assisted-scripting">Best Practices for AI-Assisted Scripting</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">Chapter 13: Why AI Helps</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>By this point, we have explored why scripting Enterprise Architect is essential, how the automation landscape is structured, and how to apply safe, repeatable patterns. We have also seen how practical recipes can turn concepts into working scripts. Yet for many modellers, one barrier remains: the leap from knowing <em>that</em> scripting is possible to actually writing the first line of code.</p>
<p>This is where <strong>artificial intelligence (AI)</strong> comes in. Large language models (LLMs) such as ChatGPT, Claude, or Copilot have introduced a new way of working: you no longer have to start from a blank editor window. Instead, you can describe what you want in natural language and receive a code draft to work with. AI can provide scaffolding, suggest refactors, and generate boilerplate headers. It cannot replace human judgement, but it can dramatically accelerate the scripting process.</p>
<p>This chapter examines why AI is such a powerful assistant in the EA scripting context. It explains the barriers AI helps overcome, the risks it introduces, and the ways to use it responsibly. By the end, you will see AI not as a magic solution but as a valuable partner: one that helps you get started, iterate faster, and learn more effectively.</p>
<section id="benefits" class="level2">
<h2 class="anchored" data-anchor-id="benefits">Benefits</h2>
<section id="the-blank-page-problem" class="level3">
<h3 class="anchored" data-anchor-id="the-blank-page-problem">The Blank Page Problem</h3>
<p>For many modellers, the hardest part of scripting is not the logic but the start. Opening EA’s script editor and staring at an empty window can be intimidating. Even if you know what you want to achieve — “rename all requirements with a REQ_ prefix” — translating that into correct JScript syntax feels daunting.</p>
<p>AI reduces this barrier. By typing a prompt such as <em>“Write an EA script that adds a prefix to all Requirement elements in a selected package”</em>, you receive a draft that includes the right loop structure, .Count and .GetAt() calls, and Update() method. It may not be perfect, but it is far less intimidating than starting from zero.</p>
</section>
<section id="ai-as-a-pattern-generator" class="level3">
<h3 class="anchored" data-anchor-id="ai-as-a-pattern-generator">AI as a Pattern Generator</h3>
<p>Earlier chapters emphasised the importance of scripting patterns: Find/Filter/Apply, Tag Propagation, Curate-then-Write. AI is good at recognising these patterns and generating boilerplate loops. Instead of writing the same traversal logic repeatedly, you can ask AI to generate it and then adjust the details.</p>
<p>For example, a prompt like <em>“Write a Find/Filter/Apply script that sets the Status to Approved for all Requirements tagged with ‘Owner=Architecture’”</em> can yield a working draft in seconds.</p>
</section>
<section id="ai-as-a-translator" class="level3">
<h3 class="anchored" data-anchor-id="ai-as-a-translator">AI as a Translator</h3>
<p>One of the practical challenges in EA scripting is the language choice. Many legacy scripts are in VBScript, while most new ones are in JScript. AI can act as a <strong>translator</strong>, converting VBScript examples into JScript ES3. It can also help migrate JScript snippets into Python or C# for external automation.</p>
<p>For example, you might paste an old VBScript snippet and ask: <em>“Translate this into JScript (ES3 only, no forEach, no JSON methods).”</em> AI can provide a draft translation that saves hours of manual effort.</p>
</section>
<section id="ai-as-a-refactoring-partner" class="level3">
<h3 class="anchored" data-anchor-id="ai-as-a-refactoring-partner">AI as a Refactoring Partner</h3>
<p>As your script library grows, you may notice duplication: multiple scripts with similar loops, slightly different logic, inconsistent logging. AI can help refactor them into cleaner, more consistent structures.</p>
<p>For instance, you might prompt: <em>“Refactor this script to include a DRY_RUN flag and a logging function that writes to CSV.”</em> AI will propose a refactored version, which you can then validate. This makes it easier to standardise your script style and enforce governance principles.</p>
</section>
<section id="ai-for-documentation-and-training" class="level3">
<h3 class="anchored" data-anchor-id="ai-for-documentation-and-training">AI for Documentation and Training</h3>
<p>Another way AI adds value is in <strong>documentation</strong>. Good scripts should always include headers (purpose, usage, assumptions, safety, dependencies). Writing these headers can feel tedious. AI can generate them for you.</p>
<p>Similarly, AI can create training material: explainers, walkthroughs, or alternative language examples. For new team members, you can paste a script into AI and ask it to explain what each line does in plain English. This makes onboarding easier.</p>
<section id="the-risks-of-ai-in-scripting" class="level4">
<h4 class="anchored" data-anchor-id="the-risks-of-ai-in-scripting">The Risks of AI in Scripting</h4>
<p>Of course, AI is not perfect. In fact, it is often confidently wrong. Common risks include:</p>
<ul>
<li><p><strong>Hallucinations</strong>: inventing methods that do not exist (e.g., forEach on EA collections).</p></li>
<li><p><strong>Unsupported syntax</strong>: using modern JavaScript features (let, const, arrow functions) that fail in EA’s ES3 engine.</p></li>
<li><p><strong>Unsafe updates</strong>: forgetting to include Update() or DRY_RUN, leading to destructive changes.</p></li>
<li><p><strong>Performance issues</strong>: generating scripts that spam Session.Output thousands of times.</p></li>
</ul>
<p>These risks are not minor. If you copy AI output blindly into a production repository, you may corrupt or damage your model. That is why AI must always be used with caution.</p>
</section>
</section>
</section>
<section id="using-ai-safely" class="level2">
<h2 class="anchored" data-anchor-id="using-ai-safely">Using AI Safely</h2>
<p>The key to using AI effectively is to treat it as a <strong>drafting tool</strong>, not an authority. You are the architect; AI is your assistant. That means:</p>
<ol type="1">
<li><p><strong>Craft precise prompts</strong> — specify ES3, mention .Count/.GetAt(), require DRY_RUN.</p></li>
<li><p><strong>Always dry-run first</strong> — never trust AI code without logging and simulation.</p></li>
<li><p><strong>Review carefully</strong> — read the script line by line, confirm Update() is included where needed.</p></li>
<li><p><strong>Test on sandboxes</strong> — never run AI-generated scripts directly on production repositories.</p></li>
</ol>
<p>With these safeguards, AI becomes a useful accelerator rather than a liability.</p>
</section>
<section id="ai-and-learning" class="level2">
<h2 class="anchored" data-anchor-id="ai-and-learning">AI and Learning</h2>
<p>Interestingly, using AI to generate scripts can also accelerate your own learning. When you compare AI’s draft to your mental model, you notice differences. Sometimes AI is wrong, and that highlights a gap in your own understanding. Sometimes AI uses a trick you didn’t know, and you learn from it.</p>
<p>Over time, AI becomes a tutor. You experiment by prompting, you review the results, you test and refine. The process itself builds fluency in the EA API.</p>
</section>
<section id="ai-in-daily-workflow" class="level2">
<h2 class="anchored" data-anchor-id="ai-in-daily-workflow">AI in Daily Workflow</h2>
<p>Later in this book (Chapter 15), we will explore AI in daily workflow: prompt libraries, Git integration, and governance checks. For now, the key point is that AI is not just for occasional inspiration; it can be integrated into your routine. Whether you are writing a new script, refactoring an old one, or explaining a script to a colleague, AI can help.</p>
</section>
<section id="examples" class="level2">
<h2 class="anchored" data-anchor-id="examples">Examples</h2>
<section id="ai-generated-vs-corrected" class="level3">
<h3 class="anchored" data-anchor-id="ai-generated-vs-corrected">AI-generated vs Corrected</h3>
<p>Suppose you ask an AI:</p>
<p><em>“Write a script that lists all elements in a package.”</em></p>
<p>You might get this <strong>wrong version</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource .js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1"></a></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">// [x] AI output (modern JS not supported in EA)</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">let</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="cf">if</span> (<span class="op">!</span>pkg) { <span class="fu">alert</span>(<span class="st">"Select a package"</span>)<span class="op">;</span> }</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a>pkg<span class="op">.</span><span class="at">Elements</span><span class="op">.</span><span class="fu">forEach</span>(e <span class="op">=</span>\<span class="op">&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(e<span class="op">.</span><span class="at">Name</span>))<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This will fail inside EA because:</p>
<ul>
<li><p>let and arrow functions (=&gt;) are unsupported (JScript is ES3).</p></li>
<li><p>EA Collections are not true arrays; .forEach does not exist.</p></li>
<li><p>EA uses Session.Output, not console.log.</p></li>
</ul>
<p>Here’s the corrected version:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 13.1 - ListElements_Corrected.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" data-filename="Example 13.1 - ListElements_Corrected.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">// Example 13.1 - ListElements_Corrected.js – JScript (ES3)</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">// Purpose: Output element names in the selected package</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">// Safe version corrected from AI output</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb2-9"><a href="#cb2-9"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) {</span>
<span id="cb2-11"><a href="#cb2-11"></a>        Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>    }</span>
<span id="cb2-14"><a href="#cb2-14"></a></span>
<span id="cb2-15"><a href="#cb2-15"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb2-17"><a href="#cb2-17"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb2-18"><a href="#cb2-18"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Element: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>    }</span>
<span id="cb2-20"><a href="#cb2-20"></a>}</span>
<span id="cb2-21"><a href="#cb2-21"></a></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="ai-assisted-refactoring" class="level3">
<h3 class="anchored" data-anchor-id="ai-assisted-refactoring">AI-Assisted Refactoring</h3>
<p>You can ask AI:</p>
<p><em>“Refactor this script to add dry-run and logging to CSV.”</em></p>
<p>AI may provide scaffolding, but you need to ensure it respects EA’s environment.</p>
<p>Refactored pattern with dry-run and CSV logging:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 13.2 - RefactorWithDryRun.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" data-filename="Example 13.2 - RefactorWithDryRun.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">// Example 13.2 - RefactorWithDryRun.js – JScript (ES3)</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">// Purpose: Rename all Requirements with prefix, log to CSV</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">// Example of AI-assisted refactor (corrected to EA ES3)</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="kw">var</span> DRY_RUN <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="kw">var</span> PREFIX <span class="op">=</span> <span class="st">"REQ_"</span><span class="op">;</span></span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="kw">var</span> shell <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Shell.Application"</span>)<span class="op">;</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>    <span class="kw">var</span> folder <span class="op">=</span> shell<span class="op">.</span><span class="fu">BrowseForFolder</span>(<span class="dv">0</span><span class="op">,</span> <span class="st">"Select output folder for log CSV"</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>    <span class="cf">if</span> (<span class="op">!</span>folder) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>    <span class="kw">var</span> dir <span class="op">=</span> folder<span class="op">.</span><span class="at">Self</span><span class="op">.</span><span class="at">Path</span><span class="op">;</span></span>
<span id="cb3-16"><a href="#cb3-16"></a></span>
<span id="cb3-17"><a href="#cb3-17"></a>    <span class="kw">var</span> fso <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Scripting.FileSystemObject"</span>)<span class="op">;</span></span>
<span id="cb3-18"><a href="#cb3-18"></a>    <span class="kw">var</span> file <span class="op">=</span> fso<span class="op">.</span><span class="fu">CreateTextFile</span>(dir <span class="op">+</span> <span class="st">"</span><span class="sc">\\</span><span class="st">rename_log.csv"</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb3-19"><a href="#cb3-19"></a>    file<span class="op">.</span><span class="fu">WriteLine</span>(<span class="st">"ElementID,OldName,NewName,Action"</span>)<span class="op">;</span></span>
<span id="cb3-20"><a href="#cb3-20"></a></span>
<span id="cb3-21"><a href="#cb3-21"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb3-22"><a href="#cb3-22"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb3-23"><a href="#cb3-23"></a></span>
<span id="cb3-24"><a href="#cb3-24"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb3-25"><a href="#cb3-25"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb3-26"><a href="#cb3-26"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb3-27"><a href="#cb3-27"></a>        <span class="cf">if</span> (e<span class="op">.</span><span class="at">Type</span> <span class="op">==</span> <span class="st">"Requirement"</span> <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="at">Name</span><span class="op">.</span><span class="fu">indexOf</span>(PREFIX) <span class="op">!=</span> <span class="dv">0</span>) {</span>
<span id="cb3-28"><a href="#cb3-28"></a>            <span class="kw">var</span> newName <span class="op">=</span> PREFIX <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span><span class="op">;</span></span>
<span id="cb3-29"><a href="#cb3-29"></a>            file<span class="op">.</span><span class="fu">WriteLine</span>(e<span class="op">.</span><span class="at">ElementID</span> <span class="op">+</span> <span class="st">","</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span> <span class="op">+</span> <span class="st">","</span> <span class="op">+</span> newName <span class="op">+</span> <span class="st">","</span> <span class="op">+</span> (DRY_RUN <span class="op">?</span> <span class="st">"DRY_RUN"</span> <span class="op">:</span> <span class="st">"RENAME"</span>))<span class="op">;</span></span>
<span id="cb3-30"><a href="#cb3-30"></a>            <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) { e<span class="op">.</span><span class="at">Name</span> <span class="op">=</span> newName<span class="op">;</span> e<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span> }</span>
<span id="cb3-31"><a href="#cb3-31"></a>        }</span>
<span id="cb3-32"><a href="#cb3-32"></a>    }</span>
<span id="cb3-33"><a href="#cb3-33"></a>    <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(pkg<span class="op">.</span><span class="at">PackageID</span>)<span class="op">;</span></span>
<span id="cb3-34"><a href="#cb3-34"></a>    file<span class="op">.</span><span class="fu">Close</span>()<span class="op">;</span></span>
<span id="cb3-35"><a href="#cb3-35"></a></span>
<span id="cb3-36"><a href="#cb3-36"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Script complete. Dry-run="</span> <span class="op">+</span> DRY_RUN)<span class="op">;</span></span>
<span id="cb3-37"><a href="#cb3-37"></a>}</span>
<span id="cb3-38"><a href="#cb3-38"></a></span>
<span id="cb3-39"><a href="#cb3-39"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="using-ai-for-documentation" class="level2">
<h2 class="anchored" data-anchor-id="using-ai-for-documentation">Using AI for Documentation</h2>
<p>Another practical use of AI is <strong>auto-generating headers</strong>. For example, you paste in a script and ask:</p>
<p><em>“Add a structured header with purpose, usage, assumptions, and update history.”</em></p>
<p>AI can reliably produce your desired verbose headers (see Chapter 6’s shared format), saving time and keeping your script library consistent.</p>
</section>
<section id="best-practices-for-ai-assisted-scripting" class="level2">
<h2 class="anchored" data-anchor-id="best-practices-for-ai-assisted-scripting">Best Practices for AI-Assisted Scripting</h2>
<ol type="1">
<li><p><strong>Always state the runtime</strong>: “EA JScript, ES3 only, no ES6 features.”</p></li>
<li><p><strong>Request safety patterns</strong>: dry-run flag, logging, Update() after changes.</p></li>
<li><p><strong>Iterate small</strong>: test on a dummy package, then scale up.</p></li>
<li><p><strong>Curate prompts</strong>: treat prompt engineering as coding. Be explicit.</p></li>
<li><p><strong>Refactor, don’t trust blindly</strong>: AI is a partner, not a replacement.</p></li>
</ol>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>AI helps Sparx EA users by generating scaffolding, converting languages, and automating repetitive refactors. But the constraints of EA’s JScript runtime mean you must always <strong>review, test, and correct</strong> AI outputs. Use AI as an assistant, not an autopilot.</p>
<p>In the next chapter we’ll move to <strong>Chapter 14 – Prompt Engineering</strong>, where we’ll learn how to craft precise prompts that yield safe, useful code for EA.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script>

document.addEventListener('DOMContentLoaded', function () {

  // Prefer the margin sidebar if it exists; otherwise try the TOC sidebar.

  const margin = document.querySelector('#quarto-margin-sidebar, .margin-sidebar, .column-margin');

  const toc    = document.querySelector('nav#TOC');

  const sidebar = margin || (toc && toc.closest('.sidebar, .quarto-sidebar, .margin-sidebar'));



  if (!sidebar) return; // no margin column on this layout



  const holder = document.createElement('div');

  holder.className = 'cover-above-toc';

  holder.innerHTML = `

    <a href="index.html">

      <img src="images/cover.png" alt="Book cover" class="cover-above-toc__img" width="140" />

    </a>

  `;

  sidebar.prepend(holder);

});

</script>



<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./13-System.Object[].html" class="pagination-link" aria-label="Chapter 12: Cookbook of Examples">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Chapter 12: Cookbook of Examples</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./15-System.Object[].html" class="pagination-link" aria-label="Chapter 14: Prompt Engineering">
        <span class="nav-page-text"><span class="chapter-title">Chapter 14: Prompt Engineering</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu"># Chapter 13: Why AI Helps </span></span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>By this point, we have explored why scripting Enterprise Architect is</span>
<span id="cb4-4"><a href="#cb4-4"></a>essential, how the automation landscape is structured, and how to apply</span>
<span id="cb4-5"><a href="#cb4-5"></a>safe, repeatable patterns. We have also seen how practical recipes can</span>
<span id="cb4-6"><a href="#cb4-6"></a>turn concepts into working scripts. Yet for many modellers, one barrier</span>
<span id="cb4-7"><a href="#cb4-7"></a>remains: the leap from knowing *that* scripting is possible to actually</span>
<span id="cb4-8"><a href="#cb4-8"></a>writing the first line of code.</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a>This is where **artificial intelligence (AI)** comes in. Large language</span>
<span id="cb4-11"><a href="#cb4-11"></a>models (LLMs) such as ChatGPT, Claude, or Copilot have introduced a new</span>
<span id="cb4-12"><a href="#cb4-12"></a>way of working: you no longer have to start from a blank editor window.</span>
<span id="cb4-13"><a href="#cb4-13"></a>Instead, you can describe what you want in natural language and receive</span>
<span id="cb4-14"><a href="#cb4-14"></a>a code draft to work with. AI can provide scaffolding, suggest</span>
<span id="cb4-15"><a href="#cb4-15"></a>refactors, and generate boilerplate headers. It cannot replace human</span>
<span id="cb4-16"><a href="#cb4-16"></a>judgement, but it can dramatically accelerate the scripting process.</span>
<span id="cb4-17"><a href="#cb4-17"></a></span>
<span id="cb4-18"><a href="#cb4-18"></a>This chapter examines why AI is such a powerful assistant in the EA</span>
<span id="cb4-19"><a href="#cb4-19"></a>scripting context. It explains the barriers AI helps overcome, the risks</span>
<span id="cb4-20"><a href="#cb4-20"></a>it introduces, and the ways to use it responsibly. By the end, you will</span>
<span id="cb4-21"><a href="#cb4-21"></a>see AI not as a magic solution but as a valuable partner: one that helps</span>
<span id="cb4-22"><a href="#cb4-22"></a>you get started, iterate faster, and learn more effectively.</span>
<span id="cb4-23"><a href="#cb4-23"></a></span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="fu">## Benefits</span></span>
<span id="cb4-25"><a href="#cb4-25"></a></span>
<span id="cb4-26"><a href="#cb4-26"></a><span class="fu">### The Blank Page Problem</span></span>
<span id="cb4-27"><a href="#cb4-27"></a></span>
<span id="cb4-28"><a href="#cb4-28"></a>For many modellers, the hardest part of scripting is not the logic but</span>
<span id="cb4-29"><a href="#cb4-29"></a>the start. Opening EA’s script editor and staring at an empty window can</span>
<span id="cb4-30"><a href="#cb4-30"></a>be intimidating. Even if you know what you want to achieve — “rename all</span>
<span id="cb4-31"><a href="#cb4-31"></a>requirements with a REQ<span class="sc">\_</span> prefix” — translating that into correct</span>
<span id="cb4-32"><a href="#cb4-32"></a>JScript syntax feels daunting.</span>
<span id="cb4-33"><a href="#cb4-33"></a></span>
<span id="cb4-34"><a href="#cb4-34"></a>AI reduces this barrier. By typing a prompt such as *“Write an EA script</span>
<span id="cb4-35"><a href="#cb4-35"></a>that adds a prefix to all Requirement elements in a selected package”*,</span>
<span id="cb4-36"><a href="#cb4-36"></a>you receive a draft that includes the right loop structure, .Count and</span>
<span id="cb4-37"><a href="#cb4-37"></a>.GetAt() calls, and Update() method. It may not be perfect, but it is</span>
<span id="cb4-38"><a href="#cb4-38"></a>far less intimidating than starting from zero.</span>
<span id="cb4-39"><a href="#cb4-39"></a></span>
<span id="cb4-40"><a href="#cb4-40"></a><span class="fu">### AI as a Pattern Generator</span></span>
<span id="cb4-41"><a href="#cb4-41"></a></span>
<span id="cb4-42"><a href="#cb4-42"></a>Earlier chapters emphasised the importance of scripting patterns:</span>
<span id="cb4-43"><a href="#cb4-43"></a>Find/Filter/Apply, Tag Propagation, Curate-then-Write. AI is good at</span>
<span id="cb4-44"><a href="#cb4-44"></a>recognising these patterns and generating boilerplate loops. Instead of</span>
<span id="cb4-45"><a href="#cb4-45"></a>writing the same traversal logic repeatedly, you can ask AI to generate</span>
<span id="cb4-46"><a href="#cb4-46"></a>it and then adjust the details.</span>
<span id="cb4-47"><a href="#cb4-47"></a></span>
<span id="cb4-48"><a href="#cb4-48"></a>For example, a prompt like *“Write a Find/Filter/Apply script that sets</span>
<span id="cb4-49"><a href="#cb4-49"></a>the Status to Approved for all Requirements tagged with</span>
<span id="cb4-50"><a href="#cb4-50"></a>‘Owner=Architecture’”* can yield a working draft in seconds.</span>
<span id="cb4-51"><a href="#cb4-51"></a></span>
<span id="cb4-52"><a href="#cb4-52"></a><span class="fu">### AI as a Translator</span></span>
<span id="cb4-53"><a href="#cb4-53"></a></span>
<span id="cb4-54"><a href="#cb4-54"></a>One of the practical challenges in EA scripting is the language choice.</span>
<span id="cb4-55"><a href="#cb4-55"></a>Many legacy scripts are in VBScript, while most new ones are in JScript.</span>
<span id="cb4-56"><a href="#cb4-56"></a>AI can act as a **translator**, converting VBScript examples into</span>
<span id="cb4-57"><a href="#cb4-57"></a>JScript ES3. It can also help migrate JScript snippets into Python or C#</span>
<span id="cb4-58"><a href="#cb4-58"></a>for external automation.</span>
<span id="cb4-59"><a href="#cb4-59"></a></span>
<span id="cb4-60"><a href="#cb4-60"></a>For example, you might paste an old VBScript snippet and ask:</span>
<span id="cb4-61"><a href="#cb4-61"></a>*“Translate this into JScript (ES3 only, no forEach, no JSON methods).”*</span>
<span id="cb4-62"><a href="#cb4-62"></a>AI can provide a draft translation that saves hours of manual effort.</span>
<span id="cb4-63"><a href="#cb4-63"></a></span>
<span id="cb4-64"><a href="#cb4-64"></a><span class="fu">### AI as a Refactoring Partner</span></span>
<span id="cb4-65"><a href="#cb4-65"></a></span>
<span id="cb4-66"><a href="#cb4-66"></a>As your script library grows, you may notice duplication: multiple</span>
<span id="cb4-67"><a href="#cb4-67"></a>scripts with similar loops, slightly different logic, inconsistent</span>
<span id="cb4-68"><a href="#cb4-68"></a>logging. AI can help refactor them into cleaner, more consistent</span>
<span id="cb4-69"><a href="#cb4-69"></a>structures.</span>
<span id="cb4-70"><a href="#cb4-70"></a></span>
<span id="cb4-71"><a href="#cb4-71"></a>For instance, you might prompt: *“Refactor this script to include a</span>
<span id="cb4-72"><a href="#cb4-72"></a>DRY_RUN flag and a logging function that writes to CSV.”* AI will</span>
<span id="cb4-73"><a href="#cb4-73"></a>propose a refactored version, which you can then validate. This makes it</span>
<span id="cb4-74"><a href="#cb4-74"></a>easier to standardise your script style and enforce governance</span>
<span id="cb4-75"><a href="#cb4-75"></a>principles.</span>
<span id="cb4-76"><a href="#cb4-76"></a></span>
<span id="cb4-77"><a href="#cb4-77"></a><span class="fu">### AI for Documentation and Training</span></span>
<span id="cb4-78"><a href="#cb4-78"></a></span>
<span id="cb4-79"><a href="#cb4-79"></a>Another way AI adds value is in **documentation**. Good scripts should</span>
<span id="cb4-80"><a href="#cb4-80"></a>always include headers (purpose, usage, assumptions, safety,</span>
<span id="cb4-81"><a href="#cb4-81"></a>dependencies). Writing these headers can feel tedious. AI can generate</span>
<span id="cb4-82"><a href="#cb4-82"></a>them for you.</span>
<span id="cb4-83"><a href="#cb4-83"></a></span>
<span id="cb4-84"><a href="#cb4-84"></a>Similarly, AI can create training material: explainers, walkthroughs, or</span>
<span id="cb4-85"><a href="#cb4-85"></a>alternative language examples. For new team members, you can paste a</span>
<span id="cb4-86"><a href="#cb4-86"></a>script into AI and ask it to explain what each line does in plain</span>
<span id="cb4-87"><a href="#cb4-87"></a>English. This makes onboarding easier.</span>
<span id="cb4-88"><a href="#cb4-88"></a></span>
<span id="cb4-89"><a href="#cb4-89"></a><span class="fu">#### The Risks of AI in Scripting</span></span>
<span id="cb4-90"><a href="#cb4-90"></a></span>
<span id="cb4-91"><a href="#cb4-91"></a>Of course, AI is not perfect. In fact, it is often confidently wrong.</span>
<span id="cb4-92"><a href="#cb4-92"></a>Common risks include:</span>
<span id="cb4-93"><a href="#cb4-93"></a></span>
<span id="cb4-94"><a href="#cb4-94"></a><span class="ss">- </span>**Hallucinations**: inventing methods that do not exist (e.g., forEach</span>
<span id="cb4-95"><a href="#cb4-95"></a>  on EA collections).</span>
<span id="cb4-96"><a href="#cb4-96"></a></span>
<span id="cb4-97"><a href="#cb4-97"></a><span class="ss">- </span>**Unsupported syntax**: using modern JavaScript features (let, const,</span>
<span id="cb4-98"><a href="#cb4-98"></a>  arrow functions) that fail in EA’s ES3 engine.</span>
<span id="cb4-99"><a href="#cb4-99"></a></span>
<span id="cb4-100"><a href="#cb4-100"></a><span class="ss">- </span>**Unsafe updates**: forgetting to include Update() or DRY_RUN, leading</span>
<span id="cb4-101"><a href="#cb4-101"></a>  to destructive changes.</span>
<span id="cb4-102"><a href="#cb4-102"></a></span>
<span id="cb4-103"><a href="#cb4-103"></a><span class="ss">- </span>**Performance issues**: generating scripts that spam Session.Output</span>
<span id="cb4-104"><a href="#cb4-104"></a>  thousands of times.</span>
<span id="cb4-105"><a href="#cb4-105"></a></span>
<span id="cb4-106"><a href="#cb4-106"></a>These risks are not minor. If you copy AI output blindly into a</span>
<span id="cb4-107"><a href="#cb4-107"></a>production repository, you may corrupt or damage your model. That is why</span>
<span id="cb4-108"><a href="#cb4-108"></a>AI must always be used with caution.</span>
<span id="cb4-109"><a href="#cb4-109"></a></span>
<span id="cb4-110"><a href="#cb4-110"></a><span class="fu">## Using AI Safely</span></span>
<span id="cb4-111"><a href="#cb4-111"></a></span>
<span id="cb4-112"><a href="#cb4-112"></a>The key to using AI effectively is to treat it as a **drafting tool**,</span>
<span id="cb4-113"><a href="#cb4-113"></a>not an authority. You are the architect; AI is your assistant. That</span>
<span id="cb4-114"><a href="#cb4-114"></a>means:</span>
<span id="cb4-115"><a href="#cb4-115"></a></span>
<span id="cb4-116"><a href="#cb4-116"></a><span class="ss">1.  </span>**Craft precise prompts** — specify ES3, mention .Count/.GetAt(),</span>
<span id="cb4-117"><a href="#cb4-117"></a>    require DRY_RUN.</span>
<span id="cb4-118"><a href="#cb4-118"></a></span>
<span id="cb4-119"><a href="#cb4-119"></a><span class="ss">2.  </span>**Always dry-run first** — never trust AI code without logging and</span>
<span id="cb4-120"><a href="#cb4-120"></a>    simulation.</span>
<span id="cb4-121"><a href="#cb4-121"></a></span>
<span id="cb4-122"><a href="#cb4-122"></a><span class="ss">3.  </span>**Review carefully** — read the script line by line, confirm</span>
<span id="cb4-123"><a href="#cb4-123"></a>    Update() is included where needed.</span>
<span id="cb4-124"><a href="#cb4-124"></a></span>
<span id="cb4-125"><a href="#cb4-125"></a><span class="ss">4.  </span>**Test on sandboxes** — never run AI-generated scripts directly on</span>
<span id="cb4-126"><a href="#cb4-126"></a>    production repositories.</span>
<span id="cb4-127"><a href="#cb4-127"></a></span>
<span id="cb4-128"><a href="#cb4-128"></a>With these safeguards, AI becomes a useful accelerator rather than a</span>
<span id="cb4-129"><a href="#cb4-129"></a>liability.</span>
<span id="cb4-130"><a href="#cb4-130"></a></span>
<span id="cb4-131"><a href="#cb4-131"></a><span class="fu">## AI and Learning</span></span>
<span id="cb4-132"><a href="#cb4-132"></a></span>
<span id="cb4-133"><a href="#cb4-133"></a>Interestingly, using AI to generate scripts can also accelerate your own</span>
<span id="cb4-134"><a href="#cb4-134"></a>learning. When you compare AI’s draft to your mental model, you notice</span>
<span id="cb4-135"><a href="#cb4-135"></a>differences. Sometimes AI is wrong, and that highlights a gap in your</span>
<span id="cb4-136"><a href="#cb4-136"></a>own understanding. Sometimes AI uses a trick you didn’t know, and you</span>
<span id="cb4-137"><a href="#cb4-137"></a>learn from it.</span>
<span id="cb4-138"><a href="#cb4-138"></a></span>
<span id="cb4-139"><a href="#cb4-139"></a>Over time, AI becomes a tutor. You experiment by prompting, you review</span>
<span id="cb4-140"><a href="#cb4-140"></a>the results, you test and refine. The process itself builds fluency in</span>
<span id="cb4-141"><a href="#cb4-141"></a>the EA API.</span>
<span id="cb4-142"><a href="#cb4-142"></a></span>
<span id="cb4-143"><a href="#cb4-143"></a><span class="fu">## AI in Daily Workflow</span></span>
<span id="cb4-144"><a href="#cb4-144"></a></span>
<span id="cb4-145"><a href="#cb4-145"></a>Later in this book (Chapter 15), we will explore AI in daily workflow:</span>
<span id="cb4-146"><a href="#cb4-146"></a>prompt libraries, Git integration, and governance checks. For now, the</span>
<span id="cb4-147"><a href="#cb4-147"></a>key point is that AI is not just for occasional inspiration; it can be</span>
<span id="cb4-148"><a href="#cb4-148"></a>integrated into your routine. Whether you are writing a new script,</span>
<span id="cb4-149"><a href="#cb4-149"></a>refactoring an old one, or explaining a script to a colleague, AI can</span>
<span id="cb4-150"><a href="#cb4-150"></a>help.</span>
<span id="cb4-151"><a href="#cb4-151"></a></span>
<span id="cb4-152"><a href="#cb4-152"></a><span class="fu">## Examples</span></span>
<span id="cb4-153"><a href="#cb4-153"></a></span>
<span id="cb4-154"><a href="#cb4-154"></a><span class="fu">### AI-generated vs Corrected</span></span>
<span id="cb4-155"><a href="#cb4-155"></a></span>
<span id="cb4-156"><a href="#cb4-156"></a>Suppose you ask an AI:</span>
<span id="cb4-157"><a href="#cb4-157"></a></span>
<span id="cb4-158"><a href="#cb4-158"></a>*“Write a script that lists all elements in a package.”*</span>
<span id="cb4-159"><a href="#cb4-159"></a></span>
<span id="cb4-160"><a href="#cb4-160"></a>You might get this **wrong version**:</span>
<span id="cb4-161"><a href="#cb4-161"></a><span class="in">```.js</span></span>
<span id="cb4-162"><a href="#cb4-162"></a></span>
<span id="cb4-163"><a href="#cb4-163"></a><span class="co">// [x] AI output (modern JS not supported in EA)</span></span>
<span id="cb4-164"><a href="#cb4-164"></a></span>
<span id="cb4-165"><a href="#cb4-165"></a><span class="kw">let</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb4-166"><a href="#cb4-166"></a></span>
<span id="cb4-167"><a href="#cb4-167"></a><span class="cf">if</span> (<span class="op">!</span>pkg) { <span class="fu">alert</span>(<span class="st">"Select a package"</span>)<span class="op">;</span> }</span>
<span id="cb4-168"><a href="#cb4-168"></a></span>
<span id="cb4-169"><a href="#cb4-169"></a>pkg<span class="op">.</span><span class="at">Elements</span><span class="op">.</span><span class="fu">forEach</span>(e <span class="op">=</span>\<span class="op">&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(e<span class="op">.</span><span class="at">Name</span>))<span class="op">;</span></span>
<span id="cb4-170"><a href="#cb4-170"></a><span class="in">```</span></span>
<span id="cb4-171"><a href="#cb4-171"></a></span>
<span id="cb4-172"><a href="#cb4-172"></a>This will fail inside EA because:</span>
<span id="cb4-173"><a href="#cb4-173"></a></span>
<span id="cb4-174"><a href="#cb4-174"></a><span class="ss">- </span>let and arrow functions (=<span class="sc">\&gt;</span>) are unsupported (JScript is ES3).</span>
<span id="cb4-175"><a href="#cb4-175"></a></span>
<span id="cb4-176"><a href="#cb4-176"></a><span class="ss">- </span>EA Collections are not true arrays; .forEach does not exist.</span>
<span id="cb4-177"><a href="#cb4-177"></a></span>
<span id="cb4-178"><a href="#cb4-178"></a><span class="ss">- </span>EA uses Session.Output, not console.log.</span>
<span id="cb4-179"><a href="#cb4-179"></a></span>
<span id="cb4-180"><a href="#cb4-180"></a>Here’s the corrected version:</span>
<span id="cb4-181"><a href="#cb4-181"></a></span>
<span id="cb4-182"><a href="#cb4-182"></a><span class="in">```{.js filename="Example 13.1 - ListElements_Corrected.js – JScript (ES3)"}</span></span>
<span id="cb4-183"><a href="#cb4-183"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb4-184"><a href="#cb4-184"></a><span class="co">// Example 13.1 - ListElements_Corrected.js – JScript (ES3)</span></span>
<span id="cb4-185"><a href="#cb4-185"></a><span class="co">// Purpose: Output element names in the selected package</span></span>
<span id="cb4-186"><a href="#cb4-186"></a><span class="co">// Safe version corrected from AI output</span></span>
<span id="cb4-187"><a href="#cb4-187"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb4-188"><a href="#cb4-188"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb4-189"><a href="#cb4-189"></a></span>
<span id="cb4-190"><a href="#cb4-190"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb4-191"><a href="#cb4-191"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb4-192"><a href="#cb4-192"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) {</span>
<span id="cb4-193"><a href="#cb4-193"></a>        Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span></span>
<span id="cb4-194"><a href="#cb4-194"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb4-195"><a href="#cb4-195"></a>    }</span>
<span id="cb4-196"><a href="#cb4-196"></a></span>
<span id="cb4-197"><a href="#cb4-197"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb4-198"><a href="#cb4-198"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb4-199"><a href="#cb4-199"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb4-200"><a href="#cb4-200"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Element: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb4-201"><a href="#cb4-201"></a>    }</span>
<span id="cb4-202"><a href="#cb4-202"></a>}</span>
<span id="cb4-203"><a href="#cb4-203"></a></span>
<span id="cb4-204"><a href="#cb4-204"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb4-205"><a href="#cb4-205"></a><span class="in">```</span></span>
<span id="cb4-206"><a href="#cb4-206"></a></span>
<span id="cb4-207"><a href="#cb4-207"></a><span class="fu">### AI-Assisted Refactoring</span></span>
<span id="cb4-208"><a href="#cb4-208"></a></span>
<span id="cb4-209"><a href="#cb4-209"></a>You can ask AI:</span>
<span id="cb4-210"><a href="#cb4-210"></a></span>
<span id="cb4-211"><a href="#cb4-211"></a>*“Refactor this script to add dry-run and logging to CSV.”*</span>
<span id="cb4-212"><a href="#cb4-212"></a></span>
<span id="cb4-213"><a href="#cb4-213"></a>AI may provide scaffolding, but you need to ensure it respects EA’s</span>
<span id="cb4-214"><a href="#cb4-214"></a>environment.</span>
<span id="cb4-215"><a href="#cb4-215"></a></span>
<span id="cb4-216"><a href="#cb4-216"></a>Refactored pattern with dry-run and CSV logging:</span>
<span id="cb4-217"><a href="#cb4-217"></a><span class="in">```{.js filename="Example 13.2 - RefactorWithDryRun.js – JScript (ES3)"}</span></span>
<span id="cb4-218"><a href="#cb4-218"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb4-219"><a href="#cb4-219"></a><span class="co">// Example 13.2 - RefactorWithDryRun.js – JScript (ES3)</span></span>
<span id="cb4-220"><a href="#cb4-220"></a><span class="co">// Purpose: Rename all Requirements with prefix, log to CSV</span></span>
<span id="cb4-221"><a href="#cb4-221"></a><span class="co">// Example of AI-assisted refactor (corrected to EA ES3)</span></span>
<span id="cb4-222"><a href="#cb4-222"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb4-223"><a href="#cb4-223"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb4-224"><a href="#cb4-224"></a></span>
<span id="cb4-225"><a href="#cb4-225"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb4-226"><a href="#cb4-226"></a>    <span class="kw">var</span> DRY_RUN <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb4-227"><a href="#cb4-227"></a>    <span class="kw">var</span> PREFIX <span class="op">=</span> <span class="st">"REQ_"</span><span class="op">;</span></span>
<span id="cb4-228"><a href="#cb4-228"></a></span>
<span id="cb4-229"><a href="#cb4-229"></a>    <span class="kw">var</span> shell <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Shell.Application"</span>)<span class="op">;</span></span>
<span id="cb4-230"><a href="#cb4-230"></a>    <span class="kw">var</span> folder <span class="op">=</span> shell<span class="op">.</span><span class="fu">BrowseForFolder</span>(<span class="dv">0</span><span class="op">,</span> <span class="st">"Select output folder for log CSV"</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb4-231"><a href="#cb4-231"></a>    <span class="cf">if</span> (<span class="op">!</span>folder) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb4-232"><a href="#cb4-232"></a>    <span class="kw">var</span> dir <span class="op">=</span> folder<span class="op">.</span><span class="at">Self</span><span class="op">.</span><span class="at">Path</span><span class="op">;</span></span>
<span id="cb4-233"><a href="#cb4-233"></a></span>
<span id="cb4-234"><a href="#cb4-234"></a>    <span class="kw">var</span> fso <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Scripting.FileSystemObject"</span>)<span class="op">;</span></span>
<span id="cb4-235"><a href="#cb4-235"></a>    <span class="kw">var</span> file <span class="op">=</span> fso<span class="op">.</span><span class="fu">CreateTextFile</span>(dir <span class="op">+</span> <span class="st">"</span><span class="sc">\\</span><span class="st">rename_log.csv"</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb4-236"><a href="#cb4-236"></a>    file<span class="op">.</span><span class="fu">WriteLine</span>(<span class="st">"ElementID,OldName,NewName,Action"</span>)<span class="op">;</span></span>
<span id="cb4-237"><a href="#cb4-237"></a></span>
<span id="cb4-238"><a href="#cb4-238"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb4-239"><a href="#cb4-239"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb4-240"><a href="#cb4-240"></a></span>
<span id="cb4-241"><a href="#cb4-241"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb4-242"><a href="#cb4-242"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb4-243"><a href="#cb4-243"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb4-244"><a href="#cb4-244"></a>        <span class="cf">if</span> (e<span class="op">.</span><span class="at">Type</span> <span class="op">==</span> <span class="st">"Requirement"</span> <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="at">Name</span><span class="op">.</span><span class="fu">indexOf</span>(PREFIX) <span class="op">!=</span> <span class="dv">0</span>) {</span>
<span id="cb4-245"><a href="#cb4-245"></a>            <span class="kw">var</span> newName <span class="op">=</span> PREFIX <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span><span class="op">;</span></span>
<span id="cb4-246"><a href="#cb4-246"></a>            file<span class="op">.</span><span class="fu">WriteLine</span>(e<span class="op">.</span><span class="at">ElementID</span> <span class="op">+</span> <span class="st">","</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span> <span class="op">+</span> <span class="st">","</span> <span class="op">+</span> newName <span class="op">+</span> <span class="st">","</span> <span class="op">+</span> (DRY_RUN <span class="op">?</span> <span class="st">"DRY_RUN"</span> <span class="op">:</span> <span class="st">"RENAME"</span>))<span class="op">;</span></span>
<span id="cb4-247"><a href="#cb4-247"></a>            <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) { e<span class="op">.</span><span class="at">Name</span> <span class="op">=</span> newName<span class="op">;</span> e<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span> }</span>
<span id="cb4-248"><a href="#cb4-248"></a>        }</span>
<span id="cb4-249"><a href="#cb4-249"></a>    }</span>
<span id="cb4-250"><a href="#cb4-250"></a>    <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(pkg<span class="op">.</span><span class="at">PackageID</span>)<span class="op">;</span></span>
<span id="cb4-251"><a href="#cb4-251"></a>    file<span class="op">.</span><span class="fu">Close</span>()<span class="op">;</span></span>
<span id="cb4-252"><a href="#cb4-252"></a></span>
<span id="cb4-253"><a href="#cb4-253"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Script complete. Dry-run="</span> <span class="op">+</span> DRY_RUN)<span class="op">;</span></span>
<span id="cb4-254"><a href="#cb4-254"></a>}</span>
<span id="cb4-255"><a href="#cb4-255"></a></span>
<span id="cb4-256"><a href="#cb4-256"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb4-257"><a href="#cb4-257"></a><span class="in">```</span></span>
<span id="cb4-258"><a href="#cb4-258"></a></span>
<span id="cb4-259"><a href="#cb4-259"></a><span class="fu">## Using AI for Documentation</span></span>
<span id="cb4-260"><a href="#cb4-260"></a></span>
<span id="cb4-261"><a href="#cb4-261"></a>Another practical use of AI is **auto-generating headers**. For example,</span>
<span id="cb4-262"><a href="#cb4-262"></a>you paste in a script and ask:</span>
<span id="cb4-263"><a href="#cb4-263"></a></span>
<span id="cb4-264"><a href="#cb4-264"></a>*“Add a structured header with purpose, usage, assumptions, and update</span>
<span id="cb4-265"><a href="#cb4-265"></a>history.”*</span>
<span id="cb4-266"><a href="#cb4-266"></a></span>
<span id="cb4-267"><a href="#cb4-267"></a>AI can reliably produce your desired verbose headers (see Chapter 6’s</span>
<span id="cb4-268"><a href="#cb4-268"></a>shared format), saving time and keeping your script library consistent.</span>
<span id="cb4-269"><a href="#cb4-269"></a></span>
<span id="cb4-270"><a href="#cb4-270"></a><span class="fu">## Best Practices for AI-Assisted Scripting</span></span>
<span id="cb4-271"><a href="#cb4-271"></a></span>
<span id="cb4-272"><a href="#cb4-272"></a><span class="ss">1.  </span>**Always state the runtime**: “EA JScript, ES3 only, no ES6</span>
<span id="cb4-273"><a href="#cb4-273"></a>    features.”</span>
<span id="cb4-274"><a href="#cb4-274"></a></span>
<span id="cb4-275"><a href="#cb4-275"></a><span class="ss">2.  </span>**Request safety patterns**: dry-run flag, logging, Update() after</span>
<span id="cb4-276"><a href="#cb4-276"></a>    changes.</span>
<span id="cb4-277"><a href="#cb4-277"></a></span>
<span id="cb4-278"><a href="#cb4-278"></a><span class="ss">3.  </span>**Iterate small**: test on a dummy package, then scale up.</span>
<span id="cb4-279"><a href="#cb4-279"></a></span>
<span id="cb4-280"><a href="#cb4-280"></a><span class="ss">4.  </span>**Curate prompts**: treat prompt engineering as coding. Be explicit.</span>
<span id="cb4-281"><a href="#cb4-281"></a></span>
<span id="cb4-282"><a href="#cb4-282"></a><span class="ss">5.  </span>**Refactor, don’t trust blindly**: AI is a partner, not a</span>
<span id="cb4-283"><a href="#cb4-283"></a>    replacement.</span>
<span id="cb4-284"><a href="#cb4-284"></a></span>
<span id="cb4-285"><a href="#cb4-285"></a><span class="fu">## Summary</span></span>
<span id="cb4-286"><a href="#cb4-286"></a></span>
<span id="cb4-287"><a href="#cb4-287"></a>AI helps Sparx EA users by generating scaffolding, converting languages,</span>
<span id="cb4-288"><a href="#cb4-288"></a>and automating repetitive refactors. But the constraints of EA’s JScript</span>
<span id="cb4-289"><a href="#cb4-289"></a>runtime mean you must always **review, test, and correct** AI outputs.</span>
<span id="cb4-290"><a href="#cb4-290"></a>Use AI as an assistant, not an autopilot.</span>
<span id="cb4-291"><a href="#cb4-291"></a></span>
<span id="cb4-292"><a href="#cb4-292"></a>In the next chapter we’ll move to **Chapter 14 – Prompt Engineering**, where we’ll learn how to craft precise prompts that</span>
<span id="cb4-293"><a href="#cb4-293"></a>yield safe, useful code for EA.</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>