<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 5: Inside EA with JScript – Scripting Sparx Enterprise Architect: A Practical Handbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./07-System.Object[].html" rel="next">
<link href="./05-System.Object[].html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b4ddde2c4c77ed14ccfa95278770da4f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./06-System.Object[].html"><span class="chapter-title">Chapter 5: Inside EA with JScript</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Scripting Sparx Enterprise Architect: A Practical Handbook</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Scripting Sparx Enterprise Architect</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 1: Why Script EA?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 2: Automation Landscape</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3: Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 4: API Essentials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-System.Object[].html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Chapter 5: Inside EA with JScript</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 6: External Automation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 7: Script Design Patterns</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 8: Object Details</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 9: Imports &amp; Exports</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 10: MDG-Aware Scripting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 11: Governance Scripts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 12: Cookbook of Examples</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 13: Why AI Helps</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 14: Prompt Engineering</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 15: AI Refactoring Partner</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 16: AI in Daily Workflow</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 17: Performance &amp; Scaling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 18: Integrating with Workflows</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 19: Add-ins vs Scripts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 20: Troubleshooting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 21: Reference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix A: Scripting Constraints</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix B: External Automation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix C: Glossary of Terms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix D: Quick Reference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix E: External Automation Setup</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-language-landscape" id="toc-the-language-landscape" class="nav-link active" data-scroll-target="#the-language-landscape">The Language Landscape</a></li>
  <li><a href="#javascript-or-jscript" id="toc-javascript-or-jscript" class="nav-link" data-scroll-target="#javascript-or-jscript">JavaScript or JScript?</a></li>
  <li><a href="#the-constraints-of-jscript-es3" id="toc-the-constraints-of-jscript-es3" class="nav-link" data-scroll-target="#the-constraints-of-jscript-es3">The Constraints of JScript ES3</a></li>
  <li><a href="#scripting-tips" id="toc-scripting-tips" class="nav-link" data-scroll-target="#scripting-tips">Scripting Tips</a>
  <ul class="collapse">
  <li><a href="#adapting-to-ea-collections" id="toc-adapting-to-ea-collections" class="nav-link" data-scroll-target="#adapting-to-ea-collections">Adapting to EA Collections</a></li>
  <li><a href="#logging-with-session.output" id="toc-logging-with-session.output" class="nav-link" data-scroll-target="#logging-with-session.output">Logging with Session.Output</a></li>
  <li><a href="#dry-run-and-logging-discipline" id="toc-dry-run-and-logging-discipline" class="nav-link" data-scroll-target="#dry-run-and-logging-discipline">Dry-Run and Logging Discipline</a></li>
  <li><a href="#the-benefits-of-simplicity" id="toc-the-benefits-of-simplicity" class="nav-link" data-scroll-target="#the-benefits-of-simplicity">The Benefits of Simplicity</a></li>
  <li><a href="#thinking-like-a-modeller" id="toc-thinking-like-a-modeller" class="nav-link" data-scroll-target="#thinking-like-a-modeller">Thinking Like a Modeller</a></li>
  </ul></li>
  <li><a href="#a-progressive-learning-curve" id="toc-a-progressive-learning-curve" class="nav-link" data-scroll-target="#a-progressive-learning-curve">A Progressive Learning Curve</a></li>
  <li><a href="#preparing-for-the-examples" id="toc-preparing-for-the-examples" class="nav-link" data-scroll-target="#preparing-for-the-examples">Preparing for the Examples</a>
  <ul class="collapse">
  <li><a href="#safe-variable-declarations" id="toc-safe-variable-declarations" class="nav-link" data-scroll-target="#safe-variable-declarations">Safe Variable Declarations</a></li>
  <li><a href="#utility-functions" id="toc-utility-functions" class="nav-link" data-scroll-target="#utility-functions">Utility Functions</a></li>
  <li><a href="#iterating-ea-collections" id="toc-iterating-ea-collections" class="nav-link" data-scroll-target="#iterating-ea-collections">Iterating EA Collections</a></li>
  <li><a href="#file-io-with-activex" id="toc-file-io-with-activex" class="nav-link" data-scroll-target="#file-io-with-activex">File I/O with ActiveX</a></li>
  <li><a href="#debugging-with-session.output" id="toc-debugging-with-session.output" class="nav-link" data-scroll-target="#debugging-with-session.output">Debugging with Session.Output</a></li>
  <li><a href="#error-handling" id="toc-error-handling" class="nav-link" data-scroll-target="#error-handling">Error Handling</a></li>
  <li><a href="#putting-it-all-together" id="toc-putting-it-all-together" class="nav-link" data-scroll-target="#putting-it-all-together">Putting It All Together</a></li>
  </ul></li>
  <li><a href="#looking-ahead" id="toc-looking-ahead" class="nav-link" data-scroll-target="#looking-ahead">Looking Ahead</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">Chapter 5: Inside EA with JScript</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The previous chapters have explained why you would script Enterprise Architect (EA), how automation fits into the overall landscape, and which core objects form the backbone of the API. Now it is time to get specific about the scripting language you will actually use inside EA.</p>
<p>EA provides three options in its built-in scripting window: <strong>VBScript</strong>, <strong>JScript</strong>, and in newer versions, <strong>JavaScript</strong>. Each of these has its own history, syntax, and quirks. For most users today, the best balance of accessibility, capability, and long-term viability is found in <strong>JavaScript</strong> — or more accurately, in Microsoft’s JScript engine, which is EA’s internal implementation of ECMAScript 3.</p>
<p>This chapter explores what it means to work inside EA with JavaScript/JScript. It explains the constraints of the runtime, the pitfalls of assuming modern ECMAScript features, and the techniques that make the language usable for practical automation. It also sets expectations: you will not be writing modern Node.js code, but you can still achieve powerful results with a lean, disciplined subset of JavaScript.</p>
<section id="the-language-landscape" class="level2">
<h2 class="anchored" data-anchor-id="the-language-landscape">The Language Landscape</h2>
<p>Why does EA support these languages? The answer lies in its history. In the early 2000s, Windows scripting was dominated by <strong>VBScript</strong> and <strong>JScript</strong>, both hosted by the Windows Script Host. They were the default scripting choices for automation in Microsoft Office and many other applications. EA adopted them as its embedded scripting languages.</p>
<p>VBScript is verbose, procedural, and feels like a cousin of Visual Basic for Applications (VBA). JScript is Microsoft’s implementation of ECMAScript 3 (ES3), roughly equivalent to JavaScript as it existed in Internet Explorer 6.</p>
<p>More recently, Sparx Systems added support for JavaScript labelled as such, but under the hood it is still the JScript ES3 runtime. That means many of the features you may expect from modern JavaScript — let, const, arrow functions, array methods like forEach, JSON parsing — are missing. If you try to use them, your script will fail.</p>
</section>
<section id="javascript-or-jscript" class="level2">
<h2 class="anchored" data-anchor-id="javascript-or-jscript">JavaScript or JScript?</h2>
<p>Given these limitations, why choose JavaScript over VBScript? There are several reasons:</p>
<ul>
<li><p><strong>Familiarity</strong>: even with its older syntax, JavaScript feels more familiar to today’s developers and architects than VBScript.</p></li>
<li><p><strong>Readability</strong>: JScript code tends to be shorter and cleaner than equivalent VBScript.</p></li>
<li><p><strong>Longevity</strong>: while VBScript has been officially deprecated by Microsoft, JavaScript remains the world’s most widely used language. Even if EA lags in its runtime, the language concepts remain transferable.</p></li>
<li><p><strong>Transition potential</strong>: once you know how to script EA in JScript, moving to external JavaScript (Node.js, modern ES) or Python is easier.</p></li>
</ul>
<p>For these reasons, this book assumes you will primarily use <strong>JScript/JavaScript</strong> as your internal scripting language. VBScript examples are included occasionally for reference, but JScript is the pragmatic choice going forward.</p>
</section>
<section id="the-constraints-of-jscript-es3" class="level2">
<h2 class="anchored" data-anchor-id="the-constraints-of-jscript-es3">The Constraints of JScript ES3</h2>
<p>The most important thing to understand is what you <strong>cannot do</strong> in EA’s JScript engine. Here are the key constraints:</p>
<ul>
<li><p><strong>No modern declarations</strong>: only var is allowed; let and const are not recognised.</p></li>
<li><p><strong>No arrow functions</strong>: ()=&gt; syntax is invalid. Use function() instead.</p></li>
<li><p><strong>No array helpers</strong>: methods like forEach, map, filter, reduce do not exist.</p></li>
<li><p><strong>No JSON methods</strong>: JSON.parse and JSON.stringify are not available. If you need JSON, you must parse manually or use external automation.</p></li>
<li><p><strong>No promises or async/await</strong>: everything is synchronous.</p></li>
<li><p><strong>String handling</strong>: only basic functions like indexOf, substring, replace are available.</p></li>
</ul>
<p>This feels restrictive, especially if you come from modern JavaScript. But it is enough for the kinds of tasks EA scripting requires: traversing collections, setting properties, logging, and basic string manipulation.</p>
</section>
<section id="scripting-tips" class="level2">
<h2 class="anchored" data-anchor-id="scripting-tips">Scripting Tips</h2>
<section id="adapting-to-ea-collections" class="level3">
<h3 class="anchored" data-anchor-id="adapting-to-ea-collections">Adapting to EA Collections</h3>
<p>One of the most common mistakes beginners make is assuming EA’s collections behave like JavaScript arrays. They do not. EA’s collections are COM objects. They expose only two members: .Count and .GetAt(index).</p>
<p>That means you must loop with a standard for loop:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb1-3"><a href="#cb1-3"></a>    <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>    Session<span class="op">.</span><span class="fu">Output</span>(e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Try to call els.forEach(…) and you will get an error. Understanding this quirk is half the battle of learning EA scripting.</p>
</section>
<section id="logging-with-session.output" class="level3">
<h3 class="anchored" data-anchor-id="logging-with-session.output">Logging with Session.Output</h3>
<p>Another adaptation is how you print feedback. There is no console.log. Instead, EA provides Session.Output, which writes to the Output tab. For example:</p>
<p>Session.Output(“Hello from EA!”);</p>
<p>For large operations, use file logging instead (via FileSystemObject), because thousands of lines in the Output tab will slow EA down.</p>
</section>
<section id="dry-run-and-logging-discipline" class="level3">
<h3 class="anchored" data-anchor-id="dry-run-and-logging-discipline">Dry-Run and Logging Discipline</h3>
<p>The limitations of the language make <strong>discipline even more important</strong>. That is why this book insists on starting every modifying script with a DRY_RUN flag and embedding structured logging. Because there is no undo, and because the debugging tools are limited, you must build safety into your scripts from the start.</p>
</section>
<section id="the-benefits-of-simplicity" class="level3">
<h3 class="anchored" data-anchor-id="the-benefits-of-simplicity">The Benefits of Simplicity</h3>
<p>There is a positive side to JScript’s limitations: it forces you to keep scripts <strong>simple and focused</strong>. Each script should do one thing well — rename elements, export to CSV, check for missing tags. You won’t be tempted to over-engineer or add unnecessary abstractions.</p>
<p>For larger tasks, the advice is clear: use external automation in Python or C#. Internal JScript is for sharp, focused tools that run close to the model.</p>
</section>
<section id="thinking-like-a-modeller" class="level3">
<h3 class="anchored" data-anchor-id="thinking-like-a-modeller">Thinking Like a Modeller</h3>
<p>It is worth remembering that most EA users are not professional programmers. They are architects, analysts, engineers — people who need automation to support modelling, not to build software products. JScript inside EA is perfectly suited to this audience. It lets you express simple logic in a few lines. It integrates directly with the repository. It is always available without external setup.</p>
<p>This chapter is therefore less about writing elegant JavaScript and more about <strong>thinking like a modeller who scripts</strong>. The aim is clarity, safety, and repeatability.</p>
</section>
</section>
<section id="a-progressive-learning-curve" class="level2">
<h2 class="anchored" data-anchor-id="a-progressive-learning-curve">A Progressive Learning Curve</h2>
<p>The examples in this chapter begin simple — how to add an element, set a tagged value, or traverse a package tree. They then build toward more practical utilities: bulk renaming, enforcing conventions, exporting tagged values. Each example is fully commented so you see not only the syntax but also the reasoning.</p>
<p>As you practice, you will find that most tasks follow similar patterns:</p>
<ul>
<li><p>Find a package.</p></li>
<li><p>Loop through elements.</p></li>
<li><p>Check a property.</p></li>
<li><p>Modify or log as needed.</p></li>
<li><p>Call Update().</p></li>
<li><p>Refresh the view.</p></li>
</ul>
<p>This pattern is so common it becomes second nature. Once you see it a few times, you can adapt it to almost anything.</p>
</section>
<section id="preparing-for-the-examples" class="level2">
<h2 class="anchored" data-anchor-id="preparing-for-the-examples">Preparing for the Examples</h2>
<p>The worked examples that follow this introduction will show how to:</p>
<ul>
<li><p>Create elements inside a package.</p></li>
<li><p>Set stereotypes and tagged values.</p></li>
<li><p>Traverse package hierarchies.</p></li>
<li><p>Safely update and refresh content.</p></li>
</ul>
<p>Remember as you study them:</p>
<ol type="1">
<li><p>JScript is old, but it works.</p></li>
<li><p>Stick to ES3 constructs (var, for, function).</p></li>
<li><p>Treat EA collections as COM objects, not arrays.</p></li>
<li><p>Use Session.Output for small logs, CSV files for large ones.</p></li>
<li><p>Always keep DRY_RUN = true until you are certain.</p></li>
</ol>
<p>Mastering these basics will make you comfortable in EA’s scripting environment, ready to explore external automation and add-ins later.</p>
<hr>
<section id="safe-variable-declarations" class="level3">
<h3 class="anchored" data-anchor-id="safe-variable-declarations">Safe Variable Declarations</h3>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 5.1 – Safe variable declarations in JScript</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" data-filename="Example 5.1 – Safe variable declarations in JScript"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">// Example 5.1 - Safe variable declarations in JScript</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">// ❌ Wrong (not supported in JScript)</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">// let x = 10;</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">// const y = 20;</span></span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">// ✅ Correct</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="kw">var</span> x <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="kw">var</span> y <span class="op">=</span> <span class="dv">20</span><span class="op">;</span></span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">// Variables declared inside blocks are still visible outside</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="cf">if</span> (<span class="kw">true</span>) {</span>
<span id="cb2-15"><a href="#cb2-15"></a>    <span class="kw">var</span> z <span class="op">=</span> <span class="dv">30</span><span class="op">;</span>   <span class="co">// visible outside the if block</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>}</span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a>Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"x="</span> <span class="op">+</span> x <span class="op">+</span> <span class="st">", y="</span> <span class="op">+</span> y <span class="op">+</span> <span class="st">", z="</span> <span class="op">+</span> z)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="utility-functions" class="level3">
<h3 class="anchored" data-anchor-id="utility-functions">Utility Functions</h3>
<p>Since JScript lacks many string and array helpers, you should include utility functions in most scripts.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 5.2 – Common utility functions for JScript</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" data-filename="Example 5.2 – Common utility functions for JScript"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">// Example 5.2 - Common utility functions for JScript</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">// Trim whitespace</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="kw">function</span> <span class="fu">trim</span>(str) {</span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="cf">if</span> (str <span class="op">==</span> <span class="kw">null</span> <span class="op">||</span> str <span class="op">==</span> <span class="kw">undefined</span>) <span class="cf">return</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="cf">return</span> <span class="bu">String</span>(str)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">^\s+|\s+$</span><span class="ss">/g</span><span class="op">,</span> <span class="st">""</span>)<span class="op">;</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>}</span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">// Case-insensitive string comparison</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="kw">function</span> <span class="fu">safeCompare</span>(str1<span class="op">,</span> str2) {</span>
<span id="cb3-13"><a href="#cb3-13"></a>    <span class="cf">return</span> <span class="bu">String</span>(str1 <span class="op">||</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">toLowerCase</span>() <span class="op">===</span> <span class="bu">String</span>(str2 <span class="op">||</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">;</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>}</span>
<span id="cb3-15"><a href="#cb3-15"></a></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">// Check if string starts with a prefix</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="kw">function</span> <span class="fu">startsWith</span>(str<span class="op">,</span> prefix) {</span>
<span id="cb3-18"><a href="#cb3-18"></a>    <span class="cf">return</span> <span class="bu">String</span>(str <span class="op">||</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">indexOf</span>(prefix) <span class="op">===</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-19"><a href="#cb3-19"></a>}</span>
<span id="cb3-20"><a href="#cb3-20"></a></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">// Check if string contains substring</span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="kw">function</span> <span class="fu">contains</span>(str<span class="op">,</span> substring) {</span>
<span id="cb3-23"><a href="#cb3-23"></a>    <span class="cf">return</span> <span class="bu">String</span>(str <span class="op">||</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">indexOf</span>(substring) <span class="op">!==</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>}</span>
<span id="cb3-25"><a href="#cb3-25"></a></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="co">// Demonstration</span></span>
<span id="cb3-27"><a href="#cb3-27"></a>Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Trimmed: '"</span> <span class="op">+</span> <span class="fu">trim</span>(<span class="st">"   hello  "</span>) <span class="op">+</span> <span class="st">"'"</span>)<span class="op">;</span></span>
<span id="cb3-28"><a href="#cb3-28"></a>Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Compare: "</span> <span class="op">+</span> <span class="fu">safeCompare</span>(<span class="st">"Test"</span><span class="op">,</span><span class="st">"test"</span>))<span class="op">;</span></span>
<span id="cb3-29"><a href="#cb3-29"></a>Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"StartsWith: "</span> <span class="op">+</span> <span class="fu">startsWith</span>(<span class="st">"Enterprise Architect"</span><span class="op">,</span><span class="st">"Enter"</span>))<span class="op">;</span></span>
<span id="cb3-30"><a href="#cb3-30"></a>Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Contains: "</span> <span class="op">+</span> <span class="fu">contains</span>(<span class="st">"Enterprise Architect"</span><span class="op">,</span><span class="st">"Architect"</span>))<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="iterating-ea-collections" class="level3">
<h3 class="anchored" data-anchor-id="iterating-ea-collections">Iterating EA Collections</h3>
<p>EA collections are <strong>not</strong> JavaScript arrays.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 5.3 – Iterating through EA collections</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" data-filename="Example 5.3 – Iterating through EA collections"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">// Example 5.3 - Iterating through EA collections</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="kw">var</span> <span class="im">package</span> <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>    <span class="cf">if</span> (<span class="op">!</span><span class="im">package</span>) {</span>
<span id="cb4-10"><a href="#cb4-10"></a>        Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Please select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>    }</span>
<span id="cb4-13"><a href="#cb4-13"></a></span>
<span id="cb4-14"><a href="#cb4-14"></a>    <span class="kw">var</span> elements <span class="op">=</span> <span class="im">package</span><span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb4-15"><a href="#cb4-15"></a></span>
<span id="cb4-16"><a href="#cb4-16"></a>    <span class="co">// ❌ Wrong – this will fail</span></span>
<span id="cb4-17"><a href="#cb4-17"></a>    <span class="co">// elements.forEach(function(e) { ... });</span></span>
<span id="cb4-18"><a href="#cb4-18"></a></span>
<span id="cb4-19"><a href="#cb4-19"></a>    <span class="co">// ✅ Correct – use Count and GetAt()</span></span>
<span id="cb4-20"><a href="#cb4-20"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> elements<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb4-21"><a href="#cb4-21"></a>        <span class="kw">var</span> element <span class="op">=</span> elements<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb4-22"><a href="#cb4-22"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Element: "</span> <span class="op">+</span> element<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb4-23"><a href="#cb4-23"></a>    }</span>
<span id="cb4-24"><a href="#cb4-24"></a>}</span>
<span id="cb4-25"><a href="#cb4-25"></a></span>
<span id="cb4-26"><a href="#cb4-26"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="file-io-with-activex" class="level3">
<h3 class="anchored" data-anchor-id="file-io-with-activex">File I/O with ActiveX</h3>
<p>If you need to read or write files, use the Windows FileSystemObject.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 5.4 – Reading a text file in JScript</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" data-filename="Example 5.4 – Reading a text file in JScript"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">// Example 5.4 - Reading a text file in JScript</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="kw">function</span> <span class="fu">readFile</span>(filePath) {</span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="kw">var</span> fso <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Scripting.FileSystemObject"</span>)<span class="op">;</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>    <span class="kw">var</span> file <span class="op">=</span> fso<span class="op">.</span><span class="fu">OpenTextFile</span>(filePath<span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span>  <span class="co">// 1 = ForReading</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>    <span class="kw">var</span> content <span class="op">=</span> file<span class="op">.</span><span class="fu">ReadAll</span>()<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>    file<span class="op">.</span><span class="fu">Close</span>()<span class="op">;</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>    <span class="cf">return</span> content<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>}</span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb5-14"><a href="#cb5-14"></a>    <span class="cf">try</span> {</span>
<span id="cb5-15"><a href="#cb5-15"></a>        <span class="kw">var</span> text <span class="op">=</span> <span class="fu">readFile</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">temp</span><span class="sc">\\</span><span class="st">example.txt"</span>)<span class="op">;</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"File contents: "</span> <span class="op">+</span> text)<span class="op">;</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>    } <span class="cf">catch</span>(e) {</span>
<span id="cb5-18"><a href="#cb5-18"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Error: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb5-19"><a href="#cb5-19"></a>    }</span>
<span id="cb5-20"><a href="#cb5-20"></a>}</span>
<span id="cb5-21"><a href="#cb5-21"></a></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="debugging-with-session.output" class="level3">
<h3 class="anchored" data-anchor-id="debugging-with-session.output">Debugging with Session.Output</h3>
<p>Unlike modern environments, you don’t have a console. Use Session.Output() to print values and track progress.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 5.5 – Debugging with Session.Output</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" data-filename="Example 5.5 – Debugging with Session.Output"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">// Example 5.5 - Debugging with Session.Output</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb6-6"><a href="#cb6-6"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Debugging start..."</span>)<span class="op">;</span></span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a>    <span class="kw">var</span> <span class="im">package</span> <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="cf">if</span> (<span class="op">!</span><span class="im">package</span>) {</span>
<span id="cb6-10"><a href="#cb6-10"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"No package selected."</span>)<span class="op">;</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>    }</span>
<span id="cb6-13"><a href="#cb6-13"></a></span>
<span id="cb6-14"><a href="#cb6-14"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Selected package: "</span> <span class="op">+</span> <span class="im">package</span><span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb6-15"><a href="#cb6-15"></a></span>
<span id="cb6-16"><a href="#cb6-16"></a>    <span class="kw">var</span> elements <span class="op">=</span> <span class="im">package</span><span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb6-17"><a href="#cb6-17"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Element count: "</span> <span class="op">+</span> elements<span class="op">.</span><span class="at">Count</span>)<span class="op">;</span></span>
<span id="cb6-18"><a href="#cb6-18"></a></span>
<span id="cb6-19"><a href="#cb6-19"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> elements<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb6-20"><a href="#cb6-20"></a>        <span class="kw">var</span> element <span class="op">=</span> elements<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb6-21"><a href="#cb6-21"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Element["</span> <span class="op">+</span> i <span class="op">+</span> <span class="st">"]: "</span> <span class="op">+</span> element<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb6-22"><a href="#cb6-22"></a>    }</span>
<span id="cb6-23"><a href="#cb6-23"></a></span>
<span id="cb6-24"><a href="#cb6-24"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Debugging finished."</span>)<span class="op">;</span></span>
<span id="cb6-25"><a href="#cb6-25"></a>}</span>
<span id="cb6-26"><a href="#cb6-26"></a></span>
<span id="cb6-27"><a href="#cb6-27"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="error-handling" class="level3">
<h3 class="anchored" data-anchor-id="error-handling">Error Handling</h3>
<p>JScript supports try–catch, but exceptions are limited.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 5.6 – Error handling in JScript</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" data-filename="Example 5.6 – Error handling in JScript"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">// Example 5.6 - Error handling in JScript</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb7-6"><a href="#cb7-6"></a>    <span class="cf">try</span> {</span>
<span id="cb7-7"><a href="#cb7-7"></a>        <span class="kw">var</span> result <span class="op">=</span> <span class="dv">10</span> <span class="op">/</span> <span class="dv">0</span><span class="op">;</span>  <span class="co">// Still valid, result = Infinity</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Result: "</span> <span class="op">+</span> result)<span class="op">;</span></span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a>        <span class="co">// Force an error by calling undefined function</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>        <span class="fu">undefinedFunction</span>()<span class="op">;</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>    } <span class="cf">catch</span> (e) {</span>
<span id="cb7-13"><a href="#cb7-13"></a>        <span class="co">// e.message is usually the only useful property</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Caught error: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>    }</span>
<span id="cb7-16"><a href="#cb7-16"></a>}</span>
<span id="cb7-17"><a href="#cb7-17"></a></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="putting-it-all-together" class="level3">
<h3 class="anchored" data-anchor-id="putting-it-all-together">Putting It All Together</h3>
<p>By combining these patterns, you can write safe, predictable scripts inside EA:</p>
<ol type="1">
<li><p>Always use var for variables.</p></li>
<li><p>Include helper functions for missing features.</p></li>
<li><p>Loop over collections with .Count and .GetAt(i).</p></li>
<li><p>Use Update() to persist changes and RefreshModelView() to update the UI.</p></li>
<li><p>Use Session.Output() for debugging.</p></li>
<li><p>Use try–catch, but don’t expect detailed stack traces.</p></li>
</ol>
</section>
</section>
<section id="looking-ahead" class="level2">
<h2 class="anchored" data-anchor-id="looking-ahead">Looking Ahead</h2>
<p>This chapter has focused on the quirks of JScript inside EA. With this knowledge, you can write safe, basic scripts without falling into the traps of modern JavaScript expectations. In the next chapter we move to <strong>external automation</strong>, where Python, C#, and other modern languages open up much more powerful possibilities for integration and data processing.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script>

document.addEventListener('DOMContentLoaded', function () {

  // Prefer the margin sidebar if it exists; otherwise try the TOC sidebar.

  const margin = document.querySelector('#quarto-margin-sidebar, .margin-sidebar, .column-margin');

  const toc    = document.querySelector('nav#TOC');

  const sidebar = margin || (toc && toc.closest('.sidebar, .quarto-sidebar, .margin-sidebar'));



  if (!sidebar) return; // no margin column on this layout



  const holder = document.createElement('div');

  holder.className = 'cover-above-toc';

  holder.innerHTML = `

    <a href="index.html">

      <img src="images/cover.png" alt="Book cover" class="cover-above-toc__img" width="140" />

    </a>

  `;

  sidebar.prepend(holder);

});

</script>



<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./05-System.Object[].html" class="pagination-link" aria-label="Chapter 4: API Essentials">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Chapter 4: API Essentials</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./07-System.Object[].html" class="pagination-link" aria-label="Chapter 6: External Automation">
        <span class="nav-page-text"><span class="chapter-title">Chapter 6: External Automation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu"># Chapter 5: Inside EA with JScript</span></span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a>The previous chapters have explained why you would script Enterprise</span>
<span id="cb8-4"><a href="#cb8-4"></a>Architect (EA), how automation fits into the overall landscape, and</span>
<span id="cb8-5"><a href="#cb8-5"></a>which core objects form the backbone of the API. Now it is time to get</span>
<span id="cb8-6"><a href="#cb8-6"></a>specific about the scripting language you will actually use inside EA.</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a>EA provides three options in its built-in scripting window:</span>
<span id="cb8-9"><a href="#cb8-9"></a>**VBScript**, **JScript**, and in newer versions, **JavaScript**. Each</span>
<span id="cb8-10"><a href="#cb8-10"></a>of these has its own history, syntax, and quirks. For most users today,</span>
<span id="cb8-11"><a href="#cb8-11"></a>the best balance of accessibility, capability, and long-term viability</span>
<span id="cb8-12"><a href="#cb8-12"></a>is found in **JavaScript** — or more accurately, in Microsoft’s JScript</span>
<span id="cb8-13"><a href="#cb8-13"></a>engine, which is EA’s internal implementation of ECMAScript 3.</span>
<span id="cb8-14"><a href="#cb8-14"></a></span>
<span id="cb8-15"><a href="#cb8-15"></a>This chapter explores what it means to work inside EA with</span>
<span id="cb8-16"><a href="#cb8-16"></a>JavaScript/JScript. It explains the constraints of the runtime, the</span>
<span id="cb8-17"><a href="#cb8-17"></a>pitfalls of assuming modern ECMAScript features, and the techniques that</span>
<span id="cb8-18"><a href="#cb8-18"></a>make the language usable for practical automation. It also sets</span>
<span id="cb8-19"><a href="#cb8-19"></a>expectations: you will not be writing modern Node.js code, but you can</span>
<span id="cb8-20"><a href="#cb8-20"></a>still achieve powerful results with a lean, disciplined subset of</span>
<span id="cb8-21"><a href="#cb8-21"></a>JavaScript.</span>
<span id="cb8-22"><a href="#cb8-22"></a></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="fu">## The Language Landscape</span></span>
<span id="cb8-24"><a href="#cb8-24"></a></span>
<span id="cb8-25"><a href="#cb8-25"></a>Why does EA support these languages? The answer lies in its history. In</span>
<span id="cb8-26"><a href="#cb8-26"></a>the early 2000s, Windows scripting was dominated by **VBScript** and</span>
<span id="cb8-27"><a href="#cb8-27"></a>**JScript**, both hosted by the Windows Script Host. They were the</span>
<span id="cb8-28"><a href="#cb8-28"></a>default scripting choices for automation in Microsoft Office and many</span>
<span id="cb8-29"><a href="#cb8-29"></a>other applications. EA adopted them as its embedded scripting languages.</span>
<span id="cb8-30"><a href="#cb8-30"></a></span>
<span id="cb8-31"><a href="#cb8-31"></a>VBScript is verbose, procedural, and feels like a cousin of Visual Basic</span>
<span id="cb8-32"><a href="#cb8-32"></a>for Applications (VBA). JScript is Microsoft’s implementation of</span>
<span id="cb8-33"><a href="#cb8-33"></a>ECMAScript 3 (ES3), roughly equivalent to JavaScript as it existed in</span>
<span id="cb8-34"><a href="#cb8-34"></a>Internet Explorer 6.</span>
<span id="cb8-35"><a href="#cb8-35"></a></span>
<span id="cb8-36"><a href="#cb8-36"></a>More recently, Sparx Systems added support for JavaScript labelled as</span>
<span id="cb8-37"><a href="#cb8-37"></a>such, but under the hood it is still the JScript ES3 runtime. That means</span>
<span id="cb8-38"><a href="#cb8-38"></a>many of the features you may expect from modern JavaScript — let, const,</span>
<span id="cb8-39"><a href="#cb8-39"></a>arrow functions, array methods like forEach, JSON parsing — are missing.</span>
<span id="cb8-40"><a href="#cb8-40"></a>If you try to use them, your script will fail.</span>
<span id="cb8-41"><a href="#cb8-41"></a></span>
<span id="cb8-42"><a href="#cb8-42"></a><span class="fu">## JavaScript or JScript?</span></span>
<span id="cb8-43"><a href="#cb8-43"></a></span>
<span id="cb8-44"><a href="#cb8-44"></a>Given these limitations, why choose JavaScript over VBScript? There are</span>
<span id="cb8-45"><a href="#cb8-45"></a>several reasons:</span>
<span id="cb8-46"><a href="#cb8-46"></a></span>
<span id="cb8-47"><a href="#cb8-47"></a><span class="ss">- </span>**Familiarity**: even with its older syntax, JavaScript feels more</span>
<span id="cb8-48"><a href="#cb8-48"></a>  familiar to today’s developers and architects than VBScript.</span>
<span id="cb8-49"><a href="#cb8-49"></a></span>
<span id="cb8-50"><a href="#cb8-50"></a><span class="ss">- </span>**Readability**: JScript code tends to be shorter and cleaner than</span>
<span id="cb8-51"><a href="#cb8-51"></a>  equivalent VBScript.</span>
<span id="cb8-52"><a href="#cb8-52"></a></span>
<span id="cb8-53"><a href="#cb8-53"></a><span class="ss">- </span>**Longevity**: while VBScript has been officially deprecated by</span>
<span id="cb8-54"><a href="#cb8-54"></a>  Microsoft, JavaScript remains the world’s most widely used language.</span>
<span id="cb8-55"><a href="#cb8-55"></a>  Even if EA lags in its runtime, the language concepts remain</span>
<span id="cb8-56"><a href="#cb8-56"></a>  transferable.</span>
<span id="cb8-57"><a href="#cb8-57"></a></span>
<span id="cb8-58"><a href="#cb8-58"></a><span class="ss">- </span>**Transition potential**: once you know how to script EA in JScript,</span>
<span id="cb8-59"><a href="#cb8-59"></a>  moving to external JavaScript (Node.js, modern ES) or Python is</span>
<span id="cb8-60"><a href="#cb8-60"></a>  easier.</span>
<span id="cb8-61"><a href="#cb8-61"></a></span>
<span id="cb8-62"><a href="#cb8-62"></a>For these reasons, this book assumes you will primarily use</span>
<span id="cb8-63"><a href="#cb8-63"></a>**JScript/JavaScript** as your internal scripting language. VBScript</span>
<span id="cb8-64"><a href="#cb8-64"></a>examples are included occasionally for reference, but JScript is the</span>
<span id="cb8-65"><a href="#cb8-65"></a>pragmatic choice going forward.</span>
<span id="cb8-66"><a href="#cb8-66"></a></span>
<span id="cb8-67"><a href="#cb8-67"></a><span class="fu">## The Constraints of JScript ES3</span></span>
<span id="cb8-68"><a href="#cb8-68"></a></span>
<span id="cb8-69"><a href="#cb8-69"></a>The most important thing to understand is what you **cannot do** in EA’s</span>
<span id="cb8-70"><a href="#cb8-70"></a>JScript engine. Here are the key constraints:</span>
<span id="cb8-71"><a href="#cb8-71"></a></span>
<span id="cb8-72"><a href="#cb8-72"></a><span class="ss">- </span>**No modern declarations**: only var is allowed; let and const are not</span>
<span id="cb8-73"><a href="#cb8-73"></a>  recognised.</span>
<span id="cb8-74"><a href="#cb8-74"></a></span>
<span id="cb8-75"><a href="#cb8-75"></a><span class="ss">- </span>**No arrow functions**: ()=<span class="sc">\&gt;</span> syntax is invalid. Use function()</span>
<span id="cb8-76"><a href="#cb8-76"></a>  instead.</span>
<span id="cb8-77"><a href="#cb8-77"></a></span>
<span id="cb8-78"><a href="#cb8-78"></a><span class="ss">- </span>**No array helpers**: methods like forEach, map, filter, reduce do not</span>
<span id="cb8-79"><a href="#cb8-79"></a>  exist.</span>
<span id="cb8-80"><a href="#cb8-80"></a></span>
<span id="cb8-81"><a href="#cb8-81"></a><span class="ss">- </span>**No JSON methods**: JSON.parse and JSON.stringify are not available.</span>
<span id="cb8-82"><a href="#cb8-82"></a>  If you need JSON, you must parse manually or use external automation.</span>
<span id="cb8-83"><a href="#cb8-83"></a></span>
<span id="cb8-84"><a href="#cb8-84"></a><span class="ss">- </span>**No promises or async/await**: everything is synchronous.</span>
<span id="cb8-85"><a href="#cb8-85"></a></span>
<span id="cb8-86"><a href="#cb8-86"></a><span class="ss">- </span>**String handling**: only basic functions like indexOf, substring,</span>
<span id="cb8-87"><a href="#cb8-87"></a>  replace are available.</span>
<span id="cb8-88"><a href="#cb8-88"></a></span>
<span id="cb8-89"><a href="#cb8-89"></a>This feels restrictive, especially if you come from modern JavaScript.</span>
<span id="cb8-90"><a href="#cb8-90"></a>But it is enough for the kinds of tasks EA scripting requires:</span>
<span id="cb8-91"><a href="#cb8-91"></a>traversing collections, setting properties, logging, and basic string</span>
<span id="cb8-92"><a href="#cb8-92"></a>manipulation.</span>
<span id="cb8-93"><a href="#cb8-93"></a></span>
<span id="cb8-94"><a href="#cb8-94"></a><span class="fu">## Scripting Tips</span></span>
<span id="cb8-95"><a href="#cb8-95"></a></span>
<span id="cb8-96"><a href="#cb8-96"></a><span class="fu">### Adapting to EA Collections</span></span>
<span id="cb8-97"><a href="#cb8-97"></a></span>
<span id="cb8-98"><a href="#cb8-98"></a>One of the most common mistakes beginners make is assuming EA’s</span>
<span id="cb8-99"><a href="#cb8-99"></a>collections behave like JavaScript arrays. They do not. EA’s collections</span>
<span id="cb8-100"><a href="#cb8-100"></a>are COM objects. They expose only two members: .Count and .GetAt(index).</span>
<span id="cb8-101"><a href="#cb8-101"></a></span>
<span id="cb8-102"><a href="#cb8-102"></a>That means you must loop with a standard for loop:</span>
<span id="cb8-103"><a href="#cb8-103"></a></span>
<span id="cb8-104"><a href="#cb8-104"></a><span class="in">``` js </span></span>
<span id="cb8-105"><a href="#cb8-105"></a><span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb8-106"><a href="#cb8-106"></a><span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb8-107"><a href="#cb8-107"></a>    <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb8-108"><a href="#cb8-108"></a>    Session<span class="op">.</span><span class="fu">Output</span>(e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb8-109"><a href="#cb8-109"></a>}</span>
<span id="cb8-110"><a href="#cb8-110"></a><span class="in">```</span></span>
<span id="cb8-111"><a href="#cb8-111"></a></span>
<span id="cb8-112"><a href="#cb8-112"></a>Try to call els.forEach(...) and you will get an error. Understanding</span>
<span id="cb8-113"><a href="#cb8-113"></a>this quirk is half the battle of learning EA scripting.</span>
<span id="cb8-114"><a href="#cb8-114"></a></span>
<span id="cb8-115"><a href="#cb8-115"></a><span class="fu">### Logging with Session.Output</span></span>
<span id="cb8-116"><a href="#cb8-116"></a></span>
<span id="cb8-117"><a href="#cb8-117"></a>Another adaptation is how you print feedback. There is no console.log.</span>
<span id="cb8-118"><a href="#cb8-118"></a>Instead, EA provides Session.Output, which writes to the Output tab. For</span>
<span id="cb8-119"><a href="#cb8-119"></a>example:</span>
<span id="cb8-120"><a href="#cb8-120"></a></span>
<span id="cb8-121"><a href="#cb8-121"></a>Session.Output("Hello from EA!");</span>
<span id="cb8-122"><a href="#cb8-122"></a></span>
<span id="cb8-123"><a href="#cb8-123"></a>For large operations, use file logging instead (via FileSystemObject),</span>
<span id="cb8-124"><a href="#cb8-124"></a>because thousands of lines in the Output tab will slow EA down.</span>
<span id="cb8-125"><a href="#cb8-125"></a></span>
<span id="cb8-126"><a href="#cb8-126"></a><span class="fu">### Dry-Run and Logging Discipline</span></span>
<span id="cb8-127"><a href="#cb8-127"></a></span>
<span id="cb8-128"><a href="#cb8-128"></a>The limitations of the language make **discipline even more important**.</span>
<span id="cb8-129"><a href="#cb8-129"></a>That is why this book insists on starting every modifying script with a</span>
<span id="cb8-130"><a href="#cb8-130"></a>DRY_RUN flag and embedding structured logging. Because there is no undo,</span>
<span id="cb8-131"><a href="#cb8-131"></a>and because the debugging tools are limited, you must build safety into</span>
<span id="cb8-132"><a href="#cb8-132"></a>your scripts from the start.</span>
<span id="cb8-133"><a href="#cb8-133"></a></span>
<span id="cb8-134"><a href="#cb8-134"></a><span class="fu">### The Benefits of Simplicity</span></span>
<span id="cb8-135"><a href="#cb8-135"></a></span>
<span id="cb8-136"><a href="#cb8-136"></a>There is a positive side to JScript’s limitations: it forces you to keep</span>
<span id="cb8-137"><a href="#cb8-137"></a>scripts **simple and focused**. Each script should do one thing well —</span>
<span id="cb8-138"><a href="#cb8-138"></a>rename elements, export to CSV, check for missing tags. You won’t be</span>
<span id="cb8-139"><a href="#cb8-139"></a>tempted to over-engineer or add unnecessary abstractions.</span>
<span id="cb8-140"><a href="#cb8-140"></a></span>
<span id="cb8-141"><a href="#cb8-141"></a>For larger tasks, the advice is clear: use external automation in Python</span>
<span id="cb8-142"><a href="#cb8-142"></a>or C#. Internal JScript is for sharp, focused tools that run close to</span>
<span id="cb8-143"><a href="#cb8-143"></a>the model.</span>
<span id="cb8-144"><a href="#cb8-144"></a></span>
<span id="cb8-145"><a href="#cb8-145"></a><span class="fu">### Thinking Like a Modeller</span></span>
<span id="cb8-146"><a href="#cb8-146"></a></span>
<span id="cb8-147"><a href="#cb8-147"></a>It is worth remembering that most EA users are not professional</span>
<span id="cb8-148"><a href="#cb8-148"></a>programmers. They are architects, analysts, engineers — people who need</span>
<span id="cb8-149"><a href="#cb8-149"></a>automation to support modelling, not to build software products. JScript</span>
<span id="cb8-150"><a href="#cb8-150"></a>inside EA is perfectly suited to this audience. It lets you express</span>
<span id="cb8-151"><a href="#cb8-151"></a>simple logic in a few lines. It integrates directly with the repository.</span>
<span id="cb8-152"><a href="#cb8-152"></a>It is always available without external setup.</span>
<span id="cb8-153"><a href="#cb8-153"></a></span>
<span id="cb8-154"><a href="#cb8-154"></a>This chapter is therefore less about writing elegant JavaScript and more</span>
<span id="cb8-155"><a href="#cb8-155"></a>about **thinking like a modeller who scripts**. The aim is clarity,</span>
<span id="cb8-156"><a href="#cb8-156"></a>safety, and repeatability.</span>
<span id="cb8-157"><a href="#cb8-157"></a></span>
<span id="cb8-158"><a href="#cb8-158"></a><span class="fu">## A Progressive Learning Curve</span></span>
<span id="cb8-159"><a href="#cb8-159"></a></span>
<span id="cb8-160"><a href="#cb8-160"></a>The examples in this chapter begin simple — how to add an element, set a</span>
<span id="cb8-161"><a href="#cb8-161"></a>tagged value, or traverse a package tree. They then build toward more</span>
<span id="cb8-162"><a href="#cb8-162"></a>practical utilities: bulk renaming, enforcing conventions, exporting</span>
<span id="cb8-163"><a href="#cb8-163"></a>tagged values. Each example is fully commented so you see not only the</span>
<span id="cb8-164"><a href="#cb8-164"></a>syntax but also the reasoning.</span>
<span id="cb8-165"><a href="#cb8-165"></a></span>
<span id="cb8-166"><a href="#cb8-166"></a>As you practice, you will find that most tasks follow similar patterns:</span>
<span id="cb8-167"><a href="#cb8-167"></a></span>
<span id="cb8-168"><a href="#cb8-168"></a><span class="ss">- </span>Find a package.</span>
<span id="cb8-169"><a href="#cb8-169"></a></span>
<span id="cb8-170"><a href="#cb8-170"></a><span class="ss">- </span>Loop through elements.</span>
<span id="cb8-171"><a href="#cb8-171"></a></span>
<span id="cb8-172"><a href="#cb8-172"></a><span class="ss">- </span>Check a property.</span>
<span id="cb8-173"><a href="#cb8-173"></a></span>
<span id="cb8-174"><a href="#cb8-174"></a><span class="ss">- </span>Modify or log as needed.</span>
<span id="cb8-175"><a href="#cb8-175"></a></span>
<span id="cb8-176"><a href="#cb8-176"></a><span class="ss">- </span>Call Update().</span>
<span id="cb8-177"><a href="#cb8-177"></a></span>
<span id="cb8-178"><a href="#cb8-178"></a><span class="ss">- </span>Refresh the view.</span>
<span id="cb8-179"><a href="#cb8-179"></a></span>
<span id="cb8-180"><a href="#cb8-180"></a>This pattern is so common it becomes second nature. Once you see it a</span>
<span id="cb8-181"><a href="#cb8-181"></a>few times, you can adapt it to almost anything.</span>
<span id="cb8-182"><a href="#cb8-182"></a></span>
<span id="cb8-183"><a href="#cb8-183"></a><span class="fu">## Preparing for the Examples</span></span>
<span id="cb8-184"><a href="#cb8-184"></a></span>
<span id="cb8-185"><a href="#cb8-185"></a>The worked examples that follow this introduction will show how to:</span>
<span id="cb8-186"><a href="#cb8-186"></a></span>
<span id="cb8-187"><a href="#cb8-187"></a><span class="ss">- </span>Create elements inside a package.</span>
<span id="cb8-188"><a href="#cb8-188"></a></span>
<span id="cb8-189"><a href="#cb8-189"></a><span class="ss">- </span>Set stereotypes and tagged values.</span>
<span id="cb8-190"><a href="#cb8-190"></a></span>
<span id="cb8-191"><a href="#cb8-191"></a><span class="ss">- </span>Traverse package hierarchies.</span>
<span id="cb8-192"><a href="#cb8-192"></a></span>
<span id="cb8-193"><a href="#cb8-193"></a><span class="ss">- </span>Safely update and refresh content.</span>
<span id="cb8-194"><a href="#cb8-194"></a></span>
<span id="cb8-195"><a href="#cb8-195"></a>Remember as you study them:</span>
<span id="cb8-196"><a href="#cb8-196"></a></span>
<span id="cb8-197"><a href="#cb8-197"></a><span class="ss">1.  </span>JScript is old, but it works.</span>
<span id="cb8-198"><a href="#cb8-198"></a></span>
<span id="cb8-199"><a href="#cb8-199"></a><span class="ss">2.  </span>Stick to ES3 constructs (var, for, function).</span>
<span id="cb8-200"><a href="#cb8-200"></a></span>
<span id="cb8-201"><a href="#cb8-201"></a><span class="ss">3.  </span>Treat EA collections as COM objects, not arrays.</span>
<span id="cb8-202"><a href="#cb8-202"></a></span>
<span id="cb8-203"><a href="#cb8-203"></a><span class="ss">4.  </span>Use Session.Output for small logs, CSV files for large ones.</span>
<span id="cb8-204"><a href="#cb8-204"></a></span>
<span id="cb8-205"><a href="#cb8-205"></a><span class="ss">5.  </span>Always keep DRY_RUN = true until you are certain.</span>
<span id="cb8-206"><a href="#cb8-206"></a></span>
<span id="cb8-207"><a href="#cb8-207"></a>Mastering these basics will make you comfortable in EA’s scripting</span>
<span id="cb8-208"><a href="#cb8-208"></a>environment, ready to explore external automation and add-ins later.</span>
<span id="cb8-209"><a href="#cb8-209"></a></span>
<span id="cb8-210"><a href="#cb8-210"></a>**  **</span>
<span id="cb8-211"><a href="#cb8-211"></a></span>
<span id="cb8-212"><a href="#cb8-212"></a><span class="fu">### Safe Variable Declarations</span></span>
<span id="cb8-213"><a href="#cb8-213"></a><span class="in">```{.js filename="Example 5.1 – Safe variable declarations in JScript"}</span></span>
<span id="cb8-214"><a href="#cb8-214"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-215"><a href="#cb8-215"></a><span class="co">// Example 5.1 - Safe variable declarations in JScript</span></span>
<span id="cb8-216"><a href="#cb8-216"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-217"><a href="#cb8-217"></a></span>
<span id="cb8-218"><a href="#cb8-218"></a><span class="co">// ❌ Wrong (not supported in JScript)</span></span>
<span id="cb8-219"><a href="#cb8-219"></a><span class="co">// let x = 10;</span></span>
<span id="cb8-220"><a href="#cb8-220"></a><span class="co">// const y = 20;</span></span>
<span id="cb8-221"><a href="#cb8-221"></a></span>
<span id="cb8-222"><a href="#cb8-222"></a><span class="co">// ✅ Correct</span></span>
<span id="cb8-223"><a href="#cb8-223"></a><span class="kw">var</span> x <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb8-224"><a href="#cb8-224"></a><span class="kw">var</span> y <span class="op">=</span> <span class="dv">20</span><span class="op">;</span></span>
<span id="cb8-225"><a href="#cb8-225"></a></span>
<span id="cb8-226"><a href="#cb8-226"></a><span class="co">// Variables declared inside blocks are still visible outside</span></span>
<span id="cb8-227"><a href="#cb8-227"></a><span class="cf">if</span> (<span class="kw">true</span>) {</span>
<span id="cb8-228"><a href="#cb8-228"></a>    <span class="kw">var</span> z <span class="op">=</span> <span class="dv">30</span><span class="op">;</span>   <span class="co">// visible outside the if block</span></span>
<span id="cb8-229"><a href="#cb8-229"></a>}</span>
<span id="cb8-230"><a href="#cb8-230"></a></span>
<span id="cb8-231"><a href="#cb8-231"></a>Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"x="</span> <span class="op">+</span> x <span class="op">+</span> <span class="st">", y="</span> <span class="op">+</span> y <span class="op">+</span> <span class="st">", z="</span> <span class="op">+</span> z)<span class="op">;</span></span>
<span id="cb8-232"><a href="#cb8-232"></a><span class="in">```</span></span>
<span id="cb8-233"><a href="#cb8-233"></a></span>
<span id="cb8-234"><a href="#cb8-234"></a><span class="fu">### Utility Functions</span></span>
<span id="cb8-235"><a href="#cb8-235"></a></span>
<span id="cb8-236"><a href="#cb8-236"></a>Since JScript lacks many string and array helpers, you should include</span>
<span id="cb8-237"><a href="#cb8-237"></a>utility functions in most scripts.</span>
<span id="cb8-238"><a href="#cb8-238"></a></span>
<span id="cb8-239"><a href="#cb8-239"></a><span class="in">```{.js filename="Example 5.2 – Common utility functions for JScript"}</span></span>
<span id="cb8-240"><a href="#cb8-240"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-241"><a href="#cb8-241"></a><span class="co">// Example 5.2 - Common utility functions for JScript</span></span>
<span id="cb8-242"><a href="#cb8-242"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-243"><a href="#cb8-243"></a></span>
<span id="cb8-244"><a href="#cb8-244"></a><span class="co">// Trim whitespace</span></span>
<span id="cb8-245"><a href="#cb8-245"></a><span class="kw">function</span> <span class="fu">trim</span>(str) {</span>
<span id="cb8-246"><a href="#cb8-246"></a>    <span class="cf">if</span> (str <span class="op">==</span> <span class="kw">null</span> <span class="op">||</span> str <span class="op">==</span> <span class="kw">undefined</span>) <span class="cf">return</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb8-247"><a href="#cb8-247"></a>    <span class="cf">return</span> <span class="bu">String</span>(str)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">^\s+|\s+$</span><span class="ss">/g</span><span class="op">,</span> <span class="st">""</span>)<span class="op">;</span></span>
<span id="cb8-248"><a href="#cb8-248"></a>}</span>
<span id="cb8-249"><a href="#cb8-249"></a></span>
<span id="cb8-250"><a href="#cb8-250"></a><span class="co">// Case-insensitive string comparison</span></span>
<span id="cb8-251"><a href="#cb8-251"></a><span class="kw">function</span> <span class="fu">safeCompare</span>(str1<span class="op">,</span> str2) {</span>
<span id="cb8-252"><a href="#cb8-252"></a>    <span class="cf">return</span> <span class="bu">String</span>(str1 <span class="op">||</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">toLowerCase</span>() <span class="op">===</span> <span class="bu">String</span>(str2 <span class="op">||</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">;</span></span>
<span id="cb8-253"><a href="#cb8-253"></a>}</span>
<span id="cb8-254"><a href="#cb8-254"></a></span>
<span id="cb8-255"><a href="#cb8-255"></a><span class="co">// Check if string starts with a prefix</span></span>
<span id="cb8-256"><a href="#cb8-256"></a><span class="kw">function</span> <span class="fu">startsWith</span>(str<span class="op">,</span> prefix) {</span>
<span id="cb8-257"><a href="#cb8-257"></a>    <span class="cf">return</span> <span class="bu">String</span>(str <span class="op">||</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">indexOf</span>(prefix) <span class="op">===</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb8-258"><a href="#cb8-258"></a>}</span>
<span id="cb8-259"><a href="#cb8-259"></a></span>
<span id="cb8-260"><a href="#cb8-260"></a><span class="co">// Check if string contains substring</span></span>
<span id="cb8-261"><a href="#cb8-261"></a><span class="kw">function</span> <span class="fu">contains</span>(str<span class="op">,</span> substring) {</span>
<span id="cb8-262"><a href="#cb8-262"></a>    <span class="cf">return</span> <span class="bu">String</span>(str <span class="op">||</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">indexOf</span>(substring) <span class="op">!==</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb8-263"><a href="#cb8-263"></a>}</span>
<span id="cb8-264"><a href="#cb8-264"></a></span>
<span id="cb8-265"><a href="#cb8-265"></a><span class="co">// Demonstration</span></span>
<span id="cb8-266"><a href="#cb8-266"></a>Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Trimmed: '"</span> <span class="op">+</span> <span class="fu">trim</span>(<span class="st">"   hello  "</span>) <span class="op">+</span> <span class="st">"'"</span>)<span class="op">;</span></span>
<span id="cb8-267"><a href="#cb8-267"></a>Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Compare: "</span> <span class="op">+</span> <span class="fu">safeCompare</span>(<span class="st">"Test"</span><span class="op">,</span><span class="st">"test"</span>))<span class="op">;</span></span>
<span id="cb8-268"><a href="#cb8-268"></a>Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"StartsWith: "</span> <span class="op">+</span> <span class="fu">startsWith</span>(<span class="st">"Enterprise Architect"</span><span class="op">,</span><span class="st">"Enter"</span>))<span class="op">;</span></span>
<span id="cb8-269"><a href="#cb8-269"></a>Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Contains: "</span> <span class="op">+</span> <span class="fu">contains</span>(<span class="st">"Enterprise Architect"</span><span class="op">,</span><span class="st">"Architect"</span>))<span class="op">;</span></span>
<span id="cb8-270"><a href="#cb8-270"></a><span class="in">```</span></span>
<span id="cb8-271"><a href="#cb8-271"></a><span class="fu">### Iterating EA Collections</span></span>
<span id="cb8-272"><a href="#cb8-272"></a>EA collections are **not** JavaScript arrays.</span>
<span id="cb8-273"><a href="#cb8-273"></a><span class="in">```{.js filename="Example 5.3 – Iterating through EA collections"}</span></span>
<span id="cb8-274"><a href="#cb8-274"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-275"><a href="#cb8-275"></a><span class="co">// Example 5.3 - Iterating through EA collections</span></span>
<span id="cb8-276"><a href="#cb8-276"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-277"><a href="#cb8-277"></a></span>
<span id="cb8-278"><a href="#cb8-278"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb8-279"><a href="#cb8-279"></a></span>
<span id="cb8-280"><a href="#cb8-280"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb8-281"><a href="#cb8-281"></a>    <span class="kw">var</span> <span class="im">package</span> <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb8-282"><a href="#cb8-282"></a>    <span class="cf">if</span> (<span class="op">!</span><span class="im">package</span>) {</span>
<span id="cb8-283"><a href="#cb8-283"></a>        Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Please select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span></span>
<span id="cb8-284"><a href="#cb8-284"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb8-285"><a href="#cb8-285"></a>    }</span>
<span id="cb8-286"><a href="#cb8-286"></a></span>
<span id="cb8-287"><a href="#cb8-287"></a>    <span class="kw">var</span> elements <span class="op">=</span> <span class="im">package</span><span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb8-288"><a href="#cb8-288"></a></span>
<span id="cb8-289"><a href="#cb8-289"></a>    <span class="co">// ❌ Wrong – this will fail</span></span>
<span id="cb8-290"><a href="#cb8-290"></a>    <span class="co">// elements.forEach(function(e) { ... });</span></span>
<span id="cb8-291"><a href="#cb8-291"></a></span>
<span id="cb8-292"><a href="#cb8-292"></a>    <span class="co">// ✅ Correct – use Count and GetAt()</span></span>
<span id="cb8-293"><a href="#cb8-293"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> elements<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb8-294"><a href="#cb8-294"></a>        <span class="kw">var</span> element <span class="op">=</span> elements<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb8-295"><a href="#cb8-295"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Element: "</span> <span class="op">+</span> element<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb8-296"><a href="#cb8-296"></a>    }</span>
<span id="cb8-297"><a href="#cb8-297"></a>}</span>
<span id="cb8-298"><a href="#cb8-298"></a></span>
<span id="cb8-299"><a href="#cb8-299"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb8-300"><a href="#cb8-300"></a><span class="in">```</span></span>
<span id="cb8-301"><a href="#cb8-301"></a></span>
<span id="cb8-302"><a href="#cb8-302"></a><span class="fu">### File I/O with ActiveX</span></span>
<span id="cb8-303"><a href="#cb8-303"></a></span>
<span id="cb8-304"><a href="#cb8-304"></a>If you need to read or write files, use the Windows FileSystemObject.</span>
<span id="cb8-305"><a href="#cb8-305"></a><span class="in">```{.js filename="Example 5.4 – Reading a text file in JScript"}</span></span>
<span id="cb8-306"><a href="#cb8-306"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-307"><a href="#cb8-307"></a><span class="co">// Example 5.4 - Reading a text file in JScript</span></span>
<span id="cb8-308"><a href="#cb8-308"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-309"><a href="#cb8-309"></a></span>
<span id="cb8-310"><a href="#cb8-310"></a><span class="kw">function</span> <span class="fu">readFile</span>(filePath) {</span>
<span id="cb8-311"><a href="#cb8-311"></a>    <span class="kw">var</span> fso <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Scripting.FileSystemObject"</span>)<span class="op">;</span></span>
<span id="cb8-312"><a href="#cb8-312"></a>    <span class="kw">var</span> file <span class="op">=</span> fso<span class="op">.</span><span class="fu">OpenTextFile</span>(filePath<span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span>  <span class="co">// 1 = ForReading</span></span>
<span id="cb8-313"><a href="#cb8-313"></a>    <span class="kw">var</span> content <span class="op">=</span> file<span class="op">.</span><span class="fu">ReadAll</span>()<span class="op">;</span></span>
<span id="cb8-314"><a href="#cb8-314"></a>    file<span class="op">.</span><span class="fu">Close</span>()<span class="op">;</span></span>
<span id="cb8-315"><a href="#cb8-315"></a>    <span class="cf">return</span> content<span class="op">;</span></span>
<span id="cb8-316"><a href="#cb8-316"></a>}</span>
<span id="cb8-317"><a href="#cb8-317"></a></span>
<span id="cb8-318"><a href="#cb8-318"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb8-319"><a href="#cb8-319"></a>    <span class="cf">try</span> {</span>
<span id="cb8-320"><a href="#cb8-320"></a>        <span class="kw">var</span> text <span class="op">=</span> <span class="fu">readFile</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">temp</span><span class="sc">\\</span><span class="st">example.txt"</span>)<span class="op">;</span></span>
<span id="cb8-321"><a href="#cb8-321"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"File contents: "</span> <span class="op">+</span> text)<span class="op">;</span></span>
<span id="cb8-322"><a href="#cb8-322"></a>    } <span class="cf">catch</span>(e) {</span>
<span id="cb8-323"><a href="#cb8-323"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Error: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb8-324"><a href="#cb8-324"></a>    }</span>
<span id="cb8-325"><a href="#cb8-325"></a>}</span>
<span id="cb8-326"><a href="#cb8-326"></a></span>
<span id="cb8-327"><a href="#cb8-327"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb8-328"><a href="#cb8-328"></a><span class="in">```</span></span>
<span id="cb8-329"><a href="#cb8-329"></a></span>
<span id="cb8-330"><a href="#cb8-330"></a><span class="fu">### Debugging with Session.Output</span></span>
<span id="cb8-331"><a href="#cb8-331"></a></span>
<span id="cb8-332"><a href="#cb8-332"></a>Unlike modern environments, you don’t have a console. Use</span>
<span id="cb8-333"><a href="#cb8-333"></a>Session.Output() to print values and track progress.</span>
<span id="cb8-334"><a href="#cb8-334"></a><span class="in">```{.js filename="Example 5.5 – Debugging with Session.Output"}</span></span>
<span id="cb8-335"><a href="#cb8-335"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-336"><a href="#cb8-336"></a><span class="co">// Example 5.5 - Debugging with Session.Output</span></span>
<span id="cb8-337"><a href="#cb8-337"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-338"><a href="#cb8-338"></a></span>
<span id="cb8-339"><a href="#cb8-339"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb8-340"><a href="#cb8-340"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Debugging start..."</span>)<span class="op">;</span></span>
<span id="cb8-341"><a href="#cb8-341"></a></span>
<span id="cb8-342"><a href="#cb8-342"></a>    <span class="kw">var</span> <span class="im">package</span> <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb8-343"><a href="#cb8-343"></a>    <span class="cf">if</span> (<span class="op">!</span><span class="im">package</span>) {</span>
<span id="cb8-344"><a href="#cb8-344"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"No package selected."</span>)<span class="op">;</span></span>
<span id="cb8-345"><a href="#cb8-345"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb8-346"><a href="#cb8-346"></a>    }</span>
<span id="cb8-347"><a href="#cb8-347"></a></span>
<span id="cb8-348"><a href="#cb8-348"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Selected package: "</span> <span class="op">+</span> <span class="im">package</span><span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb8-349"><a href="#cb8-349"></a></span>
<span id="cb8-350"><a href="#cb8-350"></a>    <span class="kw">var</span> elements <span class="op">=</span> <span class="im">package</span><span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb8-351"><a href="#cb8-351"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Element count: "</span> <span class="op">+</span> elements<span class="op">.</span><span class="at">Count</span>)<span class="op">;</span></span>
<span id="cb8-352"><a href="#cb8-352"></a></span>
<span id="cb8-353"><a href="#cb8-353"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> elements<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb8-354"><a href="#cb8-354"></a>        <span class="kw">var</span> element <span class="op">=</span> elements<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb8-355"><a href="#cb8-355"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Element["</span> <span class="op">+</span> i <span class="op">+</span> <span class="st">"]: "</span> <span class="op">+</span> element<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb8-356"><a href="#cb8-356"></a>    }</span>
<span id="cb8-357"><a href="#cb8-357"></a></span>
<span id="cb8-358"><a href="#cb8-358"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Debugging finished."</span>)<span class="op">;</span></span>
<span id="cb8-359"><a href="#cb8-359"></a>}</span>
<span id="cb8-360"><a href="#cb8-360"></a></span>
<span id="cb8-361"><a href="#cb8-361"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb8-362"><a href="#cb8-362"></a><span class="in">```</span></span>
<span id="cb8-363"><a href="#cb8-363"></a></span>
<span id="cb8-364"><a href="#cb8-364"></a><span class="fu">### Error Handling</span></span>
<span id="cb8-365"><a href="#cb8-365"></a></span>
<span id="cb8-366"><a href="#cb8-366"></a>JScript supports try–catch, but exceptions are limited.</span>
<span id="cb8-367"><a href="#cb8-367"></a><span class="in">```{.js filename="Example 5.6 – Error handling in JScript"}</span></span>
<span id="cb8-368"><a href="#cb8-368"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-369"><a href="#cb8-369"></a><span class="co">// Example 5.6 - Error handling in JScript</span></span>
<span id="cb8-370"><a href="#cb8-370"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-371"><a href="#cb8-371"></a></span>
<span id="cb8-372"><a href="#cb8-372"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb8-373"><a href="#cb8-373"></a>    <span class="cf">try</span> {</span>
<span id="cb8-374"><a href="#cb8-374"></a>        <span class="kw">var</span> result <span class="op">=</span> <span class="dv">10</span> <span class="op">/</span> <span class="dv">0</span><span class="op">;</span>  <span class="co">// Still valid, result = Infinity</span></span>
<span id="cb8-375"><a href="#cb8-375"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Result: "</span> <span class="op">+</span> result)<span class="op">;</span></span>
<span id="cb8-376"><a href="#cb8-376"></a></span>
<span id="cb8-377"><a href="#cb8-377"></a>        <span class="co">// Force an error by calling undefined function</span></span>
<span id="cb8-378"><a href="#cb8-378"></a>        <span class="fu">undefinedFunction</span>()<span class="op">;</span></span>
<span id="cb8-379"><a href="#cb8-379"></a>    } <span class="cf">catch</span> (e) {</span>
<span id="cb8-380"><a href="#cb8-380"></a>        <span class="co">// e.message is usually the only useful property</span></span>
<span id="cb8-381"><a href="#cb8-381"></a>        Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Caught error: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb8-382"><a href="#cb8-382"></a>    }</span>
<span id="cb8-383"><a href="#cb8-383"></a>}</span>
<span id="cb8-384"><a href="#cb8-384"></a></span>
<span id="cb8-385"><a href="#cb8-385"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb8-386"><a href="#cb8-386"></a><span class="in">```</span></span>
<span id="cb8-387"><a href="#cb8-387"></a></span>
<span id="cb8-388"><a href="#cb8-388"></a><span class="fu">### Putting It All Together</span></span>
<span id="cb8-389"><a href="#cb8-389"></a></span>
<span id="cb8-390"><a href="#cb8-390"></a>By combining these patterns, you can write safe, predictable scripts</span>
<span id="cb8-391"><a href="#cb8-391"></a>inside EA:</span>
<span id="cb8-392"><a href="#cb8-392"></a></span>
<span id="cb8-393"><a href="#cb8-393"></a><span class="ss">1.  </span>Always use var for variables.</span>
<span id="cb8-394"><a href="#cb8-394"></a></span>
<span id="cb8-395"><a href="#cb8-395"></a><span class="ss">2.  </span>Include helper functions for missing features.</span>
<span id="cb8-396"><a href="#cb8-396"></a></span>
<span id="cb8-397"><a href="#cb8-397"></a><span class="ss">3.  </span>Loop over collections with .Count and .GetAt(i).</span>
<span id="cb8-398"><a href="#cb8-398"></a></span>
<span id="cb8-399"><a href="#cb8-399"></a><span class="ss">4.  </span>Use Update() to persist changes and RefreshModelView() to update the</span>
<span id="cb8-400"><a href="#cb8-400"></a>    UI.</span>
<span id="cb8-401"><a href="#cb8-401"></a></span>
<span id="cb8-402"><a href="#cb8-402"></a><span class="ss">5.  </span>Use Session.Output() for debugging.</span>
<span id="cb8-403"><a href="#cb8-403"></a></span>
<span id="cb8-404"><a href="#cb8-404"></a><span class="ss">6.  </span>Use try–catch, but don’t expect detailed stack traces.</span>
<span id="cb8-405"><a href="#cb8-405"></a></span>
<span id="cb8-406"><a href="#cb8-406"></a><span class="fu">## Looking Ahead</span></span>
<span id="cb8-407"><a href="#cb8-407"></a></span>
<span id="cb8-408"><a href="#cb8-408"></a>This chapter has focused on the quirks of JScript inside EA. With this</span>
<span id="cb8-409"><a href="#cb8-409"></a>knowledge, you can write safe, basic scripts without falling into the</span>
<span id="cb8-410"><a href="#cb8-410"></a>traps of modern JavaScript expectations. In the next chapter we move to</span>
<span id="cb8-411"><a href="#cb8-411"></a>**external automation**, where Python, C#, and other modern languages</span>
<span id="cb8-412"><a href="#cb8-412"></a>open up much more powerful possibilities for integration and data</span>
<span id="cb8-413"><a href="#cb8-413"></a>processing.</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>