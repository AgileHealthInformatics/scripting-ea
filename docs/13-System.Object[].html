<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 12: Cookbook of Examples – Scripting Sparx Enterprise Architect: A Practical Handbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./14-System.Object[].html" rel="next">
<link href="./12-System.Object[].html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b4ddde2c4c77ed14ccfa95278770da4f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./13-System.Object[].html"><span class="chapter-title">Chapter 12: Cookbook of Examples</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Scripting Sparx Enterprise Architect: A Practical Handbook</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Scripting Sparx Enterprise Architect</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Preface.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 1: Why Script EA?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 2: Automation Landscape</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3: Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 4: API Essentials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 5: Inside EA with JScript</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 6: External Automation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 7: Script Design Patterns</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 8: Object Details</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 9: Imports &amp; Exports</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 10: MDG-Aware Scripting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 11: Governance Scripts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-System.Object[].html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Chapter 12: Cookbook of Examples</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 13: Why AI Helps</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 14: Prompt Engineering</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 15: AI Refactoring Partner</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 16: AI in Daily Workflow</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 17: Performance &amp; Scaling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 18: Integrating with Workflows</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 19: Add-ins vs Scripts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 20: Troubleshooting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 21: Reference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix A: Scripting Constraints</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix B: External Automation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix C: Glossary of Terms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix D: Quick Reference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27-System.Object[].html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix E: External Automation Setup</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-value-of-worked-examples" id="toc-the-value-of-worked-examples" class="nav-link active" data-scroll-target="#the-value-of-worked-examples">The Value of Worked Examples</a></li>
  <li><a href="#the-scope-of-the-cookbook" id="toc-the-scope-of-the-cookbook" class="nav-link" data-scroll-target="#the-scope-of-the-cookbook">The Scope of the Cookbook</a></li>
  <li><a href="#why-not-just-copy-from-the-internet" id="toc-why-not-just-copy-from-the-internet" class="nav-link" data-scroll-target="#why-not-just-copy-from-the-internet">Why Not Just Copy from the Internet?</a></li>
  <li><a href="#safety-first-in-a-cookbook" id="toc-safety-first-in-a-cookbook" class="nav-link" data-scroll-target="#safety-first-in-a-cookbook">Safety First in a Cookbook</a></li>
  <li><a href="#adapting-recipes-to-your-context" id="toc-adapting-recipes-to-your-context" class="nav-link" data-scroll-target="#adapting-recipes-to-your-context">Adapting Recipes to Your Context</a></li>
  <li><a href="#the-teaching-role-of-recipes" id="toc-the-teaching-role-of-recipes" class="nav-link" data-scroll-target="#the-teaching-role-of-recipes">The Teaching Role of Recipes</a></li>
  <li><a href="#building-a-shared-library" id="toc-building-a-shared-library" class="nav-link" data-scroll-target="#building-a-shared-library">Building a Shared Library</a></li>
  <li><a href="#cookbook-limitations" id="toc-cookbook-limitations" class="nav-link" data-scroll-target="#cookbook-limitations">Cookbook Limitations</a></li>
  <li><a href="#ai-and-cookbook-expansion" id="toc-ai-and-cookbook-expansion" class="nav-link" data-scroll-target="#ai-and-cookbook-expansion">AI and Cookbook Expansion</a>
  <ul class="collapse">
  <li><a href="#rename-all-elements-in-a-package" id="toc-rename-all-elements-in-a-package" class="nav-link" data-scroll-target="#rename-all-elements-in-a-package">Rename All Elements in a Package</a></li>
  <li><a href="#add-a-tagged-value-to-all-elements" id="toc-add-a-tagged-value-to-all-elements" class="nav-link" data-scroll-target="#add-a-tagged-value-to-all-elements">Add a Tagged Value to All Elements</a></li>
  <li><a href="#export-all-requirements-to-csv" id="toc-export-all-requirements-to-csv" class="nav-link" data-scroll-target="#export-all-requirements-to-csv">Export All Requirements to CSV</a></li>
  <li><a href="#find-orphaned-elements" id="toc-find-orphaned-elements" class="nav-link" data-scroll-target="#find-orphaned-elements">Find Orphaned Elements</a></li>
  <li><a href="#create-a-trace-link-between-selected-elements" id="toc-create-a-trace-link-between-selected-elements" class="nav-link" data-scroll-target="#create-a-trace-link-between-selected-elements">Create a Trace Link Between Selected Elements</a></li>
  <li><a href="#report-elements-missing-documentation" id="toc-report-elements-missing-documentation" class="nav-link" data-scroll-target="#report-elements-missing-documentation">Report Elements Missing Documentation</a></li>
  <li><a href="#export-class-attributes" id="toc-export-class-attributes" class="nav-link" data-scroll-target="#export-class-attributes">Export Class Attributes</a></li>
  <li><a href="#bulk-set-status" id="toc-bulk-set-status" class="nav-link" data-scroll-target="#bulk-set-status">Bulk Set Status</a></li>
  <li><a href="#delete-elements-safely" id="toc-delete-elements-safely" class="nav-link" data-scroll-target="#delete-elements-safely">Delete Elements Safely</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">Chapter 12: Cookbook of Examples</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>After learning the essentials of EA scripting, exploring design patterns, and examining governance automation, you are ready for a different kind of resource: a <strong>cookbook</strong>. This chapter serves as a library of practical scripts — small, focused recipes that solve common problems.</p>
<p>Why a cookbook? Because most architects and modellers do not want to read abstract descriptions of APIs or design principles when they are under pressure to deliver. They want to grab a working example, tweak a few lines, and get results. A cookbook provides exactly that: practical, runnable scripts that cover the typical scenarios you will encounter in everyday work with Enterprise Architect.</p>
<p>This introduction explains how to use the cookbook effectively, why examples are powerful learning tools, what safety precautions to take, and how to adapt recipes to your organisation’s context.</p>
<section id="the-value-of-worked-examples" class="level2">
<h2 class="anchored" data-anchor-id="the-value-of-worked-examples">The Value of Worked Examples</h2>
<p>Learning by example is one of the fastest ways to acquire scripting skills. You see the structure of a script, copy it, run it, and modify it. Each time you adapt an example, you internalise a little more of the API. Over time, the examples stop being magic incantations and start becoming familiar patterns.</p>
<p>This mirrors how many people learn to cook. Few start by reading chemistry textbooks. They follow recipes, taste the results, and gradually learn to improvise. A scripting cookbook provides the same bridge: from passive reading to active doing.</p>
</section>
<section id="the-scope-of-the-cookbook" class="level2">
<h2 class="anchored" data-anchor-id="the-scope-of-the-cookbook">The Scope of the Cookbook</h2>
<p>The examples in this chapter span a wide range of tasks:</p>
<ul>
<li><p>Simple utilities (rename elements, list tagged values).</p></li>
<li><p>Governance checks (enforce naming conventions, detect orphans).</p></li>
<li><p>Import/export helpers (CSV, JSON).</p></li>
<li><p>Diagram utilities (rename objects on diagrams, layout tweaks).</p></li>
<li><p>Advanced recipes (generate XMI, bulk stereotype changes).</p></li>
</ul>
<p>Together, these recipes form a library you can draw on again and again.</p>
</section>
<section id="why-not-just-copy-from-the-internet" class="level2">
<h2 class="anchored" data-anchor-id="why-not-just-copy-from-the-internet">Why Not Just Copy from the Internet?</h2>
<p>It is true that you can find EA script snippets on forums, blogs, or Q&amp;A sites. But they are often incomplete, outdated, or written without safety in mind. Some use direct SQL writes that risk corrupting the repository. Some assume modern JavaScript features that EA’s JScript engine does not support.</p>
<p>The difference here is that every recipe in this cookbook is:</p>
<ul>
<li><p>Fully runnable in EA’s script environment.</p></li>
<li><p>Corrected for ES3 constraints.</p></li>
<li><p>Structured with a standard header, dry-run flag, and logging.</p></li>
<li><p>Explained line by line with comments.</p></li>
</ul>
<p>This makes them safer and more reliable than random fragments you might stumble across online.</p>
</section>
<section id="safety-first-in-a-cookbook" class="level2">
<h2 class="anchored" data-anchor-id="safety-first-in-a-cookbook">Safety First in a Cookbook</h2>
<p>Even though these are examples, they still modify repositories. That means the safety principles of Chapter 3 apply even more strongly here.</p>
<p>Every modifying recipe includes:</p>
<ul>
<li><p>A <strong>DRY_RUN flag</strong> set to true by default.</p></li>
<li><p><strong>Session.Output</strong> logging for feedback.</p></li>
<li><p>Clear documentation of purpose, assumptions, and usage.</p></li>
<li><p>Where relevant, CSV logging so you can review results.</p></li>
</ul>
<p>Your responsibility as a user is to:</p>
<ol type="1">
<li><p>Run in dry-run mode first.</p></li>
<li><p>Review the logs.</p></li>
<li><p>Only then set DRY_RUN = false and rerun.</p></li>
</ol>
<p>Used this way, the cookbook is safe and predictable.</p>
</section>
<section id="adapting-recipes-to-your-context" class="level2">
<h2 class="anchored" data-anchor-id="adapting-recipes-to-your-context">Adapting Recipes to Your Context</h2>
<p>No recipe is ever perfect out of the box. Just as you might add more spice or substitute an ingredient in cooking, you will adapt these scripts to your organisation’s needs. That might mean:</p>
<ul>
<li><p>Changing the stereotype names to match your MDG.</p></li>
<li><p>Adding extra tagged values.</p></li>
<li><p>Adjusting logging paths to your file system.</p></li>
<li><p>Expanding filters to cover additional element types.</p></li>
</ul>
<p>The important thing is that you do not start from zero. You begin with a working, commented script and adapt it.</p>
</section>
<section id="the-teaching-role-of-recipes" class="level2">
<h2 class="anchored" data-anchor-id="the-teaching-role-of-recipes">The Teaching Role of Recipes</h2>
<p>Examples do more than solve immediate problems. They also teach. By comparing two recipes, you begin to notice similarities — the same .Count and .GetAt() loops, the same Update() calls, the same RefreshModelView(). You start to see the skeleton of the EA API underneath. This is how cookbook use deepens understanding: repetition makes the patterns obvious.</p>
</section>
<section id="building-a-shared-library" class="level2">
<h2 class="anchored" data-anchor-id="building-a-shared-library">Building a Shared Library</h2>
<p>One of the most powerful practices is to build a <strong>shared library of scripts</strong> for your team. Start with this cookbook, adapt recipes, and store them in version control (Git). Over time, your organisation develops its own tailored cookbook, aligned to your MDGs, governance rules, and workflows. This not only saves time but also enforces consistency across projects.</p>
</section>
<section id="cookbook-limitations" class="level2">
<h2 class="anchored" data-anchor-id="cookbook-limitations">Cookbook Limitations</h2>
<p>A cookbook is not a substitute for deeper understanding. If you only ever copy and paste without comprehension, you risk misuse. That is why every recipe is heavily commented — to explain not only <em>what</em> happens but <em>why</em>. The goal is not just to give you fish but to teach you how to fish.</p>
</section>
<section id="ai-and-cookbook-expansion" class="level2">
<h2 class="anchored" data-anchor-id="ai-and-cookbook-expansion">AI and Cookbook Expansion</h2>
<p>One interesting modern twist is that AI can generate new recipes on demand. You might start with a cookbook script and then ask an AI to adapt it: “Modify this script to export to JSON instead of CSV.” However, as we saw in earlier chapters, AI often hallucinates. That is why having a solid cookbook matters: you can use AI to vary a reliable base, rather than trusting AI to invent code from scratch.</p>
<section id="rename-all-elements-in-a-package" class="level3">
<h3 class="anchored" data-anchor-id="rename-all-elements-in-a-package">Rename All Elements in a Package</h3>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 12.1 - RenameElements_Prefix.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" data-filename="Example 12.1 - RenameElements_Prefix.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">// Example 12.1 - RenameElements_Prefix.js – JScript (ES3)</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">// Purpose: Add a prefix to all element names in the selected package</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">// Assumptions: User selects a package in Project Browser</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">// Safety: DRY_RUN = true by default</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb1-10"><a href="#cb1-10"></a>    <span class="kw">var</span> DRY_RUN <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>    <span class="kw">var</span> PREFIX <span class="op">=</span> <span class="st">"ARCH_"</span><span class="op">;</span></span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package first."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb1-18"><a href="#cb1-18"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>        <span class="cf">if</span> (e<span class="op">.</span><span class="at">Name</span><span class="op">.</span><span class="fu">indexOf</span>(PREFIX) <span class="op">!=</span> <span class="dv">0</span>) {</span>
<span id="cb1-20"><a href="#cb1-20"></a>            <span class="kw">var</span> newName <span class="op">=</span> PREFIX <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span><span class="op">;</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>            Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Would rename: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span> <span class="op">+</span> <span class="st">" → "</span> <span class="op">+</span> newName)<span class="op">;</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>            <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) {</span>
<span id="cb1-23"><a href="#cb1-23"></a>                e<span class="op">.</span><span class="at">Name</span> <span class="op">=</span> newName<span class="op">;</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>                e<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>            }</span>
<span id="cb1-26"><a href="#cb1-26"></a>        }</span>
<span id="cb1-27"><a href="#cb1-27"></a>    }</span>
<span id="cb1-28"><a href="#cb1-28"></a>    <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(pkg<span class="op">.</span><span class="at">PackageID</span>)<span class="op">;</span></span>
<span id="cb1-29"><a href="#cb1-29"></a>}</span>
<span id="cb1-30"><a href="#cb1-30"></a></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="add-a-tagged-value-to-all-elements" class="level3">
<h3 class="anchored" data-anchor-id="add-a-tagged-value-to-all-elements">Add a Tagged Value to All Elements</h3>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 12.2 - AddTag_AllElements.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" data-filename="Example 12.2 - AddTag_AllElements.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">// Example 12.2 - AddTag_AllElements.js – JScript (ES3)</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">// Purpose: Add or update a tagged value across all elements in a package</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb2-8"><a href="#cb2-8"></a>    <span class="kw">var</span> DRY_RUN <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>    <span class="kw">var</span> TAG_NAME <span class="op">=</span> <span class="st">"Owner"</span><span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>    <span class="kw">var</span> TAG_VALUE <span class="op">=</span> <span class="st">"ArchitectureTeam"</span><span class="op">;</span></span>
<span id="cb2-11"><a href="#cb2-11"></a></span>
<span id="cb2-12"><a href="#cb2-12"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb2-14"><a href="#cb2-14"></a></span>
<span id="cb2-15"><a href="#cb2-15"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb2-17"><a href="#cb2-17"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb2-18"><a href="#cb2-18"></a>        <span class="kw">var</span> tags <span class="op">=</span> e<span class="op">.</span><span class="at">TaggedValues</span><span class="op">;</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>        <span class="kw">var</span> found <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb2-20"><a href="#cb2-20"></a></span>
<span id="cb2-21"><a href="#cb2-21"></a>        <span class="cf">for</span> (<span class="kw">var</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span> j<span class="op">&lt;</span>tags<span class="op">.</span><span class="at">Count</span><span class="op">;</span> j<span class="op">++</span>) {</span>
<span id="cb2-22"><a href="#cb2-22"></a>            <span class="kw">var</span> t <span class="op">=</span> tags<span class="op">.</span><span class="fu">GetAt</span>(j)<span class="op">;</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>            <span class="cf">if</span> (t<span class="op">.</span><span class="at">Name</span> <span class="op">==</span> TAG_NAME) {</span>
<span id="cb2-24"><a href="#cb2-24"></a>                found <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb2-25"><a href="#cb2-25"></a>                <span class="cf">if</span> (t<span class="op">.</span><span class="at">Value</span> <span class="op">!=</span> TAG_VALUE) {</span>
<span id="cb2-26"><a href="#cb2-26"></a>                    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Update tag for "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb2-27"><a href="#cb2-27"></a>                    <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) { t<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> TAG_VALUE<span class="op">;</span> t<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span> e<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span> }</span>
<span id="cb2-28"><a href="#cb2-28"></a>                }</span>
<span id="cb2-29"><a href="#cb2-29"></a>            }</span>
<span id="cb2-30"><a href="#cb2-30"></a>        }</span>
<span id="cb2-31"><a href="#cb2-31"></a>        <span class="cf">if</span> (<span class="op">!</span>found) {</span>
<span id="cb2-32"><a href="#cb2-32"></a>            Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Add tag for "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb2-33"><a href="#cb2-33"></a>            <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) {</span>
<span id="cb2-34"><a href="#cb2-34"></a>                <span class="kw">var</span> nt <span class="op">=</span> tags<span class="op">.</span><span class="fu">AddNew</span>(TAG_NAME<span class="op">,</span> TAG_VALUE)<span class="op">;</span></span>
<span id="cb2-35"><a href="#cb2-35"></a>                nt<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span> e<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span></span>
<span id="cb2-36"><a href="#cb2-36"></a>            }</span>
<span id="cb2-37"><a href="#cb2-37"></a>        }</span>
<span id="cb2-38"><a href="#cb2-38"></a>    }</span>
<span id="cb2-39"><a href="#cb2-39"></a>    <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(pkg<span class="op">.</span><span class="at">PackageID</span>)<span class="op">;</span></span>
<span id="cb2-40"><a href="#cb2-40"></a>}</span>
<span id="cb2-41"><a href="#cb2-41"></a></span>
<span id="cb2-42"><a href="#cb2-42"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="export-all-requirements-to-csv" class="level3">
<h3 class="anchored" data-anchor-id="export-all-requirements-to-csv">Export All Requirements to CSV</h3>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 12.3 - ExportRequirements_CSV.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" data-filename="Example 12.3 - ExportRequirements_CSV.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">// Example 12.3 - ExportRequirements_CSV.js – JScript (ES3)</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">// Purpose: Write requirement names and notes to CSV</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">// Output: File written to chosen folder</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="kw">var</span> shell <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Shell.Application"</span>)<span class="op">;</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="kw">var</span> folder <span class="op">=</span> shell<span class="op">.</span><span class="fu">BrowseForFolder</span>(<span class="dv">0</span><span class="op">,</span> <span class="st">"Select output folder"</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="cf">if</span> (<span class="op">!</span>folder) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="kw">var</span> dir <span class="op">=</span> folder<span class="op">.</span><span class="at">Self</span><span class="op">.</span><span class="at">Path</span><span class="op">;</span></span>
<span id="cb3-13"><a href="#cb3-13"></a></span>
<span id="cb3-14"><a href="#cb3-14"></a>    <span class="kw">var</span> fso <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Scripting.FileSystemObject"</span>)<span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>    <span class="kw">var</span> file <span class="op">=</span> fso<span class="op">.</span><span class="fu">CreateTextFile</span>(dir <span class="op">+</span> <span class="st">"</span><span class="sc">\\</span><span class="st">requirements.csv"</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb3-16"><a href="#cb3-16"></a></span>
<span id="cb3-17"><a href="#cb3-17"></a>    file<span class="op">.</span><span class="fu">WriteLine</span>(<span class="st">"ID,Name,Notes"</span>)<span class="op">;</span></span>
<span id="cb3-18"><a href="#cb3-18"></a></span>
<span id="cb3-19"><a href="#cb3-19"></a>    <span class="kw">var</span> sql <span class="op">=</span> <span class="st">"SELECT Object_ID, Name, Note FROM t_object WHERE Object_Type='Requirement'"</span><span class="op">;</span></span>
<span id="cb3-20"><a href="#cb3-20"></a>    <span class="kw">var</span> xml <span class="op">=</span> Repository<span class="op">.</span><span class="fu">SQLQuery</span>(sql)<span class="op">;</span></span>
<span id="cb3-21"><a href="#cb3-21"></a></span>
<span id="cb3-22"><a href="#cb3-22"></a>    <span class="co">// Parse simple XML rows</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>    <span class="kw">var</span> rows <span class="op">=</span> xml<span class="op">.</span><span class="fu">split</span>(<span class="st">"&lt;Row&gt;"</span>)<span class="op">;</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span> i<span class="op">&lt;</span>rows<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb3-25"><a href="#cb3-25"></a>        <span class="kw">var</span> row <span class="op">=</span> rows[i]<span class="op">;</span></span>
<span id="cb3-26"><a href="#cb3-26"></a>        <span class="kw">var</span> id <span class="op">=</span> <span class="fu">between</span>(row<span class="op">,</span><span class="st">"&lt;Object_ID&gt;"</span><span class="op">,</span><span class="st">"&lt;/Object_ID&gt;"</span>)<span class="op">;</span></span>
<span id="cb3-27"><a href="#cb3-27"></a>        <span class="kw">var</span> nm <span class="op">=</span> <span class="fu">between</span>(row<span class="op">,</span><span class="st">"&lt;Name&gt;"</span><span class="op">,</span><span class="st">"&lt;/Name&gt;"</span>)<span class="op">;</span></span>
<span id="cb3-28"><a href="#cb3-28"></a>        <span class="kw">var</span> nt <span class="op">=</span> <span class="fu">between</span>(row<span class="op">,</span><span class="st">"&lt;Note&gt;"</span><span class="op">,</span><span class="st">"&lt;/Note&gt;"</span>)<span class="op">;</span></span>
<span id="cb3-29"><a href="#cb3-29"></a>        file<span class="op">.</span><span class="fu">WriteLine</span>(id <span class="op">+</span> <span class="st">",</span><span class="sc">\"</span><span class="st">"</span> <span class="op">+</span> nm <span class="op">+</span> <span class="st">"</span><span class="sc">\"</span><span class="st">,</span><span class="sc">\"</span><span class="st">"</span> <span class="op">+</span> nt <span class="op">+</span> <span class="st">"</span><span class="sc">\"</span><span class="st">"</span>)<span class="op">;</span></span>
<span id="cb3-30"><a href="#cb3-30"></a>    }</span>
<span id="cb3-31"><a href="#cb3-31"></a></span>
<span id="cb3-32"><a href="#cb3-32"></a>    file<span class="op">.</span><span class="fu">Close</span>()<span class="op">;</span></span>
<span id="cb3-33"><a href="#cb3-33"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Requirements exported."</span>)<span class="op">;</span></span>
<span id="cb3-34"><a href="#cb3-34"></a>}</span>
<span id="cb3-35"><a href="#cb3-35"></a></span>
<span id="cb3-36"><a href="#cb3-36"></a><span class="kw">function</span> <span class="fu">between</span>(h<span class="op">,</span>a<span class="op">,</span>b){ <span class="kw">var</span> i<span class="op">=</span>h<span class="op">.</span><span class="fu">indexOf</span>(a)<span class="op">;</span> <span class="cf">if</span>(i<span class="op">&lt;</span><span class="dv">0</span>) <span class="cf">return</span> <span class="st">""</span><span class="op">;</span> <span class="kw">var</span> j<span class="op">=</span>h<span class="op">.</span><span class="fu">indexOf</span>(b<span class="op">,</span>i<span class="op">+</span>a<span class="op">.</span><span class="at">length</span>)<span class="op">;</span> <span class="cf">return</span> j<span class="op">&lt;</span><span class="dv">0</span><span class="op">?</span><span class="st">""</span><span class="op">:</span>h<span class="op">.</span><span class="fu">substring</span>(i<span class="op">+</span>a<span class="op">.</span><span class="at">length</span><span class="op">,</span>j)<span class="op">;</span> }</span>
<span id="cb3-37"><a href="#cb3-37"></a></span>
<span id="cb3-38"><a href="#cb3-38"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="find-orphaned-elements" class="level3">
<h3 class="anchored" data-anchor-id="find-orphaned-elements">Find Orphaned Elements</h3>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 12.4 - FindOrphans.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" data-filename="Example 12.4 - FindOrphans.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">// Example 12.4 - FindOrphans.js – JScript (ES3)</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">// Purpose: Report elements with no connectors</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>    <span class="kw">var</span> orphans<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-13"><a href="#cb4-13"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb4-14"><a href="#cb4-14"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>        <span class="cf">if</span> (e<span class="op">.</span><span class="at">Connectors</span><span class="op">.</span><span class="at">Count</span> <span class="op">==</span> <span class="dv">0</span>) {</span>
<span id="cb4-16"><a href="#cb4-16"></a>            orphans<span class="op">++;</span></span>
<span id="cb4-17"><a href="#cb4-17"></a>            Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Orphan: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>        }</span>
<span id="cb4-19"><a href="#cb4-19"></a>    }</span>
<span id="cb4-20"><a href="#cb4-20"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Total orphans: "</span> <span class="op">+</span> orphans)<span class="op">;</span></span>
<span id="cb4-21"><a href="#cb4-21"></a>}</span>
<span id="cb4-22"><a href="#cb4-22"></a></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb4-24"><a href="#cb4-24"></a></span>
<span id="cb4-25"><a href="#cb4-25"></a></span>
<span id="cb4-26"><a href="#cb4-26"></a>### List Elements by Stereotype</span>
<span id="cb4-27"><a href="#cb4-27"></a><span class="vs">```{.js filename="Example 12.5 - ListByStereotype.js – JScript (ES3)"}</span></span>
<span id="cb4-28"><a href="#cb4-28"></a><span class="vs">// -------------------------------------------------------</span></span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="vs">// Example 12.5 - ListByStereotype.js – JScript (ES3)</span></span>
<span id="cb4-30"><a href="#cb4-30"></a><span class="vs">// Purpose: Output all elements with a given stereotype</span></span>
<span id="cb4-31"><a href="#cb4-31"></a><span class="vs">// -------------------------------------------------------</span></span>
<span id="cb4-32"><a href="#cb4-32"></a><span class="vs">!INC Local Scripts.EAConstants-JScript</span></span>
<span id="cb4-33"><a href="#cb4-33"></a></span>
<span id="cb4-34"><a href="#cb4-34"></a><span class="vs">function main() {</span></span>
<span id="cb4-35"><a href="#cb4-35"></a><span class="vs">    var STEREOTYPE = "Capability";</span></span>
<span id="cb4-36"><a href="#cb4-36"></a></span>
<span id="cb4-37"><a href="#cb4-37"></a><span class="vs">    var sql = "SELECT ea_guid, Name FROM t_object WHERE Stereotype='" + STEREOTYPE + "'";</span></span>
<span id="cb4-38"><a href="#cb4-38"></a><span class="vs">    var xml = Repository.SQLQuery(sql);</span></span>
<span id="cb4-39"><a href="#cb4-39"></a></span>
<span id="cb4-40"><a href="#cb4-40"></a><span class="vs">    var rows = xml.split("&lt;Row&gt;");</span></span>
<span id="cb4-41"><a href="#cb4-41"></a><span class="vs">    for (var i=1; i&lt;rows.length; i++) {</span></span>
<span id="cb4-42"><a href="#cb4-42"></a><span class="vs">        var row = rows[i];</span></span>
<span id="cb4-43"><a href="#cb4-43"></a><span class="vs">        var guid = between(row,"&lt;ea_guid&gt;","&lt;/ea_guid&gt;");</span></span>
<span id="cb4-44"><a href="#cb4-44"></a><span class="vs">        var nm = between(row,"&lt;Name&gt;","&lt;/Name&gt;");</span></span>
<span id="cb4-45"><a href="#cb4-45"></a><span class="vs">        Session.Output("Capability: " + nm + " (" + guid + ")");</span></span>
<span id="cb4-46"><a href="#cb4-46"></a><span class="vs">    }</span></span>
<span id="cb4-47"><a href="#cb4-47"></a><span class="vs">}</span></span>
<span id="cb4-48"><a href="#cb4-48"></a><span class="vs">function between(h,a,b){ var i=h.indexOf(a); if(i&lt;0) return ""; var j=h.indexOf(b,i+a.length); return j&lt;0?"":h.substring(i+a.length,j); }</span></span>
<span id="cb4-49"><a href="#cb4-49"></a></span>
<span id="cb4-50"><a href="#cb4-50"></a><span class="vs">main();</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="create-a-trace-link-between-selected-elements" class="level3">
<h3 class="anchored" data-anchor-id="create-a-trace-link-between-selected-elements">Create a Trace Link Between Selected Elements</h3>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 12.6 - CreateTrace.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" data-filename="Example 12.6 - CreateTrace.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">// Example 12.6 - CreateTrace.js – JScript (ES3)</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">// Purpose: Create a Realisation connector between two elements selected in a diagram</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb5-8"><a href="#cb5-8"></a>    <span class="kw">var</span> dia <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetCurrentDiagram</span>()<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>    <span class="cf">if</span> (<span class="op">!</span>dia) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Open a diagram and select two elements."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="cf">if</span> (dia<span class="op">.</span><span class="at">SelectedObjects</span><span class="op">.</span><span class="at">Count</span> <span class="op">!=</span> <span class="dv">2</span>) {</span>
<span id="cb5-12"><a href="#cb5-12"></a>        Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select exactly two elements."</span><span class="op">,</span> promptOK)<span class="op">;</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>    }</span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a>    <span class="kw">var</span> el1 <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetElementByID</span>(dia<span class="op">.</span><span class="at">SelectedObjects</span><span class="op">.</span><span class="fu">GetAt</span>(<span class="dv">0</span>)<span class="op">.</span><span class="at">ElementID</span>)<span class="op">;</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>    <span class="kw">var</span> el2 <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetElementByID</span>(dia<span class="op">.</span><span class="at">SelectedObjects</span><span class="op">.</span><span class="fu">GetAt</span>(<span class="dv">1</span>)<span class="op">.</span><span class="at">ElementID</span>)<span class="op">;</span></span>
<span id="cb5-18"><a href="#cb5-18"></a></span>
<span id="cb5-19"><a href="#cb5-19"></a>    <span class="kw">var</span> conn <span class="op">=</span> el1<span class="op">.</span><span class="at">Connectors</span><span class="op">.</span><span class="fu">AddNew</span>(<span class="st">""</span><span class="op">,</span> <span class="st">"Realisation"</span>)<span class="op">;</span></span>
<span id="cb5-20"><a href="#cb5-20"></a>    conn<span class="op">.</span><span class="at">SupplierID</span> <span class="op">=</span> el2<span class="op">.</span><span class="at">ElementID</span><span class="op">;</span></span>
<span id="cb5-21"><a href="#cb5-21"></a>    conn<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span></span>
<span id="cb5-22"><a href="#cb5-22"></a></span>
<span id="cb5-23"><a href="#cb5-23"></a>    Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(el1<span class="op">.</span><span class="at">PackageID</span>)<span class="op">;</span></span>
<span id="cb5-24"><a href="#cb5-24"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Trace created: "</span> <span class="op">+</span> el1<span class="op">.</span><span class="at">Name</span> <span class="op">+</span> <span class="st">" → "</span> <span class="op">+</span> el2<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb5-25"><a href="#cb5-25"></a>}</span>
<span id="cb5-26"><a href="#cb5-26"></a></span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="report-elements-missing-documentation" class="level3">
<h3 class="anchored" data-anchor-id="report-elements-missing-documentation">Report Elements Missing Documentation</h3>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 12.7 - FindMissingNotes.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" data-filename="Example 12.7 - FindMissingNotes.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">// Example 12.7 - FindMissingNotes.js – JScript (ES3)</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">// Purpose: List elements without notes (documentation)</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb6-8"><a href="#cb6-8"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb6-10"><a href="#cb6-10"></a></span>
<span id="cb6-11"><a href="#cb6-11"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb6-13"><a href="#cb6-13"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb6-14"><a href="#cb6-14"></a>        <span class="cf">if</span> (<span class="fu">trim</span>(e<span class="op">.</span><span class="at">Notes</span>) <span class="op">==</span> <span class="st">""</span>) {</span>
<span id="cb6-15"><a href="#cb6-15"></a>            Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Missing notes: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb6-16"><a href="#cb6-16"></a>        }</span>
<span id="cb6-17"><a href="#cb6-17"></a>    }</span>
<span id="cb6-18"><a href="#cb6-18"></a>}</span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="kw">function</span> <span class="fu">trim</span>(str){ <span class="cf">return</span> str<span class="op">==</span><span class="kw">null</span><span class="op">?</span><span class="st">""</span><span class="op">:</span><span class="bu">String</span>(str)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">^\s+|\s+$</span><span class="ss">/g</span><span class="op">,</span><span class="st">""</span>)<span class="op">;</span> }</span>
<span id="cb6-20"><a href="#cb6-20"></a></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="export-class-attributes" class="level3">
<h3 class="anchored" data-anchor-id="export-class-attributes">Export Class Attributes</h3>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 12.8 - ExportClassAttributes.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" data-filename="Example 12.8 - ExportClassAttributes.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">// Example 12.8 - ExportClassAttributes.js – JScript (ES3)</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">// Purpose: Export attributes of all classes in a package</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb7-8"><a href="#cb7-8"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb7-13"><a href="#cb7-13"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>        <span class="cf">if</span> (e<span class="op">.</span><span class="at">Type</span> <span class="op">==</span> <span class="st">"Class"</span>) {</span>
<span id="cb7-15"><a href="#cb7-15"></a>            <span class="kw">var</span> attrs <span class="op">=</span> e<span class="op">.</span><span class="at">Attributes</span><span class="op">;</span></span>
<span id="cb7-16"><a href="#cb7-16"></a>            <span class="cf">for</span> (<span class="kw">var</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span> j<span class="op">&lt;</span>attrs<span class="op">.</span><span class="at">Count</span><span class="op">;</span> j<span class="op">++</span>) {</span>
<span id="cb7-17"><a href="#cb7-17"></a>                <span class="kw">var</span> a <span class="op">=</span> attrs<span class="op">.</span><span class="fu">GetAt</span>(j)<span class="op">;</span></span>
<span id="cb7-18"><a href="#cb7-18"></a>                Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Class "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span> <span class="op">+</span> <span class="st">" attr: "</span> <span class="op">+</span> a<span class="op">.</span><span class="at">Name</span> <span class="op">+</span> <span class="st">":"</span> <span class="op">+</span> a<span class="op">.</span><span class="at">Type</span>)<span class="op">;</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>            }</span>
<span id="cb7-20"><a href="#cb7-20"></a>        }</span>
<span id="cb7-21"><a href="#cb7-21"></a>    }</span>
<span id="cb7-22"><a href="#cb7-22"></a>}</span>
<span id="cb7-23"><a href="#cb7-23"></a></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="bulk-set-status" class="level3">
<h3 class="anchored" data-anchor-id="bulk-set-status">Bulk Set Status</h3>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 12.9 - BulkSetStatus.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" data-filename="Example 12.9 - BulkSetStatus.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">// Example 12.9 - BulkSetStatus.js – JScript (ES3)</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">// Purpose: Set the Status of all elements in a package</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb8-8"><a href="#cb8-8"></a>    <span class="kw">var</span> DRY_RUN <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="kw">var</span> NEW_STATUS <span class="op">=</span> <span class="st">"Proposed"</span><span class="op">;</span></span>
<span id="cb8-10"><a href="#cb8-10"></a></span>
<span id="cb8-11"><a href="#cb8-11"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb8-13"><a href="#cb8-13"></a></span>
<span id="cb8-14"><a href="#cb8-14"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb8-16"><a href="#cb8-16"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>        <span class="cf">if</span> (e<span class="op">.</span><span class="at">Status</span> <span class="op">!=</span> NEW_STATUS) {</span>
<span id="cb8-18"><a href="#cb8-18"></a>            Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Change status: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span> <span class="op">+</span> <span class="st">" → "</span> <span class="op">+</span> NEW_STATUS)<span class="op">;</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>            <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) { e<span class="op">.</span><span class="at">Status</span> <span class="op">=</span> NEW_STATUS<span class="op">;</span> e<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span> }</span>
<span id="cb8-20"><a href="#cb8-20"></a>        }</span>
<span id="cb8-21"><a href="#cb8-21"></a>    }</span>
<span id="cb8-22"><a href="#cb8-22"></a>    <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(pkg<span class="op">.</span><span class="at">PackageID</span>)<span class="op">;</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>}</span>
<span id="cb8-24"><a href="#cb8-24"></a></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="delete-elements-safely" class="level3">
<h3 class="anchored" data-anchor-id="delete-elements-safely">Delete Elements Safely</h3>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 12.10 - SafeDelete.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9" data-filename="Example 12.10 - SafeDelete.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">// Example 12.10 - SafeDelete.js – JScript (ES3)</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">// Purpose: Delete all elements of a given type in a package</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">// Safety: DRY_RUN = true by default</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb9-9"><a href="#cb9-9"></a>    <span class="kw">var</span> DRY_RUN <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="kw">var</span> TYPE_FILTER <span class="op">=</span> <span class="st">"UseCase"</span><span class="op">;</span></span>
<span id="cb9-11"><a href="#cb9-11"></a></span>
<span id="cb9-12"><a href="#cb9-12"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb9-13"><a href="#cb9-13"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb9-14"><a href="#cb9-14"></a></span>
<span id="cb9-15"><a href="#cb9-15"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb9-16"><a href="#cb9-16"></a>    <span class="co">// Iterate backwards when deleting</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span>els<span class="op">.</span><span class="at">Count</span><span class="op">-</span><span class="dv">1</span><span class="op">;</span> i<span class="op">&gt;=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">--</span>) {</span>
<span id="cb9-18"><a href="#cb9-18"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb9-19"><a href="#cb9-19"></a>        <span class="cf">if</span> (e<span class="op">.</span><span class="at">Type</span> <span class="op">==</span> TYPE_FILTER) {</span>
<span id="cb9-20"><a href="#cb9-20"></a>            Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Would delete: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb9-21"><a href="#cb9-21"></a>            <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) {</span>
<span id="cb9-22"><a href="#cb9-22"></a>                els<span class="op">.</span><span class="fu">DeleteAt</span>(i<span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span> <span class="co">// false = don't refresh each time</span></span>
<span id="cb9-23"><a href="#cb9-23"></a>            }</span>
<span id="cb9-24"><a href="#cb9-24"></a>        }</span>
<span id="cb9-25"><a href="#cb9-25"></a>    }</span>
<span id="cb9-26"><a href="#cb9-26"></a>    <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) {</span>
<span id="cb9-27"><a href="#cb9-27"></a>        pkg<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span></span>
<span id="cb9-28"><a href="#cb9-28"></a>        Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(pkg<span class="op">.</span><span class="at">PackageID</span>)<span class="op">;</span></span>
<span id="cb9-29"><a href="#cb9-29"></a>    }</span>
<span id="cb9-30"><a href="#cb9-30"></a>}</span>
<span id="cb9-31"><a href="#cb9-31"></a></span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>This cookbook chapter delivers <strong>ready-to-use recipes</strong>:</p>
<ul>
<li><p>Bulk editing (11.1, 11.2, 11.9, 11.10).</p></li>
<li><p>Reporting (11.4, 11.5, 11.7, 11.8).</p></li>
<li><p>Traceability utilities (11.6).</p></li>
<li><p>Import/export utilities (11.3).</p></li>
</ul>
<p>Each follows the <strong>constraints of EA’s JScript engine</strong> (ES3 only, ActiveX for files, .Count/.GetAt() for collections).</p>


<!-- -->

</section>

</main> <!-- /main -->
<script>

document.addEventListener('DOMContentLoaded', function () {

  // Prefer the margin sidebar if it exists; otherwise try the TOC sidebar.

  const margin = document.querySelector('#quarto-margin-sidebar, .margin-sidebar, .column-margin');

  const toc    = document.querySelector('nav#TOC');

  const sidebar = margin || (toc && toc.closest('.sidebar, .quarto-sidebar, .margin-sidebar'));



  if (!sidebar) return; // no margin column on this layout



  const holder = document.createElement('div');

  holder.className = 'cover-above-toc';

  holder.innerHTML = `

    <a href="index.html">

      <img src="images/cover.png" alt="Book cover" class="cover-above-toc__img" width="140" />

    </a>

  `;

  sidebar.prepend(holder);

});

</script>



<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./12-System.Object[].html" class="pagination-link" aria-label="Chapter 11: Governance Scripts">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Chapter 11: Governance Scripts</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./14-System.Object[].html" class="pagination-link" aria-label="Chapter 13: Why AI Helps">
        <span class="nav-page-text"><span class="chapter-title">Chapter 13: Why AI Helps</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu"># Chapter 12: Cookbook of Examples</span></span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a>After learning the essentials of EA scripting, exploring design</span>
<span id="cb10-4"><a href="#cb10-4"></a>patterns, and examining governance automation, you are ready for a</span>
<span id="cb10-5"><a href="#cb10-5"></a>different kind of resource: a **cookbook**. This chapter serves as a</span>
<span id="cb10-6"><a href="#cb10-6"></a>library of practical scripts — small, focused recipes that solve common</span>
<span id="cb10-7"><a href="#cb10-7"></a>problems.</span>
<span id="cb10-8"><a href="#cb10-8"></a></span>
<span id="cb10-9"><a href="#cb10-9"></a>Why a cookbook? Because most architects and modellers do not want to</span>
<span id="cb10-10"><a href="#cb10-10"></a>read abstract descriptions of APIs or design principles when they are</span>
<span id="cb10-11"><a href="#cb10-11"></a>under pressure to deliver. They want to grab a working example, tweak a</span>
<span id="cb10-12"><a href="#cb10-12"></a>few lines, and get results. A cookbook provides exactly that: practical,</span>
<span id="cb10-13"><a href="#cb10-13"></a>runnable scripts that cover the typical scenarios you will encounter in</span>
<span id="cb10-14"><a href="#cb10-14"></a>everyday work with Enterprise Architect.</span>
<span id="cb10-15"><a href="#cb10-15"></a></span>
<span id="cb10-16"><a href="#cb10-16"></a>This introduction explains how to use the cookbook effectively, why</span>
<span id="cb10-17"><a href="#cb10-17"></a>examples are powerful learning tools, what safety precautions to take,</span>
<span id="cb10-18"><a href="#cb10-18"></a>and how to adapt recipes to your organisation’s context.</span>
<span id="cb10-19"><a href="#cb10-19"></a></span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="fu">## The Value of Worked Examples</span></span>
<span id="cb10-21"><a href="#cb10-21"></a></span>
<span id="cb10-22"><a href="#cb10-22"></a>Learning by example is one of the fastest ways to acquire scripting</span>
<span id="cb10-23"><a href="#cb10-23"></a>skills. You see the structure of a script, copy it, run it, and modify</span>
<span id="cb10-24"><a href="#cb10-24"></a>it. Each time you adapt an example, you internalise a little more of the</span>
<span id="cb10-25"><a href="#cb10-25"></a>API. Over time, the examples stop being magic incantations and start</span>
<span id="cb10-26"><a href="#cb10-26"></a>becoming familiar patterns.</span>
<span id="cb10-27"><a href="#cb10-27"></a></span>
<span id="cb10-28"><a href="#cb10-28"></a>This mirrors how many people learn to cook. Few start by reading</span>
<span id="cb10-29"><a href="#cb10-29"></a>chemistry textbooks. They follow recipes, taste the results, and</span>
<span id="cb10-30"><a href="#cb10-30"></a>gradually learn to improvise. A scripting cookbook provides the same</span>
<span id="cb10-31"><a href="#cb10-31"></a>bridge: from passive reading to active doing.</span>
<span id="cb10-32"><a href="#cb10-32"></a></span>
<span id="cb10-33"><a href="#cb10-33"></a><span class="fu">## The Scope of the Cookbook</span></span>
<span id="cb10-34"><a href="#cb10-34"></a></span>
<span id="cb10-35"><a href="#cb10-35"></a>The examples in this chapter span a wide range of tasks:</span>
<span id="cb10-36"><a href="#cb10-36"></a></span>
<span id="cb10-37"><a href="#cb10-37"></a><span class="ss">- </span>Simple utilities (rename elements, list tagged values).</span>
<span id="cb10-38"><a href="#cb10-38"></a></span>
<span id="cb10-39"><a href="#cb10-39"></a><span class="ss">- </span>Governance checks (enforce naming conventions, detect orphans).</span>
<span id="cb10-40"><a href="#cb10-40"></a></span>
<span id="cb10-41"><a href="#cb10-41"></a><span class="ss">- </span>Import/export helpers (CSV, JSON).</span>
<span id="cb10-42"><a href="#cb10-42"></a></span>
<span id="cb10-43"><a href="#cb10-43"></a><span class="ss">- </span>Diagram utilities (rename objects on diagrams, layout tweaks).</span>
<span id="cb10-44"><a href="#cb10-44"></a></span>
<span id="cb10-45"><a href="#cb10-45"></a><span class="ss">- </span>Advanced recipes (generate XMI, bulk stereotype changes).</span>
<span id="cb10-46"><a href="#cb10-46"></a></span>
<span id="cb10-47"><a href="#cb10-47"></a>Together, these recipes form a library you can draw on again and again.</span>
<span id="cb10-48"><a href="#cb10-48"></a></span>
<span id="cb10-49"><a href="#cb10-49"></a><span class="fu">## Why Not Just Copy from the Internet?</span></span>
<span id="cb10-50"><a href="#cb10-50"></a></span>
<span id="cb10-51"><a href="#cb10-51"></a>It is true that you can find EA script snippets on forums, blogs, or Q&amp;A</span>
<span id="cb10-52"><a href="#cb10-52"></a>sites. But they are often incomplete, outdated, or written without</span>
<span id="cb10-53"><a href="#cb10-53"></a>safety in mind. Some use direct SQL writes that risk corrupting the</span>
<span id="cb10-54"><a href="#cb10-54"></a>repository. Some assume modern JavaScript features that EA’s JScript</span>
<span id="cb10-55"><a href="#cb10-55"></a>engine does not support.</span>
<span id="cb10-56"><a href="#cb10-56"></a></span>
<span id="cb10-57"><a href="#cb10-57"></a>The difference here is that every recipe in this cookbook is:</span>
<span id="cb10-58"><a href="#cb10-58"></a></span>
<span id="cb10-59"><a href="#cb10-59"></a><span class="ss">- </span>Fully runnable in EA’s script environment.</span>
<span id="cb10-60"><a href="#cb10-60"></a></span>
<span id="cb10-61"><a href="#cb10-61"></a><span class="ss">- </span>Corrected for ES3 constraints.</span>
<span id="cb10-62"><a href="#cb10-62"></a></span>
<span id="cb10-63"><a href="#cb10-63"></a><span class="ss">- </span>Structured with a standard header, dry-run flag, and logging.</span>
<span id="cb10-64"><a href="#cb10-64"></a></span>
<span id="cb10-65"><a href="#cb10-65"></a><span class="ss">- </span>Explained line by line with comments.</span>
<span id="cb10-66"><a href="#cb10-66"></a></span>
<span id="cb10-67"><a href="#cb10-67"></a>This makes them safer and more reliable than random fragments you might</span>
<span id="cb10-68"><a href="#cb10-68"></a>stumble across online.</span>
<span id="cb10-69"><a href="#cb10-69"></a></span>
<span id="cb10-70"><a href="#cb10-70"></a><span class="fu">## Safety First in a Cookbook</span></span>
<span id="cb10-71"><a href="#cb10-71"></a></span>
<span id="cb10-72"><a href="#cb10-72"></a>Even though these are examples, they still modify repositories. That</span>
<span id="cb10-73"><a href="#cb10-73"></a>means the safety principles of Chapter 3 apply even more strongly here.</span>
<span id="cb10-74"><a href="#cb10-74"></a></span>
<span id="cb10-75"><a href="#cb10-75"></a>Every modifying recipe includes:</span>
<span id="cb10-76"><a href="#cb10-76"></a></span>
<span id="cb10-77"><a href="#cb10-77"></a><span class="ss">- </span>A **DRY_RUN flag** set to true by default.</span>
<span id="cb10-78"><a href="#cb10-78"></a></span>
<span id="cb10-79"><a href="#cb10-79"></a><span class="ss">- </span>**Session.Output** logging for feedback.</span>
<span id="cb10-80"><a href="#cb10-80"></a></span>
<span id="cb10-81"><a href="#cb10-81"></a><span class="ss">- </span>Clear documentation of purpose, assumptions, and usage.</span>
<span id="cb10-82"><a href="#cb10-82"></a></span>
<span id="cb10-83"><a href="#cb10-83"></a><span class="ss">- </span>Where relevant, CSV logging so you can review results.</span>
<span id="cb10-84"><a href="#cb10-84"></a></span>
<span id="cb10-85"><a href="#cb10-85"></a>Your responsibility as a user is to:</span>
<span id="cb10-86"><a href="#cb10-86"></a></span>
<span id="cb10-87"><a href="#cb10-87"></a><span class="ss">1.  </span>Run in dry-run mode first.</span>
<span id="cb10-88"><a href="#cb10-88"></a></span>
<span id="cb10-89"><a href="#cb10-89"></a><span class="ss">2.  </span>Review the logs.</span>
<span id="cb10-90"><a href="#cb10-90"></a></span>
<span id="cb10-91"><a href="#cb10-91"></a><span class="ss">3.  </span>Only then set DRY_RUN = false and rerun.</span>
<span id="cb10-92"><a href="#cb10-92"></a></span>
<span id="cb10-93"><a href="#cb10-93"></a>Used this way, the cookbook is safe and predictable.</span>
<span id="cb10-94"><a href="#cb10-94"></a></span>
<span id="cb10-95"><a href="#cb10-95"></a><span class="fu">## Adapting Recipes to Your Context</span></span>
<span id="cb10-96"><a href="#cb10-96"></a></span>
<span id="cb10-97"><a href="#cb10-97"></a>No recipe is ever perfect out of the box. Just as you might add more</span>
<span id="cb10-98"><a href="#cb10-98"></a>spice or substitute an ingredient in cooking, you will adapt these</span>
<span id="cb10-99"><a href="#cb10-99"></a>scripts to your organisation’s needs. That might mean:</span>
<span id="cb10-100"><a href="#cb10-100"></a></span>
<span id="cb10-101"><a href="#cb10-101"></a><span class="ss">- </span>Changing the stereotype names to match your MDG.</span>
<span id="cb10-102"><a href="#cb10-102"></a></span>
<span id="cb10-103"><a href="#cb10-103"></a><span class="ss">- </span>Adding extra tagged values.</span>
<span id="cb10-104"><a href="#cb10-104"></a></span>
<span id="cb10-105"><a href="#cb10-105"></a><span class="ss">- </span>Adjusting logging paths to your file system.</span>
<span id="cb10-106"><a href="#cb10-106"></a></span>
<span id="cb10-107"><a href="#cb10-107"></a><span class="ss">- </span>Expanding filters to cover additional element types.</span>
<span id="cb10-108"><a href="#cb10-108"></a></span>
<span id="cb10-109"><a href="#cb10-109"></a>The important thing is that you do not start from zero. You begin with a</span>
<span id="cb10-110"><a href="#cb10-110"></a>working, commented script and adapt it.</span>
<span id="cb10-111"><a href="#cb10-111"></a></span>
<span id="cb10-112"><a href="#cb10-112"></a><span class="fu">## The Teaching Role of Recipes</span></span>
<span id="cb10-113"><a href="#cb10-113"></a></span>
<span id="cb10-114"><a href="#cb10-114"></a>Examples do more than solve immediate problems. They also teach. By</span>
<span id="cb10-115"><a href="#cb10-115"></a>comparing two recipes, you begin to notice similarities — the same</span>
<span id="cb10-116"><a href="#cb10-116"></a>.Count and .GetAt() loops, the same Update() calls, the same</span>
<span id="cb10-117"><a href="#cb10-117"></a>RefreshModelView(). You start to see the skeleton of the EA API</span>
<span id="cb10-118"><a href="#cb10-118"></a>underneath. This is how cookbook use deepens understanding: repetition</span>
<span id="cb10-119"><a href="#cb10-119"></a>makes the patterns obvious.</span>
<span id="cb10-120"><a href="#cb10-120"></a></span>
<span id="cb10-121"><a href="#cb10-121"></a><span class="fu">## Building a Shared Library</span></span>
<span id="cb10-122"><a href="#cb10-122"></a></span>
<span id="cb10-123"><a href="#cb10-123"></a>One of the most powerful practices is to build a **shared library of</span>
<span id="cb10-124"><a href="#cb10-124"></a>scripts** for your team. Start with this cookbook, adapt recipes, and</span>
<span id="cb10-125"><a href="#cb10-125"></a>store them in version control (Git). Over time, your organisation</span>
<span id="cb10-126"><a href="#cb10-126"></a>develops its own tailored cookbook, aligned to your MDGs, governance</span>
<span id="cb10-127"><a href="#cb10-127"></a>rules, and workflows. This not only saves time but also enforces</span>
<span id="cb10-128"><a href="#cb10-128"></a>consistency across projects.</span>
<span id="cb10-129"><a href="#cb10-129"></a></span>
<span id="cb10-130"><a href="#cb10-130"></a><span class="fu">## Cookbook Limitations</span></span>
<span id="cb10-131"><a href="#cb10-131"></a></span>
<span id="cb10-132"><a href="#cb10-132"></a>A cookbook is not a substitute for deeper understanding. If you only</span>
<span id="cb10-133"><a href="#cb10-133"></a>ever copy and paste without comprehension, you risk misuse. That is why</span>
<span id="cb10-134"><a href="#cb10-134"></a>every recipe is heavily commented — to explain not only *what* happens</span>
<span id="cb10-135"><a href="#cb10-135"></a>but *why*. The goal is not just to give you fish but to teach you how to</span>
<span id="cb10-136"><a href="#cb10-136"></a>fish.</span>
<span id="cb10-137"><a href="#cb10-137"></a></span>
<span id="cb10-138"><a href="#cb10-138"></a><span class="fu">## AI and Cookbook Expansion</span></span>
<span id="cb10-139"><a href="#cb10-139"></a></span>
<span id="cb10-140"><a href="#cb10-140"></a>One interesting modern twist is that AI can generate new recipes on</span>
<span id="cb10-141"><a href="#cb10-141"></a>demand. You might start with a cookbook script and then ask an AI to</span>
<span id="cb10-142"><a href="#cb10-142"></a>adapt it: “Modify this script to export to JSON instead of CSV.”</span>
<span id="cb10-143"><a href="#cb10-143"></a>However, as we saw in earlier chapters, AI often hallucinates. That is</span>
<span id="cb10-144"><a href="#cb10-144"></a>why having a solid cookbook matters: you can use AI to vary a reliable</span>
<span id="cb10-145"><a href="#cb10-145"></a>base, rather than trusting AI to invent code from scratch.</span>
<span id="cb10-146"><a href="#cb10-146"></a></span>
<span id="cb10-147"><a href="#cb10-147"></a><span class="fu">### Rename All Elements in a Package</span></span>
<span id="cb10-148"><a href="#cb10-148"></a></span>
<span id="cb10-149"><a href="#cb10-149"></a><span class="in">```{.js filename="Example 12.1 - RenameElements_Prefix.js – JScript (ES3)"}</span></span>
<span id="cb10-150"><a href="#cb10-150"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb10-151"><a href="#cb10-151"></a><span class="co">// Example 12.1 - RenameElements_Prefix.js – JScript (ES3)</span></span>
<span id="cb10-152"><a href="#cb10-152"></a><span class="co">// Purpose: Add a prefix to all element names in the selected package</span></span>
<span id="cb10-153"><a href="#cb10-153"></a><span class="co">// Assumptions: User selects a package in Project Browser</span></span>
<span id="cb10-154"><a href="#cb10-154"></a><span class="co">// Safety: DRY_RUN = true by default</span></span>
<span id="cb10-155"><a href="#cb10-155"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb10-156"><a href="#cb10-156"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb10-157"><a href="#cb10-157"></a></span>
<span id="cb10-158"><a href="#cb10-158"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb10-159"><a href="#cb10-159"></a>    <span class="kw">var</span> DRY_RUN <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb10-160"><a href="#cb10-160"></a>    <span class="kw">var</span> PREFIX <span class="op">=</span> <span class="st">"ARCH_"</span><span class="op">;</span></span>
<span id="cb10-161"><a href="#cb10-161"></a></span>
<span id="cb10-162"><a href="#cb10-162"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb10-163"><a href="#cb10-163"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package first."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb10-164"><a href="#cb10-164"></a></span>
<span id="cb10-165"><a href="#cb10-165"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb10-166"><a href="#cb10-166"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb10-167"><a href="#cb10-167"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb10-168"><a href="#cb10-168"></a>        <span class="cf">if</span> (e<span class="op">.</span><span class="at">Name</span><span class="op">.</span><span class="fu">indexOf</span>(PREFIX) <span class="op">!=</span> <span class="dv">0</span>) {</span>
<span id="cb10-169"><a href="#cb10-169"></a>            <span class="kw">var</span> newName <span class="op">=</span> PREFIX <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span><span class="op">;</span></span>
<span id="cb10-170"><a href="#cb10-170"></a>            Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Would rename: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span> <span class="op">+</span> <span class="st">" → "</span> <span class="op">+</span> newName)<span class="op">;</span></span>
<span id="cb10-171"><a href="#cb10-171"></a>            <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) {</span>
<span id="cb10-172"><a href="#cb10-172"></a>                e<span class="op">.</span><span class="at">Name</span> <span class="op">=</span> newName<span class="op">;</span></span>
<span id="cb10-173"><a href="#cb10-173"></a>                e<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span></span>
<span id="cb10-174"><a href="#cb10-174"></a>            }</span>
<span id="cb10-175"><a href="#cb10-175"></a>        }</span>
<span id="cb10-176"><a href="#cb10-176"></a>    }</span>
<span id="cb10-177"><a href="#cb10-177"></a>    <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(pkg<span class="op">.</span><span class="at">PackageID</span>)<span class="op">;</span></span>
<span id="cb10-178"><a href="#cb10-178"></a>}</span>
<span id="cb10-179"><a href="#cb10-179"></a></span>
<span id="cb10-180"><a href="#cb10-180"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb10-181"><a href="#cb10-181"></a><span class="in">```</span></span>
<span id="cb10-182"><a href="#cb10-182"></a></span>
<span id="cb10-183"><a href="#cb10-183"></a><span class="fu">### Add a Tagged Value to All Elements</span></span>
<span id="cb10-184"><a href="#cb10-184"></a></span>
<span id="cb10-185"><a href="#cb10-185"></a><span class="in">```{.js filename="Example 12.2 - AddTag_AllElements.js – JScript (ES3)"}</span></span>
<span id="cb10-186"><a href="#cb10-186"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb10-187"><a href="#cb10-187"></a><span class="co">// Example 12.2 - AddTag_AllElements.js – JScript (ES3)</span></span>
<span id="cb10-188"><a href="#cb10-188"></a><span class="co">// Purpose: Add or update a tagged value across all elements in a package</span></span>
<span id="cb10-189"><a href="#cb10-189"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb10-190"><a href="#cb10-190"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb10-191"><a href="#cb10-191"></a></span>
<span id="cb10-192"><a href="#cb10-192"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb10-193"><a href="#cb10-193"></a>    <span class="kw">var</span> DRY_RUN <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb10-194"><a href="#cb10-194"></a>    <span class="kw">var</span> TAG_NAME <span class="op">=</span> <span class="st">"Owner"</span><span class="op">;</span></span>
<span id="cb10-195"><a href="#cb10-195"></a>    <span class="kw">var</span> TAG_VALUE <span class="op">=</span> <span class="st">"ArchitectureTeam"</span><span class="op">;</span></span>
<span id="cb10-196"><a href="#cb10-196"></a></span>
<span id="cb10-197"><a href="#cb10-197"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb10-198"><a href="#cb10-198"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb10-199"><a href="#cb10-199"></a></span>
<span id="cb10-200"><a href="#cb10-200"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb10-201"><a href="#cb10-201"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb10-202"><a href="#cb10-202"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb10-203"><a href="#cb10-203"></a>        <span class="kw">var</span> tags <span class="op">=</span> e<span class="op">.</span><span class="at">TaggedValues</span><span class="op">;</span></span>
<span id="cb10-204"><a href="#cb10-204"></a>        <span class="kw">var</span> found <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb10-205"><a href="#cb10-205"></a></span>
<span id="cb10-206"><a href="#cb10-206"></a>        <span class="cf">for</span> (<span class="kw">var</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span> j<span class="op">&lt;</span>tags<span class="op">.</span><span class="at">Count</span><span class="op">;</span> j<span class="op">++</span>) {</span>
<span id="cb10-207"><a href="#cb10-207"></a>            <span class="kw">var</span> t <span class="op">=</span> tags<span class="op">.</span><span class="fu">GetAt</span>(j)<span class="op">;</span></span>
<span id="cb10-208"><a href="#cb10-208"></a>            <span class="cf">if</span> (t<span class="op">.</span><span class="at">Name</span> <span class="op">==</span> TAG_NAME) {</span>
<span id="cb10-209"><a href="#cb10-209"></a>                found <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb10-210"><a href="#cb10-210"></a>                <span class="cf">if</span> (t<span class="op">.</span><span class="at">Value</span> <span class="op">!=</span> TAG_VALUE) {</span>
<span id="cb10-211"><a href="#cb10-211"></a>                    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Update tag for "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb10-212"><a href="#cb10-212"></a>                    <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) { t<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> TAG_VALUE<span class="op">;</span> t<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span> e<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span> }</span>
<span id="cb10-213"><a href="#cb10-213"></a>                }</span>
<span id="cb10-214"><a href="#cb10-214"></a>            }</span>
<span id="cb10-215"><a href="#cb10-215"></a>        }</span>
<span id="cb10-216"><a href="#cb10-216"></a>        <span class="cf">if</span> (<span class="op">!</span>found) {</span>
<span id="cb10-217"><a href="#cb10-217"></a>            Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Add tag for "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb10-218"><a href="#cb10-218"></a>            <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) {</span>
<span id="cb10-219"><a href="#cb10-219"></a>                <span class="kw">var</span> nt <span class="op">=</span> tags<span class="op">.</span><span class="fu">AddNew</span>(TAG_NAME<span class="op">,</span> TAG_VALUE)<span class="op">;</span></span>
<span id="cb10-220"><a href="#cb10-220"></a>                nt<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span> e<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span></span>
<span id="cb10-221"><a href="#cb10-221"></a>            }</span>
<span id="cb10-222"><a href="#cb10-222"></a>        }</span>
<span id="cb10-223"><a href="#cb10-223"></a>    }</span>
<span id="cb10-224"><a href="#cb10-224"></a>    <span class="cf">if</span> (<span class="op">!</span>DRY_RUN) Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(pkg<span class="op">.</span><span class="at">PackageID</span>)<span class="op">;</span></span>
<span id="cb10-225"><a href="#cb10-225"></a>}</span>
<span id="cb10-226"><a href="#cb10-226"></a></span>
<span id="cb10-227"><a href="#cb10-227"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb10-228"><a href="#cb10-228"></a><span class="in">```</span></span>
<span id="cb10-229"><a href="#cb10-229"></a></span>
<span id="cb10-230"><a href="#cb10-230"></a><span class="fu">### Export All Requirements to CSV</span></span>
<span id="cb10-231"><a href="#cb10-231"></a></span>
<span id="cb10-232"><a href="#cb10-232"></a><span class="in">```{.js filename="Example 12.3 - ExportRequirements_CSV.js – JScript (ES3)"}</span></span>
<span id="cb10-233"><a href="#cb10-233"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb10-234"><a href="#cb10-234"></a><span class="co">// Example 12.3 - ExportRequirements_CSV.js – JScript (ES3)</span></span>
<span id="cb10-235"><a href="#cb10-235"></a><span class="co">// Purpose: Write requirement names and notes to CSV</span></span>
<span id="cb10-236"><a href="#cb10-236"></a><span class="co">// Output: File written to chosen folder</span></span>
<span id="cb10-237"><a href="#cb10-237"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb10-238"><a href="#cb10-238"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb10-239"><a href="#cb10-239"></a></span>
<span id="cb10-240"><a href="#cb10-240"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb10-241"><a href="#cb10-241"></a>    <span class="kw">var</span> shell <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Shell.Application"</span>)<span class="op">;</span></span>
<span id="cb10-242"><a href="#cb10-242"></a>    <span class="kw">var</span> folder <span class="op">=</span> shell<span class="op">.</span><span class="fu">BrowseForFolder</span>(<span class="dv">0</span><span class="op">,</span> <span class="st">"Select output folder"</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb10-243"><a href="#cb10-243"></a>    <span class="cf">if</span> (<span class="op">!</span>folder) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb10-244"><a href="#cb10-244"></a>    <span class="kw">var</span> dir <span class="op">=</span> folder<span class="op">.</span><span class="at">Self</span><span class="op">.</span><span class="at">Path</span><span class="op">;</span></span>
<span id="cb10-245"><a href="#cb10-245"></a></span>
<span id="cb10-246"><a href="#cb10-246"></a>    <span class="kw">var</span> fso <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Scripting.FileSystemObject"</span>)<span class="op">;</span></span>
<span id="cb10-247"><a href="#cb10-247"></a>    <span class="kw">var</span> file <span class="op">=</span> fso<span class="op">.</span><span class="fu">CreateTextFile</span>(dir <span class="op">+</span> <span class="st">"</span><span class="sc">\\</span><span class="st">requirements.csv"</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb10-248"><a href="#cb10-248"></a></span>
<span id="cb10-249"><a href="#cb10-249"></a>    file<span class="op">.</span><span class="fu">WriteLine</span>(<span class="st">"ID,Name,Notes"</span>)<span class="op">;</span></span>
<span id="cb10-250"><a href="#cb10-250"></a></span>
<span id="cb10-251"><a href="#cb10-251"></a>    <span class="kw">var</span> sql <span class="op">=</span> <span class="st">"SELECT Object_ID, Name, Note FROM t_object WHERE Object_Type='Requirement'"</span><span class="op">;</span></span>
<span id="cb10-252"><a href="#cb10-252"></a>    <span class="kw">var</span> xml <span class="op">=</span> Repository<span class="op">.</span><span class="fu">SQLQuery</span>(sql)<span class="op">;</span></span>
<span id="cb10-253"><a href="#cb10-253"></a></span>
<span id="cb10-254"><a href="#cb10-254"></a>    <span class="co">// Parse simple XML rows</span></span>
<span id="cb10-255"><a href="#cb10-255"></a>    <span class="kw">var</span> rows <span class="op">=</span> xml<span class="op">.</span><span class="fu">split</span>(<span class="st">"&lt;Row&gt;"</span>)<span class="op">;</span></span>
<span id="cb10-256"><a href="#cb10-256"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span> i<span class="op">&lt;</span>rows<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb10-257"><a href="#cb10-257"></a>        <span class="kw">var</span> row <span class="op">=</span> rows[i]<span class="op">;</span></span>
<span id="cb10-258"><a href="#cb10-258"></a>        <span class="kw">var</span> id <span class="op">=</span> <span class="fu">between</span>(row<span class="op">,</span><span class="st">"&lt;Object_ID&gt;"</span><span class="op">,</span><span class="st">"&lt;/Object_ID&gt;"</span>)<span class="op">;</span></span>
<span id="cb10-259"><a href="#cb10-259"></a>        <span class="kw">var</span> nm <span class="op">=</span> <span class="fu">between</span>(row<span class="op">,</span><span class="st">"&lt;Name&gt;"</span><span class="op">,</span><span class="st">"&lt;/Name&gt;"</span>)<span class="op">;</span></span>
<span id="cb10-260"><a href="#cb10-260"></a>        <span class="kw">var</span> nt <span class="op">=</span> <span class="fu">between</span>(row<span class="op">,</span><span class="st">"&lt;Note&gt;"</span><span class="op">,</span><span class="st">"&lt;/Note&gt;"</span>)<span class="op">;</span></span>
<span id="cb10-261"><a href="#cb10-261"></a>        file<span class="op">.</span><span class="fu">WriteLine</span>(id <span class="op">+</span> <span class="st">",</span><span class="sc">\"</span><span class="st">"</span> <span class="op">+</span> nm <span class="op">+</span> <span class="st">"</span><span class="sc">\"</span><span class="st">,</span><span class="sc">\"</span><span class="st">"</span> <span class="op">+</span> nt <span class="op">+</span> <span class="st">"</span><span class="sc">\"</span><span class="st">"</span>)<span class="op">;</span></span>
<span id="cb10-262"><a href="#cb10-262"></a>    }</span>
<span id="cb10-263"><a href="#cb10-263"></a></span>
<span id="cb10-264"><a href="#cb10-264"></a>    file<span class="op">.</span><span class="fu">Close</span>()<span class="op">;</span></span>
<span id="cb10-265"><a href="#cb10-265"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Requirements exported."</span>)<span class="op">;</span></span>
<span id="cb10-266"><a href="#cb10-266"></a>}</span>
<span id="cb10-267"><a href="#cb10-267"></a></span>
<span id="cb10-268"><a href="#cb10-268"></a><span class="kw">function</span> <span class="fu">between</span>(h<span class="op">,</span>a<span class="op">,</span>b){ <span class="kw">var</span> i<span class="op">=</span>h<span class="op">.</span><span class="fu">indexOf</span>(a)<span class="op">;</span> <span class="cf">if</span>(i<span class="op">&lt;</span><span class="dv">0</span>) <span class="cf">return</span> <span class="st">""</span><span class="op">;</span> <span class="kw">var</span> j<span class="op">=</span>h<span class="op">.</span><span class="fu">indexOf</span>(b<span class="op">,</span>i<span class="op">+</span>a<span class="op">.</span><span class="at">length</span>)<span class="op">;</span> <span class="cf">return</span> j<span class="op">&lt;</span><span class="dv">0</span><span class="op">?</span><span class="st">""</span><span class="op">:</span>h<span class="op">.</span><span class="fu">substring</span>(i<span class="op">+</span>a<span class="op">.</span><span class="at">length</span><span class="op">,</span>j)<span class="op">;</span> }</span>
<span id="cb10-269"><a href="#cb10-269"></a></span>
<span id="cb10-270"><a href="#cb10-270"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb10-271"><a href="#cb10-271"></a><span class="in">```</span></span>
<span id="cb10-272"><a href="#cb10-272"></a></span>
<span id="cb10-273"><a href="#cb10-273"></a><span class="fu">### Find Orphaned Elements</span></span>
<span id="cb10-274"><a href="#cb10-274"></a></span>
<span id="cb10-275"><a href="#cb10-275"></a><span class="in">```{.js filename="Example 12.4 - FindOrphans.js – JScript (ES3)"}</span></span>
<span id="cb10-276"><a href="#cb10-276"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb10-277"><a href="#cb10-277"></a><span class="co">// Example 12.4 - FindOrphans.js – JScript (ES3)</span></span>
<span id="cb10-278"><a href="#cb10-278"></a><span class="co">// Purpose: Report elements with no connectors</span></span>
<span id="cb10-279"><a href="#cb10-279"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb10-280"><a href="#cb10-280"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb10-281"><a href="#cb10-281"></a></span>
<span id="cb10-282"><a href="#cb10-282"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb10-283"><a href="#cb10-283"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb10-284"><a href="#cb10-284"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb10-285"><a href="#cb10-285"></a></span>
<span id="cb10-286"><a href="#cb10-286"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb10-287"><a href="#cb10-287"></a>    <span class="kw">var</span> orphans<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-288"><a href="#cb10-288"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb10-289"><a href="#cb10-289"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb10-290"><a href="#cb10-290"></a>        <span class="cf">if</span> (e<span class="op">.</span><span class="at">Connectors</span><span class="op">.</span><span class="at">Count</span> <span class="op">==</span> <span class="dv">0</span>) {</span>
<span id="cb10-291"><a href="#cb10-291"></a>            orphans<span class="op">++;</span></span>
<span id="cb10-292"><a href="#cb10-292"></a>            Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Orphan: "</span> <span class="op">+</span> e<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb10-293"><a href="#cb10-293"></a>        }</span>
<span id="cb10-294"><a href="#cb10-294"></a>    }</span>
<span id="cb10-295"><a href="#cb10-295"></a>    Session<span class="op">.</span><span class="fu">Output</span>(<span class="st">"Total orphans: "</span> <span class="op">+</span> orphans)<span class="op">;</span></span>
<span id="cb10-296"><a href="#cb10-296"></a>}</span>
<span id="cb10-297"><a href="#cb10-297"></a></span>
<span id="cb10-298"><a href="#cb10-298"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb10-299"><a href="#cb10-299"></a></span>
<span id="cb10-300"><a href="#cb10-300"></a></span>
<span id="cb10-301"><a href="#cb10-301"></a>### List Elements by Stereotype</span>
<span id="cb10-302"><a href="#cb10-302"></a><span class="vs">```{.js filename="Example 12.5 - ListByStereotype.js – JScript (ES3)"}</span></span>
<span id="cb10-303"><a href="#cb10-303"></a><span class="vs">// -------------------------------------------------------</span></span>
<span id="cb10-304"><a href="#cb10-304"></a><span class="vs">// Example 12.5 - ListByStereotype.js – JScript (ES3)</span></span>
<span id="cb10-305"><a href="#cb10-305"></a><span class="vs">// Purpose: Output all elements with a given stereotype</span></span>
<span id="cb10-306"><a href="#cb10-306"></a><span class="vs">// -------------------------------------------------------</span></span>
<span id="cb10-307"><a href="#cb10-307"></a><span class="vs">!INC Local Scripts.EAConstants-JScript</span></span>
<span id="cb10-308"><a href="#cb10-308"></a></span>
<span id="cb10-309"><a href="#cb10-309"></a><span class="vs">function main() {</span></span>
<span id="cb10-310"><a href="#cb10-310"></a><span class="vs">    var STEREOTYPE = "Capability";</span></span>
<span id="cb10-311"><a href="#cb10-311"></a></span>
<span id="cb10-312"><a href="#cb10-312"></a><span class="vs">    var sql = "SELECT ea_guid, Name FROM t_object WHERE Stereotype='" + STEREOTYPE + "'";</span></span>
<span id="cb10-313"><a href="#cb10-313"></a><span class="vs">    var xml = Repository.SQLQuery(sql);</span></span>
<span id="cb10-314"><a href="#cb10-314"></a></span>
<span id="cb10-315"><a href="#cb10-315"></a><span class="vs">    var rows = xml.split("&lt;Row&gt;");</span></span>
<span id="cb10-316"><a href="#cb10-316"></a><span class="vs">    for (var i=1; i&lt;rows.length; i++) {</span></span>
<span id="cb10-317"><a href="#cb10-317"></a><span class="vs">        var row = rows[i];</span></span>
<span id="cb10-318"><a href="#cb10-318"></a><span class="vs">        var guid = between(row,"&lt;ea_guid&gt;","&lt;/ea_guid&gt;");</span></span>
<span id="cb10-319"><a href="#cb10-319"></a><span class="vs">        var nm = between(row,"&lt;Name&gt;","&lt;/Name&gt;");</span></span>
<span id="cb10-320"><a href="#cb10-320"></a><span class="vs">        Session.Output("Capability: " + nm + " (" + guid + ")");</span></span>
<span id="cb10-321"><a href="#cb10-321"></a><span class="vs">    }</span></span>
<span id="cb10-322"><a href="#cb10-322"></a><span class="vs">}</span></span>
<span id="cb10-323"><a href="#cb10-323"></a><span class="vs">function between(h,a,b){ var i=h.indexOf(a); if(i&lt;0) return ""; var j=h.indexOf(b,i+a.length); return j&lt;0?"":h.substring(i+a.length,j); }</span></span>
<span id="cb10-324"><a href="#cb10-324"></a></span>
<span id="cb10-325"><a href="#cb10-325"></a><span class="vs">main();</span></span>
<span id="cb10-326"><a href="#cb10-326"></a><span class="vs">```</span></span>
<span id="cb10-327"><a href="#cb10-327"></a></span>
<span id="cb10-328"><a href="#cb10-328"></a>### Create a Trace Link Between Selected Elements</span>
<span id="cb10-329"><a href="#cb10-329"></a></span>
<span id="cb10-330"><a href="#cb10-330"></a><span class="vs">```{.js filename="Example 12.6 - CreateTrace.js – JScript (ES3)"}</span></span>
<span id="cb10-331"><a href="#cb10-331"></a><span class="vs">// -------------------------------------------------------</span></span>
<span id="cb10-332"><a href="#cb10-332"></a><span class="vs">// Example 12.6 - CreateTrace.js – JScript (ES3)</span></span>
<span id="cb10-333"><a href="#cb10-333"></a><span class="vs">// Purpose: Create a Realisation connector between two elements selected in a diagram</span></span>
<span id="cb10-334"><a href="#cb10-334"></a><span class="vs">// -------------------------------------------------------</span></span>
<span id="cb10-335"><a href="#cb10-335"></a><span class="vs">!INC Local Scripts.EAConstants-JScript</span></span>
<span id="cb10-336"><a href="#cb10-336"></a></span>
<span id="cb10-337"><a href="#cb10-337"></a><span class="vs">function main() {</span></span>
<span id="cb10-338"><a href="#cb10-338"></a><span class="vs">    var dia = Repository.GetCurrentDiagram();</span></span>
<span id="cb10-339"><a href="#cb10-339"></a><span class="vs">    if (!dia) { Session.Prompt("Open a diagram and select two elements.", promptOK); return; }</span></span>
<span id="cb10-340"><a href="#cb10-340"></a></span>
<span id="cb10-341"><a href="#cb10-341"></a><span class="vs">    if (dia.SelectedObjects.Count != 2) {</span></span>
<span id="cb10-342"><a href="#cb10-342"></a><span class="vs">        Session.Prompt("Select exactly two elements.", promptOK);</span></span>
<span id="cb10-343"><a href="#cb10-343"></a><span class="vs">        return;</span></span>
<span id="cb10-344"><a href="#cb10-344"></a><span class="vs">    }</span></span>
<span id="cb10-345"><a href="#cb10-345"></a></span>
<span id="cb10-346"><a href="#cb10-346"></a><span class="vs">    var el1 = Repository.GetElementByID(dia.SelectedObjects.GetAt(0).ElementID);</span></span>
<span id="cb10-347"><a href="#cb10-347"></a><span class="vs">    var el2 = Repository.GetElementByID(dia.SelectedObjects.GetAt(1).ElementID);</span></span>
<span id="cb10-348"><a href="#cb10-348"></a></span>
<span id="cb10-349"><a href="#cb10-349"></a><span class="vs">    var conn = el1.Connectors.AddNew("", "Realisation");</span></span>
<span id="cb10-350"><a href="#cb10-350"></a><span class="vs">    conn.SupplierID = el2.ElementID;</span></span>
<span id="cb10-351"><a href="#cb10-351"></a><span class="vs">    conn.Update();</span></span>
<span id="cb10-352"><a href="#cb10-352"></a></span>
<span id="cb10-353"><a href="#cb10-353"></a><span class="vs">    Repository.RefreshModelView(el1.PackageID);</span></span>
<span id="cb10-354"><a href="#cb10-354"></a><span class="vs">    Session.Output("Trace created: " + el1.Name + " → " + el2.Name);</span></span>
<span id="cb10-355"><a href="#cb10-355"></a><span class="vs">}</span></span>
<span id="cb10-356"><a href="#cb10-356"></a></span>
<span id="cb10-357"><a href="#cb10-357"></a><span class="vs">main();</span></span>
<span id="cb10-358"><a href="#cb10-358"></a><span class="vs">```</span></span>
<span id="cb10-359"><a href="#cb10-359"></a></span>
<span id="cb10-360"><a href="#cb10-360"></a>### Report Elements Missing Documentation</span>
<span id="cb10-361"><a href="#cb10-361"></a></span>
<span id="cb10-362"><a href="#cb10-362"></a><span class="vs">```{.js filename="Example 12.7 - FindMissingNotes.js – JScript (ES3)"}</span></span>
<span id="cb10-363"><a href="#cb10-363"></a><span class="vs">// -------------------------------------------------------</span></span>
<span id="cb10-364"><a href="#cb10-364"></a><span class="vs">// Example 12.7 - FindMissingNotes.js – JScript (ES3)</span></span>
<span id="cb10-365"><a href="#cb10-365"></a><span class="vs">// Purpose: List elements without notes (documentation)</span></span>
<span id="cb10-366"><a href="#cb10-366"></a><span class="vs">// -------------------------------------------------------</span></span>
<span id="cb10-367"><a href="#cb10-367"></a><span class="vs">!INC Local Scripts.EAConstants-JScript</span></span>
<span id="cb10-368"><a href="#cb10-368"></a></span>
<span id="cb10-369"><a href="#cb10-369"></a><span class="vs">function main() {</span></span>
<span id="cb10-370"><a href="#cb10-370"></a><span class="vs">    var pkg = Repository.GetTreeSelectedPackage();</span></span>
<span id="cb10-371"><a href="#cb10-371"></a><span class="vs">    if (!pkg) return;</span></span>
<span id="cb10-372"><a href="#cb10-372"></a></span>
<span id="cb10-373"><a href="#cb10-373"></a><span class="vs">    var els = pkg.Elements;</span></span>
<span id="cb10-374"><a href="#cb10-374"></a><span class="vs">    for (var i=0; i&lt;els.Count; i++) {</span></span>
<span id="cb10-375"><a href="#cb10-375"></a><span class="vs">        var e = els.GetAt(i);</span></span>
<span id="cb10-376"><a href="#cb10-376"></a><span class="vs">        if (trim(e.Notes) == "") {</span></span>
<span id="cb10-377"><a href="#cb10-377"></a><span class="vs">            Session.Output("Missing notes: " + e.Name);</span></span>
<span id="cb10-378"><a href="#cb10-378"></a><span class="vs">        }</span></span>
<span id="cb10-379"><a href="#cb10-379"></a><span class="vs">    }</span></span>
<span id="cb10-380"><a href="#cb10-380"></a><span class="vs">}</span></span>
<span id="cb10-381"><a href="#cb10-381"></a><span class="vs">function trim(str){ return str==null?"":String(str).replace(/^</span><span class="sc">\s</span><span class="vs">+|</span><span class="sc">\s</span><span class="vs">+$/g,""); }</span></span>
<span id="cb10-382"><a href="#cb10-382"></a></span>
<span id="cb10-383"><a href="#cb10-383"></a><span class="vs">main();</span></span>
<span id="cb10-384"><a href="#cb10-384"></a><span class="vs">```</span></span>
<span id="cb10-385"><a href="#cb10-385"></a></span>
<span id="cb10-386"><a href="#cb10-386"></a>### Export Class Attributes</span>
<span id="cb10-387"><a href="#cb10-387"></a></span>
<span id="cb10-388"><a href="#cb10-388"></a><span class="vs">```{.js filename="Example 12.8 - ExportClassAttributes.js – JScript (ES3)"}</span></span>
<span id="cb10-389"><a href="#cb10-389"></a><span class="vs">// -------------------------------------------------------</span></span>
<span id="cb10-390"><a href="#cb10-390"></a><span class="vs">// Example 12.8 - ExportClassAttributes.js – JScript (ES3)</span></span>
<span id="cb10-391"><a href="#cb10-391"></a><span class="vs">// Purpose: Export attributes of all classes in a package</span></span>
<span id="cb10-392"><a href="#cb10-392"></a><span class="vs">// -------------------------------------------------------</span></span>
<span id="cb10-393"><a href="#cb10-393"></a><span class="vs">!INC Local Scripts.EAConstants-JScript</span></span>
<span id="cb10-394"><a href="#cb10-394"></a></span>
<span id="cb10-395"><a href="#cb10-395"></a><span class="vs">function main() {</span></span>
<span id="cb10-396"><a href="#cb10-396"></a><span class="vs">    var pkg = Repository.GetTreeSelectedPackage();</span></span>
<span id="cb10-397"><a href="#cb10-397"></a><span class="vs">    if (!pkg) return;</span></span>
<span id="cb10-398"><a href="#cb10-398"></a></span>
<span id="cb10-399"><a href="#cb10-399"></a><span class="vs">    var els = pkg.Elements;</span></span>
<span id="cb10-400"><a href="#cb10-400"></a><span class="vs">    for (var i=0; i&lt;els.Count; i++) {</span></span>
<span id="cb10-401"><a href="#cb10-401"></a><span class="vs">        var e = els.GetAt(i);</span></span>
<span id="cb10-402"><a href="#cb10-402"></a><span class="vs">        if (e.Type == "Class") {</span></span>
<span id="cb10-403"><a href="#cb10-403"></a><span class="vs">            var attrs = e.Attributes;</span></span>
<span id="cb10-404"><a href="#cb10-404"></a><span class="vs">            for (var j=0; j&lt;attrs.Count; j++) {</span></span>
<span id="cb10-405"><a href="#cb10-405"></a><span class="vs">                var a = attrs.GetAt(j);</span></span>
<span id="cb10-406"><a href="#cb10-406"></a><span class="vs">                Session.Output("Class " + e.Name + " attr: " + a.Name + ":" + a.Type);</span></span>
<span id="cb10-407"><a href="#cb10-407"></a><span class="vs">            }</span></span>
<span id="cb10-408"><a href="#cb10-408"></a><span class="vs">        }</span></span>
<span id="cb10-409"><a href="#cb10-409"></a><span class="vs">    }</span></span>
<span id="cb10-410"><a href="#cb10-410"></a><span class="vs">}</span></span>
<span id="cb10-411"><a href="#cb10-411"></a></span>
<span id="cb10-412"><a href="#cb10-412"></a><span class="vs">main();</span></span>
<span id="cb10-413"><a href="#cb10-413"></a><span class="vs">```</span></span>
<span id="cb10-414"><a href="#cb10-414"></a></span>
<span id="cb10-415"><a href="#cb10-415"></a>### Bulk <span class="bu">Set</span> Status</span>
<span id="cb10-416"><a href="#cb10-416"></a></span>
<span id="cb10-417"><a href="#cb10-417"></a><span class="vs">```{.js filename="Example 12.9 - BulkSetStatus.js – JScript (ES3)"}</span></span>
<span id="cb10-418"><a href="#cb10-418"></a><span class="vs">// -------------------------------------------------------</span></span>
<span id="cb10-419"><a href="#cb10-419"></a><span class="vs">// Example 12.9 - BulkSetStatus.js – JScript (ES3)</span></span>
<span id="cb10-420"><a href="#cb10-420"></a><span class="vs">// Purpose: Set the Status of all elements in a package</span></span>
<span id="cb10-421"><a href="#cb10-421"></a><span class="vs">// -------------------------------------------------------</span></span>
<span id="cb10-422"><a href="#cb10-422"></a><span class="vs">!INC Local Scripts.EAConstants-JScript</span></span>
<span id="cb10-423"><a href="#cb10-423"></a></span>
<span id="cb10-424"><a href="#cb10-424"></a><span class="vs">function main() {</span></span>
<span id="cb10-425"><a href="#cb10-425"></a><span class="vs">    var DRY_RUN = true;</span></span>
<span id="cb10-426"><a href="#cb10-426"></a><span class="vs">    var NEW_STATUS = "Proposed";</span></span>
<span id="cb10-427"><a href="#cb10-427"></a></span>
<span id="cb10-428"><a href="#cb10-428"></a><span class="vs">    var pkg = Repository.GetTreeSelectedPackage();</span></span>
<span id="cb10-429"><a href="#cb10-429"></a><span class="vs">    if (!pkg) return;</span></span>
<span id="cb10-430"><a href="#cb10-430"></a></span>
<span id="cb10-431"><a href="#cb10-431"></a><span class="vs">    var els = pkg.Elements;</span></span>
<span id="cb10-432"><a href="#cb10-432"></a><span class="vs">    for (var i=0; i&lt;els.Count; i++) {</span></span>
<span id="cb10-433"><a href="#cb10-433"></a><span class="vs">        var e = els.GetAt(i);</span></span>
<span id="cb10-434"><a href="#cb10-434"></a><span class="vs">        if (e.Status != NEW_STATUS) {</span></span>
<span id="cb10-435"><a href="#cb10-435"></a><span class="vs">            Session.Output("Change status: " + e.Name + " → " + NEW_STATUS);</span></span>
<span id="cb10-436"><a href="#cb10-436"></a><span class="vs">            if (!DRY_RUN) { e.Status = NEW_STATUS; e.Update(); }</span></span>
<span id="cb10-437"><a href="#cb10-437"></a><span class="vs">        }</span></span>
<span id="cb10-438"><a href="#cb10-438"></a><span class="vs">    }</span></span>
<span id="cb10-439"><a href="#cb10-439"></a><span class="vs">    if (!DRY_RUN) Repository.RefreshModelView(pkg.PackageID);</span></span>
<span id="cb10-440"><a href="#cb10-440"></a><span class="vs">}</span></span>
<span id="cb10-441"><a href="#cb10-441"></a></span>
<span id="cb10-442"><a href="#cb10-442"></a><span class="vs">main();</span></span>
<span id="cb10-443"><a href="#cb10-443"></a><span class="vs">```</span></span>
<span id="cb10-444"><a href="#cb10-444"></a></span>
<span id="cb10-445"><a href="#cb10-445"></a>### Delete Elements Safely</span>
<span id="cb10-446"><a href="#cb10-446"></a></span>
<span id="cb10-447"><a href="#cb10-447"></a><span class="vs">```{.js filename="Example 12.10 - SafeDelete.js – JScript (ES3)"}</span></span>
<span id="cb10-448"><a href="#cb10-448"></a><span class="vs">// -------------------------------------------------------</span></span>
<span id="cb10-449"><a href="#cb10-449"></a><span class="vs">// Example 12.10 - SafeDelete.js – JScript (ES3)</span></span>
<span id="cb10-450"><a href="#cb10-450"></a><span class="vs">// Purpose: Delete all elements of a given type in a package</span></span>
<span id="cb10-451"><a href="#cb10-451"></a><span class="vs">// Safety: DRY_RUN = true by default</span></span>
<span id="cb10-452"><a href="#cb10-452"></a><span class="vs">// -------------------------------------------------------</span></span>
<span id="cb10-453"><a href="#cb10-453"></a><span class="vs">!INC Local Scripts.EAConstants-JScript</span></span>
<span id="cb10-454"><a href="#cb10-454"></a></span>
<span id="cb10-455"><a href="#cb10-455"></a><span class="vs">function main() {</span></span>
<span id="cb10-456"><a href="#cb10-456"></a><span class="vs">    var DRY_RUN = true;</span></span>
<span id="cb10-457"><a href="#cb10-457"></a><span class="vs">    var TYPE_FILTER = "UseCase";</span></span>
<span id="cb10-458"><a href="#cb10-458"></a></span>
<span id="cb10-459"><a href="#cb10-459"></a><span class="vs">    var pkg = Repository.GetTreeSelectedPackage();</span></span>
<span id="cb10-460"><a href="#cb10-460"></a><span class="vs">    if (!pkg) return;</span></span>
<span id="cb10-461"><a href="#cb10-461"></a></span>
<span id="cb10-462"><a href="#cb10-462"></a><span class="vs">    var els = pkg.Elements;</span></span>
<span id="cb10-463"><a href="#cb10-463"></a><span class="vs">    // Iterate backwards when deleting</span></span>
<span id="cb10-464"><a href="#cb10-464"></a><span class="vs">    for (var i=els.Count-1; i&gt;=0; i--) {</span></span>
<span id="cb10-465"><a href="#cb10-465"></a><span class="vs">        var e = els.GetAt(i);</span></span>
<span id="cb10-466"><a href="#cb10-466"></a><span class="vs">        if (e.Type == TYPE_FILTER) {</span></span>
<span id="cb10-467"><a href="#cb10-467"></a><span class="vs">            Session.Output("Would delete: " + e.Name);</span></span>
<span id="cb10-468"><a href="#cb10-468"></a><span class="vs">            if (!DRY_RUN) {</span></span>
<span id="cb10-469"><a href="#cb10-469"></a><span class="vs">                els.DeleteAt(i, false); // false = don't refresh each time</span></span>
<span id="cb10-470"><a href="#cb10-470"></a><span class="vs">            }</span></span>
<span id="cb10-471"><a href="#cb10-471"></a><span class="vs">        }</span></span>
<span id="cb10-472"><a href="#cb10-472"></a><span class="vs">    }</span></span>
<span id="cb10-473"><a href="#cb10-473"></a><span class="vs">    if (!DRY_RUN) {</span></span>
<span id="cb10-474"><a href="#cb10-474"></a><span class="vs">        pkg.Update();</span></span>
<span id="cb10-475"><a href="#cb10-475"></a><span class="vs">        Repository.RefreshModelView(pkg.PackageID);</span></span>
<span id="cb10-476"><a href="#cb10-476"></a><span class="vs">    }</span></span>
<span id="cb10-477"><a href="#cb10-477"></a><span class="vs">}</span></span>
<span id="cb10-478"><a href="#cb10-478"></a></span>
<span id="cb10-479"><a href="#cb10-479"></a><span class="vs">main();</span></span>
<span id="cb10-480"><a href="#cb10-480"></a><span class="vs">```</span></span>
<span id="cb10-481"><a href="#cb10-481"></a></span>
<span id="cb10-482"><a href="#cb10-482"></a>## Summary</span>
<span id="cb10-483"><a href="#cb10-483"></a></span>
<span id="cb10-484"><a href="#cb10-484"></a>This cookbook chapter delivers <span class="op">**</span>ready<span class="op">-</span>to<span class="op">-</span>use recipes<span class="op">**:</span></span>
<span id="cb10-485"><a href="#cb10-485"></a></span>
<span id="cb10-486"><a href="#cb10-486"></a><span class="op">-</span> Bulk <span class="fu">editing</span> (<span class="fl">11.1</span><span class="op">,</span> <span class="fl">11.2</span><span class="op">,</span> <span class="fl">11.9</span><span class="op">,</span> <span class="fl">11.10</span>)<span class="op">.</span></span>
<span id="cb10-487"><a href="#cb10-487"></a></span>
<span id="cb10-488"><a href="#cb10-488"></a><span class="op">-</span> <span class="fu">Reporting</span> (<span class="fl">11.4</span><span class="op">,</span> <span class="fl">11.5</span><span class="op">,</span> <span class="fl">11.7</span><span class="op">,</span> <span class="fl">11.8</span>)<span class="op">.</span></span>
<span id="cb10-489"><a href="#cb10-489"></a></span>
<span id="cb10-490"><a href="#cb10-490"></a><span class="op">-</span> Traceability <span class="fu">utilities</span> (<span class="fl">11.6</span>)<span class="op">.</span></span>
<span id="cb10-491"><a href="#cb10-491"></a></span>
<span id="cb10-492"><a href="#cb10-492"></a><span class="op">-</span> Import<span class="op">/</span><span class="im">export</span> <span class="fu">utilities</span> (<span class="fl">11.3</span>)<span class="op">.</span></span>
<span id="cb10-493"><a href="#cb10-493"></a></span>
<span id="cb10-494"><a href="#cb10-494"></a>Each follows the <span class="op">**</span>constraints <span class="kw">of</span> EA’s JScript engine<span class="op">**</span> (ES3 only<span class="op">,</span></span>
<span id="cb10-495"><a href="#cb10-495"></a>ActiveX <span class="cf">for</span> files<span class="op">,</span> <span class="op">.</span><span class="at">Count</span><span class="op">/.</span><span class="fu">GetAt</span>() <span class="cf">for</span> collections)<span class="op">.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>