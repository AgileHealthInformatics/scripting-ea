<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Chapter 9: Imports &amp; Exports – Scripting Sparx Enterprise Architect: A Practical Handbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./11-System.Object[].html" rel="next">
<link href="./09-System.Object[].html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b4ddde2c4c77ed14ccfa95278770da4f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./10-System.Object[].html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Chapter 9: Imports &amp; Exports</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Scripting Sparx Enterprise Architect: A Practical Handbook</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Scripting Sparx Enterprise Architect</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Chapter 1: Why Script EA?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Chapter 2: Automation Landscape</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Chapter 3: Getting Started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Chapter 4: API Essentials</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Chapter 5: Inside EA with JScript</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Chapter 6: External Automation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Chapter 7: Script Design Patterns</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Chapter 8: Object Details</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-System.Object[].html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Chapter 9: Imports &amp; Exports</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Chapter 10: MDG-Aware Scripting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Chapter 11: Governance Scripts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Chapter 12: Cookbook of Examples</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Chapter 13: Why AI Helps</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Chapter 14: Prompt Engineering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Chapter 15: AI Refactoring Partner</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Chapter 16: AI in Daily Workflow</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Chapter 17: Performance &amp; Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Chapter 18: Integrating with Workflows</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Chapter 19: Add-ins vs Scripts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Chapter 20: Troubleshooting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Chapter 21: Reference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Appendix A: Scripting Constraints</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Appendix B: External Automation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Appendix C: Glossary of Terms</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Appendix D: Quick Reference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27-System.Object[].html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Appendix E: External Automation Setup</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#why-imports-matter" id="toc-why-imports-matter" class="nav-link active" data-scroll-target="#why-imports-matter"><span class="header-section-number">10.1</span> Why Imports Matter</a></li>
  <li><a href="#why-exports-matter" id="toc-why-exports-matter" class="nav-link" data-scroll-target="#why-exports-matter"><span class="header-section-number">10.2</span> Why Exports Matter</a></li>
  <li><a href="#the-round-trip-challenge" id="toc-the-round-trip-challenge" class="nav-link" data-scroll-target="#the-round-trip-challenge"><span class="header-section-number">10.3</span> The Round-Trip Challenge</a></li>
  <li><a href="#common-pitfalls" id="toc-common-pitfalls" class="nav-link" data-scroll-target="#common-pitfalls"><span class="header-section-number">10.4</span> Common Pitfalls</a></li>
  <li><a href="#choosing-a-format" id="toc-choosing-a-format" class="nav-link" data-scroll-target="#choosing-a-format"><span class="header-section-number">10.5</span> Choosing a Format</a></li>
  <li><a href="#guids-keys-and-identity" id="toc-guids-keys-and-identity" class="nav-link" data-scroll-target="#guids-keys-and-identity"><span class="header-section-number">10.6</span> GUIDs, Keys, and Identity</a></li>
  <li><a href="#curated-imports" id="toc-curated-imports" class="nav-link" data-scroll-target="#curated-imports"><span class="header-section-number">10.7</span> Curated Imports</a></li>
  <li><a href="#safety-in-exports" id="toc-safety-in-exports" class="nav-link" data-scroll-target="#safety-in-exports"><span class="header-section-number">10.8</span> Safety in Exports</a></li>
  <li><a href="#integrating-importsexports-into-workflows" id="toc-integrating-importsexports-into-workflows" class="nav-link" data-scroll-target="#integrating-importsexports-into-workflows"><span class="header-section-number">10.9</span> Integrating Imports/Exports into Workflows</a></li>
  <li><a href="#what-youll-use" id="toc-what-youll-use" class="nav-link" data-scroll-target="#what-youll-use"><span class="header-section-number">10.10</span> What you’ll use</a>
  <ul class="collapse">
  <li><a href="#csv-round-trip-in-ea" id="toc-csv-round-trip-in-ea" class="nav-link" data-scroll-target="#csv-round-trip-in-ea"><span class="header-section-number">10.10.1</span> CSV Round-Trip (in-EA)</a></li>
  <li><a href="#export-elements-recursive-to-csv" id="toc-export-elements-recursive-to-csv" class="nav-link" data-scroll-target="#export-elements-recursive-to-csv"><span class="header-section-number">10.10.2</span> Export elements (recursive) to CSV</a></li>
  <li><a href="#apply-curated-csv-to-update-elements" id="toc-apply-curated-csv-to-update-elements" class="nav-link" data-scroll-target="#apply-curated-csv-to-update-elements"><span class="header-section-number">10.10.3</span> Apply curated CSV to update elements</a></li>
  <li><a href="#excel-via-com-in-ea" id="toc-excel-via-com-in-ea" class="nav-link" data-scroll-target="#excel-via-com-in-ea"><span class="header-section-number">10.10.4</span> Excel via COM (in-EA)</a></li>
  <li><a href="#json-pipelines" id="toc-json-pipelines" class="nav-link" data-scroll-target="#json-pipelines"><span class="header-section-number">10.10.5</span> JSON Pipelines</a></li>
  <li><a href="#import-json-externally-python" id="toc-import-json-externally-python" class="nav-link" data-scroll-target="#import-json-externally-python"><span class="header-section-number">10.10.6</span> Import JSON externally (Python)</a></li>
  </ul></li>
  <li><a href="#managing-guids-avoiding-duplicates" id="toc-managing-guids-avoiding-duplicates" class="nav-link" data-scroll-target="#managing-guids-avoiding-duplicates"><span class="header-section-number">10.11</span> Managing GUIDs &amp; Avoiding Duplicates</a></li>
  <li><a href="#scaling-up-performance" id="toc-scaling-up-performance" class="nav-link" data-scroll-target="#scaling-up-performance"><span class="header-section-number">10.12</span> Scaling Up (Performance)</a></li>
  <li><a href="#safety-checklist" id="toc-safety-checklist" class="nav-link" data-scroll-target="#safety-checklist"><span class="header-section-number">10.13</span> Safety Checklist</a></li>
  <li><a href="#what-to-use-when" id="toc-what-to-use-when" class="nav-link" data-scroll-target="#what-to-use-when"><span class="header-section-number">10.14</span> What to use when</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Chapter 9: Imports &amp; Exports</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>One of the first serious challenges you encounter when scripting Enterprise Architect is how to move data in and out of the repository. A model is rarely a self-contained island. Requirements may start life in Jira or Excel. Application inventories may be stored in a CMDB. Metadata may need to be exported to registries or analytics platforms. Architects frequently face the practical need to <strong>import content into EA</strong> or <strong>export content from EA</strong> to other systems.</p>
<p>This chapter focuses on imports and exports — arguably the most common automation tasks in EA. At first glance, they may seem trivial: read from CSV, create elements, write back. But once you attempt real-world imports and exports, you quickly discover subtle complexities: handling GUIDs, avoiding duplicates, ensuring round-trip consistency, and dealing with encoding.</p>
<p>Understanding these complexities is essential. A poorly designed import script can flood your repository with duplicates. A naïve export may omit critical metadata or lose relationships. The goal of this chapter is to build robust patterns for imports and exports that are safe, repeatable, and auditable.</p>
<section id="why-imports-matter" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="why-imports-matter"><span class="header-section-number">10.1</span> Why Imports Matter</h2>
<p>Imports are the way EA connects to upstream sources of truth. In many organisations, architects are not the ones who originate requirements, applications, or datasets. Those live in other systems. EA is where they are curated, connected, and visualised.</p>
<p>For example:</p>
<ul>
<li><p>Requirements authored in Jira need to be imported into EA for traceability.</p></li>
<li><p>Application inventories stored in Excel need to be imported as elements with tagged values.</p></li>
<li><p>Data elements defined in a registry need to be imported into EA’s logical data model.</p></li>
</ul>
<p>Without imports, EA risks becoming a disconnected silo. With imports, it becomes part of the wider enterprise information flow.</p>
</section>
<section id="why-exports-matter" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="why-exports-matter"><span class="header-section-number">10.2</span> Why Exports Matter</h2>
<p>The opposite direction is just as important. Many stakeholders do not use EA directly. They expect to see outputs in Excel, JSON, Confluence, or dashboards. Exports make EA’s content consumable.</p>
<p>For example:</p>
<ul>
<li><p>Exporting element inventories to CSV for analysis in Excel.</p></li>
<li><p>Exporting model metadata to JSON for loading into a data catalog.</p></li>
<li><p>Exporting governance reports to Confluence for project teams.</p></li>
</ul>
<p>Exports also serve as safety tools: before running a script that modifies content, export a snapshot for comparison.</p>
</section>
<section id="the-round-trip-challenge" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="the-round-trip-challenge"><span class="header-section-number">10.3</span> The Round-Trip Challenge</h2>
<p>In theory, import and export should be symmetrical: export, modify externally, import back. In practice, this is hard because of <strong>identity</strong>. How do you know that a row in CSV corresponds to the same element in EA?</p>
<p>If you match by name, duplicates are inevitable. If you match by ID, the ID may change across repositories. The robust solution is to use <strong>GUIDs</strong>. Every element, package, and connector in EA has a GUID. By exporting and re-importing GUIDs, you can round-trip reliably.</p>
<p>This chapter emphasises the importance of GUID handling in all import/export scripts.</p>
</section>
<section id="common-pitfalls" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="common-pitfalls"><span class="header-section-number">10.4</span> Common Pitfalls</h2>
<p>Beginners often stumble into a few traps when writing import/export scripts:</p>
<ul>
<li><p><strong>Duplicate creation</strong>: forgetting to check if an element already exists before creating a new one.</p></li>
<li><p><strong>Lost metadata</strong>: exporting only names, not tags, stereotypes, or relationships.</p></li>
<li><p><strong>Encoding errors</strong>: CSV exports losing accented characters due to ANSI encoding.</p></li>
<li><p><strong>Uncontrolled scope</strong>: importing thousands of rows without dry-run or logging.</p></li>
</ul>
<p>Each of these pitfalls can damage model integrity. The patterns in this chapter address them with checks, dry-runs, and logs.</p>
</section>
<section id="choosing-a-format" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="choosing-a-format"><span class="header-section-number">10.5</span> Choosing a Format</h2>
<p>The two most common formats for imports and exports are <strong>CSV</strong> and <strong>JSON</strong>.</p>
<ul>
<li><p><strong>CSV</strong> is simple, widely supported, and easy to review in Excel. It works best for tabular data: lists of requirements, applications, or tagged values.</p></li>
<li><p><strong>JSON</strong> is richer, supporting nested structures and hierarchies. It is more natural for hierarchical data, such as package trees or nested attributes.</p></li>
</ul>
<p>EA scripts can handle CSV easily using FileSystemObject. JSON is trickier because JScript lacks a parser, but you can still generate JSON strings. For parsing JSON, external automation (Python, C#) is usually better.</p>
</section>
<section id="guids-keys-and-identity" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="guids-keys-and-identity"><span class="header-section-number">10.6</span> GUIDs, Keys, and Identity</h2>
<p>As mentioned earlier, GUIDs are the key to round-trip imports/exports. Best practice is:</p>
<ul>
<li><p><strong>Always export the GUID</strong> alongside names and types.</p></li>
<li><p><strong>When importing</strong>, check if the GUID exists in EA. If yes, update. If no, create.</p></li>
<li><p><strong>If GUIDs are absent</strong> (e.g., external system), generate your own external ID tag (e.g., JiraKey). Use this as the round-trip identity.</p></li>
</ul>
<p>Scripts should never rely on element names alone for identity.</p>
</section>
<section id="curated-imports" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="curated-imports"><span class="header-section-number">10.7</span> Curated Imports</h2>
<p>Another best practice is to <strong>curate before commit</strong>. Instead of blindly importing all rows, first log what would be created or updated. Write the proposed changes to a CSV, review them, then re-run the script with DRY_RUN = false.</p>
<p>This two-phase approach mirrors the “Curate-then-Write” pattern described in Chapter 7. It prevents surprises and builds trust in automation.</p>
</section>
<section id="safety-in-exports" class="level2" data-number="10.8">
<h2 data-number="10.8" class="anchored" data-anchor-id="safety-in-exports"><span class="header-section-number">10.8</span> Safety in Exports</h2>
<p>Exports may feel safer than imports — after all, they don’t change EA. But they come with their own risks. An incomplete export can give stakeholders a misleading picture. An unfiltered export may expose sensitive data.</p>
<p>Safe export practices include:</p>
<ul>
<li><p>Logging the scope of what was exported.</p></li>
<li><p>Including metadata fields like GUIDs, stereotypes, and tags.</p></li>
<li><p>Confirming encoding (e.g., use external Python for UTF-8).</p></li>
</ul>
</section>
<section id="integrating-importsexports-into-workflows" class="level2" data-number="10.9">
<h2 data-number="10.9" class="anchored" data-anchor-id="integrating-importsexports-into-workflows"><span class="header-section-number">10.9</span> Integrating Imports/Exports into Workflows</h2>
<p>Imports and exports are rarely ends in themselves. They usually form part of a wider workflow. For example:</p>
<ol type="1">
<li><p>Export application inventory from EA to CSV.</p></li>
<li><p>Send CSV to data owners for updates.</p></li>
<li><p>Import CSV back into EA with changes.</p></li>
</ol>
<p>Or:</p>
<ol type="1">
<li><p>Import requirements from Jira.</p></li>
<li><p>Trace them to capabilities and applications in EA.</p></li>
<li><p>Export traceability report to Confluence.</p></li>
</ol>
<p>Thinking of imports/exports as workflow steps encourages you to script them with logging, curation, and repeatability.</p>
</section>
<section id="what-youll-use" class="level2" data-number="10.10">
<h2 data-number="10.10" class="anchored" data-anchor-id="what-youll-use"><span class="header-section-number">10.10</span> What you’ll use</h2>
<p>Inside EA: JScript (ES3), FileSystemObject, Excel.Application (ActiveX), EA API.</p>
<p>Outside EA: Python (pywin32) for JSON parsing and advanced integrations.</p>
<p>We’ll assume you have the <strong>Shared Helpers</strong> from Chapter 6 (_Common.Helpers) available: ensureOutputTab, browseForFolder, CsvWriter, string helpers, and nowMs().</p>
<section id="csv-round-trip-in-ea" class="level3" data-number="10.10.1">
<h3 data-number="10.10.1" class="anchored" data-anchor-id="csv-round-trip-in-ea"><span class="header-section-number">10.10.1</span> CSV Round-Trip (in-EA)</h3>
<p>CSV is the simplest review format for non-technical stakeholders. The safest pattern is <strong>two-phase</strong>: export a proposal → humans curate in Excel → apply only rows marked “YES”.</p>
</section>
<section id="export-elements-recursive-to-csv" class="level3" data-number="10.10.2">
<h3 data-number="10.10.2" class="anchored" data-anchor-id="export-elements-recursive-to-csv"><span class="header-section-number">10.10.2</span> Export elements (recursive) to CSV</h3>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 9.1 - - ExportCSV_PackageRecursive.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" data-filename="Example 9.1 - - ExportCSV_PackageRecursive.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">// Example 9.1 - ExportCSV_PackageRecursive.js – JScript (ES3)</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">// Purpose: Export elements of the selected package (and subpackages) to CSV</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">// Usage: Select a package in the Project Browser → run script</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">// Output: directory-only chooser; filename auto-derived</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">// Assumptions:</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">//   - ES3 only; EA collections use Count/GetAt(i)</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">//   - Includes key fields for round-trip (IDs, GUIDs, parent package)</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">// Dependencies: _Common.Helpers</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="op">!</span>INC _Common<span class="op">.</span><span class="at">Helpers</span></span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb1-15"><a href="#cb1-15"></a>    <span class="kw">var</span> TAB <span class="op">=</span> <span class="st">"ExportCSV"</span><span class="op">;</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>    <span class="fu">ensureOutputTab</span>(TAB)<span class="op">;</span></span>
<span id="cb1-17"><a href="#cb1-17"></a></span>
<span id="cb1-18"><a href="#cb1-18"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package to export."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb1-20"><a href="#cb1-20"></a></span>
<span id="cb1-21"><a href="#cb1-21"></a>    <span class="kw">var</span> outDir <span class="op">=</span> <span class="fu">browseForFolder</span>(<span class="st">"Select output folder (CSV)"</span>)<span class="op">;</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>    <span class="cf">if</span> (<span class="op">!</span>outDir) { <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Cancelled."</span>)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb1-23"><a href="#cb1-23"></a></span>
<span id="cb1-24"><a href="#cb1-24"></a>    <span class="kw">var</span> stamp <span class="op">=</span> (<span class="kw">new</span> <span class="bu">Date</span>())<span class="op">.</span><span class="fu">getTime</span>()<span class="op">;</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>    <span class="kw">var</span> path  <span class="op">=</span> outDir <span class="op">+</span> <span class="st">"</span><span class="sc">\\</span><span class="st">export_elements_"</span> <span class="op">+</span> <span class="fu">safeName</span>(pkg<span class="op">.</span><span class="at">Name</span>) <span class="op">+</span> <span class="st">"_"</span> <span class="op">+</span> stamp <span class="op">+</span> <span class="st">".csv"</span><span class="op">;</span></span>
<span id="cb1-26"><a href="#cb1-26"></a>    <span class="kw">var</span> csv   <span class="op">=</span> <span class="kw">new</span> <span class="fu">CsvWriter</span>(path)<span class="op">;</span></span>
<span id="cb1-27"><a href="#cb1-27"></a>    csv<span class="op">.</span><span class="fu">writeHeader</span>(<span class="st">"Apply,ElementID,GUID,PackageID,PackageName,Name,Type,Stereotype,Status,Notes"</span>)<span class="op">;</span></span>
<span id="cb1-28"><a href="#cb1-28"></a></span>
<span id="cb1-29"><a href="#cb1-29"></a>    <span class="kw">var</span> count <span class="op">=</span> <span class="fu">walkPackage</span>(pkg<span class="op">,</span> <span class="kw">function</span>(el<span class="op">,</span> p) {</span>
<span id="cb1-30"><a href="#cb1-30"></a>        csv<span class="op">.</span><span class="fu">writeRow</span>([</span>
<span id="cb1-31"><a href="#cb1-31"></a>            <span class="st">"NO"</span><span class="op">,</span>                    <span class="co">// Apply = NO by default (curate later)</span></span>
<span id="cb1-32"><a href="#cb1-32"></a>            el<span class="op">.</span><span class="at">ElementID</span><span class="op">,</span></span>
<span id="cb1-33"><a href="#cb1-33"></a>            el<span class="op">.</span><span class="at">ElementGUID</span><span class="op">,</span></span>
<span id="cb1-34"><a href="#cb1-34"></a>            p<span class="op">.</span><span class="at">PackageID</span><span class="op">,</span></span>
<span id="cb1-35"><a href="#cb1-35"></a>            p<span class="op">.</span><span class="at">Name</span><span class="op">,</span></span>
<span id="cb1-36"><a href="#cb1-36"></a>            el<span class="op">.</span><span class="at">Name</span><span class="op">,</span></span>
<span id="cb1-37"><a href="#cb1-37"></a>            el<span class="op">.</span><span class="at">Type</span><span class="op">,</span></span>
<span id="cb1-38"><a href="#cb1-38"></a>            <span class="bu">String</span>(el<span class="op">.</span><span class="at">Stereotype</span><span class="op">||</span><span class="st">""</span>)<span class="op">,</span></span>
<span id="cb1-39"><a href="#cb1-39"></a>            <span class="bu">String</span>(el<span class="op">.</span><span class="at">Status</span><span class="op">||</span><span class="st">""</span>)<span class="op">,</span></span>
<span id="cb1-40"><a href="#cb1-40"></a>            <span class="fu">sanitize</span>(el<span class="op">.</span><span class="at">Notes</span>)</span>
<span id="cb1-41"><a href="#cb1-41"></a>        ])<span class="op">;</span></span>
<span id="cb1-42"><a href="#cb1-42"></a>    })<span class="op">;</span></span>
<span id="cb1-43"><a href="#cb1-43"></a></span>
<span id="cb1-44"><a href="#cb1-44"></a>    csv<span class="op">.</span><span class="fu">close</span>()<span class="op">;</span></span>
<span id="cb1-45"><a href="#cb1-45"></a>    <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Exported "</span> <span class="op">+</span> count <span class="op">+</span> <span class="st">" element(s) → "</span> <span class="op">+</span> path)<span class="op">;</span></span>
<span id="cb1-46"><a href="#cb1-46"></a>}</span>
<span id="cb1-47"><a href="#cb1-47"></a></span>
<span id="cb1-48"><a href="#cb1-48"></a><span class="kw">function</span> <span class="fu">walkPackage</span>(pkg<span class="op">,</span> onElement) {</span>
<span id="cb1-49"><a href="#cb1-49"></a>    <span class="kw">var</span> n <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> i<span class="op">;</span></span>
<span id="cb1-50"><a href="#cb1-50"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb1-51"><a href="#cb1-51"></a>    <span class="cf">for</span> (i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb1-52"><a href="#cb1-52"></a>        <span class="fu">onElement</span>(els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">,</span> pkg)<span class="op">;</span> n<span class="op">++;</span></span>
<span id="cb1-53"><a href="#cb1-53"></a>    }</span>
<span id="cb1-54"><a href="#cb1-54"></a>    <span class="kw">var</span> kids <span class="op">=</span> pkg<span class="op">.</span><span class="at">Packages</span><span class="op">;</span></span>
<span id="cb1-55"><a href="#cb1-55"></a>    <span class="cf">for</span> (i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>kids<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb1-56"><a href="#cb1-56"></a>        n <span class="op">+=</span> <span class="fu">walkPackage</span>(kids<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">,</span> onElement)<span class="op">;</span></span>
<span id="cb1-57"><a href="#cb1-57"></a>    }</span>
<span id="cb1-58"><a href="#cb1-58"></a>    <span class="cf">return</span> n<span class="op">;</span></span>
<span id="cb1-59"><a href="#cb1-59"></a>}</span>
<span id="cb1-60"><a href="#cb1-60"></a></span>
<span id="cb1-61"><a href="#cb1-61"></a><span class="kw">function</span> <span class="fu">sanitize</span>(s) {</span>
<span id="cb1-62"><a href="#cb1-62"></a>    <span class="co">// Compress newlines for CSV readability (optional)</span></span>
<span id="cb1-63"><a href="#cb1-63"></a>    s <span class="op">=</span> <span class="bu">String</span>(s<span class="op">||</span><span class="st">""</span>)<span class="op">;</span></span>
<span id="cb1-64"><a href="#cb1-64"></a>    s <span class="op">=</span> s<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\r\n</span><span class="ss">/g</span><span class="op">,</span> <span class="st">" "</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\n</span><span class="ss">/g</span><span class="op">,</span> <span class="st">" "</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\r</span><span class="ss">/g</span><span class="op">,</span> <span class="st">" "</span>)<span class="op">;</span></span>
<span id="cb1-65"><a href="#cb1-65"></a>    <span class="cf">return</span> s<span class="op">;</span></span>
<span id="cb1-66"><a href="#cb1-66"></a>}</span>
<span id="cb1-67"><a href="#cb1-67"></a><span class="kw">function</span> <span class="fu">safeName</span>(s) { <span class="cf">return</span> <span class="bu">String</span>(s<span class="op">||</span><span class="st">""</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">[^A-Za-z0-9_]+</span><span class="ss">/g</span><span class="op">,</span> <span class="st">"_"</span>)<span class="op">;</span> }</span>
<span id="cb1-68"><a href="#cb1-68"></a></span>
<span id="cb1-69"><a href="#cb1-69"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="apply-curated-csv-to-update-elements" class="level3" data-number="10.10.3">
<h3 data-number="10.10.3" class="anchored" data-anchor-id="apply-curated-csv-to-update-elements"><span class="header-section-number">10.10.3</span> Apply curated CSV to update elements</h3>
<p>CSV edited by humans is brittle; we keep parsing simple and only support a few controlled changes. We’ll update Name, Stereotype, Status, and optionally one tag<strong>ged value</strong> (e.g., Owner). Only rows with Apply=YES will execute.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 9.2 - ImportCSV_UpdateElements.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" data-filename="Example 9.2 - ImportCSV_UpdateElements.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">// Example 9.2 - ImportCSV_UpdateElements.js – JScript (ES3)</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">// Purpose: Apply curated updates to elements from a CSV (round-trip)</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">// Usage: Place curated CSV in a folder → run script → pick folder</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">// Safety: Only Apply=YES rows are executed; ElementID/GUID matching</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">// Dependencies: _Common.Helpers</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="op">!</span>INC _Common<span class="op">.</span><span class="at">Helpers</span></span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb2-12"><a href="#cb2-12"></a>    <span class="kw">var</span> TAB <span class="op">=</span> <span class="st">"ImportCSV"</span><span class="op">;</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>    <span class="fu">ensureOutputTab</span>(TAB)<span class="op">;</span></span>
<span id="cb2-14"><a href="#cb2-14"></a></span>
<span id="cb2-15"><a href="#cb2-15"></a>    <span class="kw">var</span> dir <span class="op">=</span> <span class="fu">browseForFolder</span>(<span class="st">"Select folder containing curated CSV (export_elements_*.csv)"</span>)<span class="op">;</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>    <span class="cf">if</span> (<span class="op">!</span>dir) { <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Cancelled."</span>)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a>    <span class="kw">var</span> file <span class="op">=</span> <span class="fu">newestCsv</span>(dir<span class="op">,</span> <span class="st">"export_elements_"</span>)<span class="op">;</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>    <span class="cf">if</span> (<span class="op">!</span>file) { <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"No matching CSV found."</span>)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb2-20"><a href="#cb2-20"></a>    <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Applying from: "</span> <span class="op">+</span> file<span class="op">.</span><span class="at">Path</span>)<span class="op">;</span></span>
<span id="cb2-21"><a href="#cb2-21"></a></span>
<span id="cb2-22"><a href="#cb2-22"></a>    <span class="kw">var</span> fso <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Scripting.FileSystemObject"</span>)<span class="op">;</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>    <span class="kw">var</span> ts  <span class="op">=</span> fso<span class="op">.</span><span class="fu">OpenTextFile</span>(file<span class="op">.</span><span class="at">Path</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span> <span class="co">// ForReading</span></span>
<span id="cb2-24"><a href="#cb2-24"></a>    <span class="cf">if</span> (<span class="op">!</span>ts<span class="op">.</span><span class="at">AtEndOfStream</span>) ts<span class="op">.</span><span class="fu">ReadLine</span>()<span class="op">;</span>     <span class="co">// skip header</span></span>
<span id="cb2-25"><a href="#cb2-25"></a></span>
<span id="cb2-26"><a href="#cb2-26"></a>    <span class="kw">var</span> applied<span class="op">=</span><span class="dv">0</span><span class="op">,</span> considered<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-27"><a href="#cb2-27"></a>    <span class="cf">while</span> (<span class="op">!</span>ts<span class="op">.</span><span class="at">AtEndOfStream</span>) {</span>
<span id="cb2-28"><a href="#cb2-28"></a>        <span class="kw">var</span> line  <span class="op">=</span> ts<span class="op">.</span><span class="fu">ReadLine</span>()<span class="op">;</span></span>
<span id="cb2-29"><a href="#cb2-29"></a>        <span class="cf">if</span> (<span class="fu">trim</span>(line) <span class="op">===</span> <span class="st">""</span>) <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb2-30"><a href="#cb2-30"></a>        <span class="kw">var</span> cells <span class="op">=</span> <span class="fu">splitCsvLine</span>(line)<span class="op">;</span>       <span class="co">// naive split (works if reviewers avoided stray commas)</span></span>
<span id="cb2-31"><a href="#cb2-31"></a></span>
<span id="cb2-32"><a href="#cb2-32"></a>        <span class="co">// Expected header: Apply,ElementID,GUID,PackageID,PackageName,Name,Type,Stereotype,Status,Notes</span></span>
<span id="cb2-33"><a href="#cb2-33"></a>        <span class="kw">var</span> apply    <span class="op">=</span> <span class="fu">trim</span>(<span class="fu">getCell</span>(cells<span class="op">,</span><span class="dv">0</span>))<span class="op">;</span></span>
<span id="cb2-34"><a href="#cb2-34"></a>        <span class="kw">var</span> elementID<span class="op">=</span> <span class="pp">parseInt</span>(<span class="fu">getCell</span>(cells<span class="op">,</span><span class="dv">1</span>)<span class="op">,</span><span class="dv">10</span>)<span class="op">;</span></span>
<span id="cb2-35"><a href="#cb2-35"></a>        <span class="kw">var</span> guid     <span class="op">=</span> <span class="fu">trim</span>(<span class="fu">getCell</span>(cells<span class="op">,</span><span class="dv">2</span>))<span class="op">;</span></span>
<span id="cb2-36"><a href="#cb2-36"></a>        <span class="kw">var</span> newName  <span class="op">=</span> <span class="fu">trim</span>(<span class="fu">getCell</span>(cells<span class="op">,</span><span class="dv">5</span>))<span class="op">;</span></span>
<span id="cb2-37"><a href="#cb2-37"></a>        <span class="kw">var</span> newStereo<span class="op">=</span> <span class="fu">trim</span>(<span class="fu">getCell</span>(cells<span class="op">,</span><span class="dv">7</span>))<span class="op">;</span></span>
<span id="cb2-38"><a href="#cb2-38"></a>        <span class="kw">var</span> newStatus<span class="op">=</span> <span class="fu">trim</span>(<span class="fu">getCell</span>(cells<span class="op">,</span><span class="dv">8</span>))<span class="op">;</span></span>
<span id="cb2-39"><a href="#cb2-39"></a></span>
<span id="cb2-40"><a href="#cb2-40"></a>        considered<span class="op">++;</span></span>
<span id="cb2-41"><a href="#cb2-41"></a></span>
<span id="cb2-42"><a href="#cb2-42"></a>        <span class="cf">if</span> (<span class="fu">equalsIgnoreCase</span>(apply<span class="op">,</span><span class="st">"YES"</span>)) {</span>
<span id="cb2-43"><a href="#cb2-43"></a>            <span class="kw">var</span> el <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb2-44"><a href="#cb2-44"></a>            <span class="co">// Prefer GUID match if provided</span></span>
<span id="cb2-45"><a href="#cb2-45"></a>            <span class="cf">if</span> (guid <span class="op">!==</span> <span class="st">""</span>) {</span>
<span id="cb2-46"><a href="#cb2-46"></a>                el <span class="op">=</span> Repository<span class="op">.</span><span class="at">GetElementByGuid</span> <span class="op">?</span> Repository<span class="op">.</span><span class="fu">GetElementByGuid</span>(guid) <span class="op">:</span> Repository<span class="op">.</span><span class="fu">GetElementByGUID</span>(guid)<span class="op">;</span></span>
<span id="cb2-47"><a href="#cb2-47"></a>            }</span>
<span id="cb2-48"><a href="#cb2-48"></a>            <span class="cf">if</span> (<span class="op">!</span>el <span class="op">&amp;&amp;</span> elementID <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb2-49"><a href="#cb2-49"></a>                el <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetElementByID</span>(elementID)<span class="op">;</span></span>
<span id="cb2-50"><a href="#cb2-50"></a>            }</span>
<span id="cb2-51"><a href="#cb2-51"></a>            <span class="cf">if</span> (<span class="op">!</span>el) { <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Row skipped: element not found (GUID="</span><span class="op">+</span>guid<span class="op">+</span><span class="st">" ID="</span><span class="op">+</span>elementID<span class="op">+</span><span class="st">")"</span>)<span class="op">;</span> <span class="cf">continue</span><span class="op">;</span> }</span>
<span id="cb2-52"><a href="#cb2-52"></a></span>
<span id="cb2-53"><a href="#cb2-53"></a>            <span class="kw">var</span> dirty <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb2-54"><a href="#cb2-54"></a>            <span class="cf">if</span> (newName <span class="op">!==</span> <span class="st">""</span> <span class="op">&amp;&amp;</span> el<span class="op">.</span><span class="at">Name</span> <span class="op">!=</span> newName) { el<span class="op">.</span><span class="at">Name</span> <span class="op">=</span> newName<span class="op">;</span> dirty <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> }</span>
<span id="cb2-55"><a href="#cb2-55"></a>            <span class="cf">if</span> (newStereo <span class="op">!==</span> <span class="st">""</span> <span class="op">&amp;&amp;</span> <span class="bu">String</span>(el<span class="op">.</span><span class="at">Stereotype</span><span class="op">||</span><span class="st">""</span>) <span class="op">!=</span> newStereo) { el<span class="op">.</span><span class="at">Stereotype</span> <span class="op">=</span> newStereo<span class="op">;</span> dirty <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> }</span>
<span id="cb2-56"><a href="#cb2-56"></a>            <span class="cf">if</span> (newStatus <span class="op">!==</span> <span class="st">""</span> <span class="op">&amp;&amp;</span> <span class="bu">String</span>(el<span class="op">.</span><span class="at">Status</span><span class="op">||</span><span class="st">""</span>) <span class="op">!=</span> newStatus) { el<span class="op">.</span><span class="at">Status</span> <span class="op">=</span> newStatus<span class="op">;</span> dirty <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> }</span>
<span id="cb2-57"><a href="#cb2-57"></a></span>
<span id="cb2-58"><a href="#cb2-58"></a>            <span class="cf">if</span> (dirty) { el<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span> applied<span class="op">++;</span> }</span>
<span id="cb2-59"><a href="#cb2-59"></a>        }</span>
<span id="cb2-60"><a href="#cb2-60"></a>    }</span>
<span id="cb2-61"><a href="#cb2-61"></a>    ts<span class="op">.</span><span class="fu">Close</span>()<span class="op">;</span></span>
<span id="cb2-62"><a href="#cb2-62"></a></span>
<span id="cb2-63"><a href="#cb2-63"></a>    <span class="cf">if</span> (applied<span class="op">&gt;</span><span class="dv">0</span>) Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb2-64"><a href="#cb2-64"></a>    <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Applied "</span> <span class="op">+</span> applied <span class="op">+</span> <span class="st">" curated change(s) out of "</span> <span class="op">+</span> considered <span class="op">+</span> <span class="st">" row(s)."</span>)<span class="op">;</span></span>
<span id="cb2-65"><a href="#cb2-65"></a>}</span>
<span id="cb2-66"><a href="#cb2-66"></a></span>
<span id="cb2-67"><a href="#cb2-67"></a><span class="co">// Return newest CSV whose name starts with prefix</span></span>
<span id="cb2-68"><a href="#cb2-68"></a><span class="kw">function</span> <span class="fu">newestCsv</span>(dir<span class="op">,</span> prefix) {</span>
<span id="cb2-69"><a href="#cb2-69"></a>    <span class="kw">var</span> fso <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Scripting.FileSystemObject"</span>)<span class="op">;</span></span>
<span id="cb2-70"><a href="#cb2-70"></a>    <span class="kw">var</span> folder <span class="op">=</span> fso<span class="op">.</span><span class="fu">GetFolder</span>(dir)<span class="op">;</span></span>
<span id="cb2-71"><a href="#cb2-71"></a>    <span class="kw">var</span> en <span class="op">=</span> <span class="kw">new</span> <span class="fu">Enumerator</span>(folder<span class="op">.</span><span class="at">Files</span>)<span class="op">;</span></span>
<span id="cb2-72"><a href="#cb2-72"></a>    <span class="kw">var</span> newest<span class="op">=</span><span class="kw">null</span><span class="op">,</span> t<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-73"><a href="#cb2-73"></a>    <span class="cf">for</span> (<span class="op">;</span> <span class="op">!</span>en<span class="op">.</span><span class="fu">atEnd</span>()<span class="op">;</span> en<span class="op">.</span><span class="fu">moveNext</span>()) {</span>
<span id="cb2-74"><a href="#cb2-74"></a>        <span class="kw">var</span> f <span class="op">=</span> en<span class="op">.</span><span class="fu">item</span>()<span class="op">;</span></span>
<span id="cb2-75"><a href="#cb2-75"></a>        <span class="cf">if</span> (<span class="fu">endsWith</span>(f<span class="op">.</span><span class="at">Name</span><span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">,</span> <span class="st">".csv"</span>) <span class="op">&amp;&amp;</span> <span class="fu">startsWith</span>(f<span class="op">.</span><span class="at">Name</span><span class="op">,</span> prefix)) {</span>
<span id="cb2-76"><a href="#cb2-76"></a>            <span class="kw">var</span> m <span class="op">=</span> f<span class="op">.</span><span class="at">DateLastModified</span><span class="op">.</span><span class="fu">getTime</span>()<span class="op">;</span></span>
<span id="cb2-77"><a href="#cb2-77"></a>            <span class="cf">if</span> (m <span class="op">&gt;</span> t) { newest<span class="op">=</span>f<span class="op">;</span> t<span class="op">=</span>m<span class="op">;</span> }</span>
<span id="cb2-78"><a href="#cb2-78"></a>        }</span>
<span id="cb2-79"><a href="#cb2-79"></a>    }</span>
<span id="cb2-80"><a href="#cb2-80"></a>    <span class="cf">return</span> newest<span class="op">;</span></span>
<span id="cb2-81"><a href="#cb2-81"></a>}</span>
<span id="cb2-82"><a href="#cb2-82"></a></span>
<span id="cb2-83"><a href="#cb2-83"></a><span class="co">// Very simple CSV splitting (assumes reviewers didn’t add embedded commas/quotes)</span></span>
<span id="cb2-84"><a href="#cb2-84"></a><span class="kw">function</span> <span class="fu">splitCsvLine</span>(line) { <span class="cf">return</span> line<span class="op">.</span><span class="fu">split</span>(<span class="st">","</span>)<span class="op">;</span> }</span>
<span id="cb2-85"><a href="#cb2-85"></a><span class="kw">function</span> <span class="fu">getCell</span>(arr<span class="op">,</span> idx) { <span class="cf">return</span> idx <span class="op">&lt;</span> arr<span class="op">.</span><span class="at">length</span> <span class="op">?</span> arr[idx] <span class="op">:</span> <span class="st">""</span><span class="op">;</span> }</span>
<span id="cb2-86"><a href="#cb2-86"></a><span class="kw">function</span> <span class="fu">endsWith</span>(s<span class="op">,</span> suffix){ s<span class="op">=</span><span class="bu">String</span>(s<span class="op">||</span><span class="st">""</span>)<span class="op">;</span> <span class="kw">var</span> i<span class="op">=</span>s<span class="op">.</span><span class="fu">lastIndexOf</span>(suffix)<span class="op">;</span> <span class="cf">return</span> i<span class="op">&gt;=</span><span class="dv">0</span> <span class="op">&amp;&amp;</span> (i<span class="op">+</span>suffix<span class="op">.</span><span class="at">length</span><span class="op">===</span>s<span class="op">.</span><span class="at">length</span>)<span class="op">;</span> }</span>
<span id="cb2-87"><a href="#cb2-87"></a></span>
<span id="cb2-88"><a href="#cb2-88"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Tip</strong>: If you must support commas/quotes in curated text, switch to the <strong>external Python importer</strong> in §8.4; it uses the csv module to parse safely.</p>
</section>
<section id="excel-via-com-in-ea" class="level3" data-number="10.10.4">
<h3 data-number="10.10.4" class="anchored" data-anchor-id="excel-via-com-in-ea"><span class="header-section-number">10.10.4</span> Excel via COM (in-EA)</h3>
<p>Sometimes you must deliver a real <strong>.xlsx</strong> instead of a CSV. You can drive Excel via ActiveX.</p>
<p><strong>Export to Excel (.xlsx)</strong></p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 9.3 - ExportExcel_PackageSimple.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" data-filename="Example 9.3 - ExportExcel_PackageSimple.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">// Example 9.3 - ExportExcel_PackageSimple.js – JScript (ES3)</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">// Purpose: Write selected package elements to an .xlsx via Excel COM</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">// Usage: Select a package → run script → pick output folder</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">// Requirements: Microsoft Excel installed (same bitness as EA)</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="op">!</span>INC _Common<span class="op">.</span><span class="at">Helpers</span></span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="kw">var</span> TAB <span class="op">=</span> <span class="st">"ExportExcel"</span><span class="op">;</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="fu">ensureOutputTab</span>(TAB)<span class="op">;</span></span>
<span id="cb3-13"><a href="#cb3-13"></a></span>
<span id="cb3-14"><a href="#cb3-14"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb3-16"><a href="#cb3-16"></a></span>
<span id="cb3-17"><a href="#cb3-17"></a>    <span class="kw">var</span> outDir <span class="op">=</span> <span class="fu">browseForFolder</span>(<span class="st">"Select output folder (.xlsx)"</span>)<span class="op">;</span></span>
<span id="cb3-18"><a href="#cb3-18"></a>    <span class="cf">if</span> (<span class="op">!</span>outDir) { <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Cancelled."</span>)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb3-19"><a href="#cb3-19"></a></span>
<span id="cb3-20"><a href="#cb3-20"></a>    <span class="kw">var</span> stamp <span class="op">=</span> (<span class="kw">new</span> <span class="bu">Date</span>())<span class="op">.</span><span class="fu">getTime</span>()<span class="op">;</span></span>
<span id="cb3-21"><a href="#cb3-21"></a>    <span class="kw">var</span> filePath <span class="op">=</span> outDir <span class="op">+</span> <span class="st">"</span><span class="sc">\\</span><span class="st">export_"</span> <span class="op">+</span> <span class="fu">safeName</span>(pkg<span class="op">.</span><span class="at">Name</span>) <span class="op">+</span> <span class="st">"_"</span> <span class="op">+</span> stamp <span class="op">+</span> <span class="st">".xlsx"</span><span class="op">;</span></span>
<span id="cb3-22"><a href="#cb3-22"></a></span>
<span id="cb3-23"><a href="#cb3-23"></a>    <span class="kw">var</span> xl <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Excel.Application"</span>)<span class="op">;</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>    xl<span class="op">.</span><span class="at">Visible</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb3-25"><a href="#cb3-25"></a>    <span class="kw">var</span> wb <span class="op">=</span> xl<span class="op">.</span><span class="at">Workbooks</span><span class="op">.</span><span class="fu">Add</span>()<span class="op">;</span></span>
<span id="cb3-26"><a href="#cb3-26"></a>    <span class="kw">var</span> ws <span class="op">=</span> wb<span class="op">.</span><span class="at">ActiveSheet</span><span class="op">;</span></span>
<span id="cb3-27"><a href="#cb3-27"></a>    ws<span class="op">.</span><span class="at">Name</span> <span class="op">=</span> <span class="st">"Elements"</span><span class="op">;</span></span>
<span id="cb3-28"><a href="#cb3-28"></a></span>
<span id="cb3-29"><a href="#cb3-29"></a>    <span class="co">// Header</span></span>
<span id="cb3-30"><a href="#cb3-30"></a>    ws<span class="op">.</span><span class="fu">Cells</span>(<span class="dv">1</span><span class="op">,</span><span class="dv">1</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> <span class="st">"ElementID"</span><span class="op">;</span></span>
<span id="cb3-31"><a href="#cb3-31"></a>    ws<span class="op">.</span><span class="fu">Cells</span>(<span class="dv">1</span><span class="op">,</span><span class="dv">2</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> <span class="st">"GUID"</span><span class="op">;</span></span>
<span id="cb3-32"><a href="#cb3-32"></a>    ws<span class="op">.</span><span class="fu">Cells</span>(<span class="dv">1</span><span class="op">,</span><span class="dv">3</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> <span class="st">"Name"</span><span class="op">;</span></span>
<span id="cb3-33"><a href="#cb3-33"></a>    ws<span class="op">.</span><span class="fu">Cells</span>(<span class="dv">1</span><span class="op">,</span><span class="dv">4</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> <span class="st">"Type"</span><span class="op">;</span></span>
<span id="cb3-34"><a href="#cb3-34"></a>    ws<span class="op">.</span><span class="fu">Cells</span>(<span class="dv">1</span><span class="op">,</span><span class="dv">5</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> <span class="st">"Stereotype"</span><span class="op">;</span></span>
<span id="cb3-35"><a href="#cb3-35"></a></span>
<span id="cb3-36"><a href="#cb3-36"></a>    <span class="kw">var</span> r <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb3-37"><a href="#cb3-37"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb3-38"><a href="#cb3-38"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++,</span> r<span class="op">++</span>) {</span>
<span id="cb3-39"><a href="#cb3-39"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb3-40"><a href="#cb3-40"></a>        ws<span class="op">.</span><span class="fu">Cells</span>(r<span class="op">,</span><span class="dv">1</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> e<span class="op">.</span><span class="at">ElementID</span><span class="op">;</span></span>
<span id="cb3-41"><a href="#cb3-41"></a>        ws<span class="op">.</span><span class="fu">Cells</span>(r<span class="op">,</span><span class="dv">2</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> e<span class="op">.</span><span class="at">ElementGUID</span><span class="op">;</span></span>
<span id="cb3-42"><a href="#cb3-42"></a>        ws<span class="op">.</span><span class="fu">Cells</span>(r<span class="op">,</span><span class="dv">3</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> e<span class="op">.</span><span class="at">Name</span><span class="op">;</span></span>
<span id="cb3-43"><a href="#cb3-43"></a>        ws<span class="op">.</span><span class="fu">Cells</span>(r<span class="op">,</span><span class="dv">4</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> e<span class="op">.</span><span class="at">Type</span><span class="op">;</span></span>
<span id="cb3-44"><a href="#cb3-44"></a>        ws<span class="op">.</span><span class="fu">Cells</span>(r<span class="op">,</span><span class="dv">5</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> <span class="bu">String</span>(e<span class="op">.</span><span class="at">Stereotype</span><span class="op">||</span><span class="st">""</span>)<span class="op">;</span></span>
<span id="cb3-45"><a href="#cb3-45"></a>    }</span>
<span id="cb3-46"><a href="#cb3-46"></a></span>
<span id="cb3-47"><a href="#cb3-47"></a>    <span class="co">// Autosize</span></span>
<span id="cb3-48"><a href="#cb3-48"></a>    ws<span class="op">.</span><span class="at">Columns</span><span class="op">.</span><span class="fu">AutoFit</span>()<span class="op">;</span></span>
<span id="cb3-49"><a href="#cb3-49"></a></span>
<span id="cb3-50"><a href="#cb3-50"></a>    <span class="co">// Save and clean up</span></span>
<span id="cb3-51"><a href="#cb3-51"></a>    wb<span class="op">.</span><span class="fu">SaveAs</span>(filePath)<span class="op">;</span></span>
<span id="cb3-52"><a href="#cb3-52"></a>    wb<span class="op">.</span><span class="fu">Close</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb3-53"><a href="#cb3-53"></a>    xl<span class="op">.</span><span class="fu">Quit</span>()<span class="op">;</span></span>
<span id="cb3-54"><a href="#cb3-54"></a></span>
<span id="cb3-55"><a href="#cb3-55"></a>    wb <span class="op">=</span> <span class="kw">null</span><span class="op">;</span> ws <span class="op">=</span> <span class="kw">null</span><span class="op">;</span> xl <span class="op">=</span> <span class="kw">null</span><span class="op">;</span> <span class="co">// release COM references</span></span>
<span id="cb3-56"><a href="#cb3-56"></a>    <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Excel written → "</span> <span class="op">+</span> filePath)<span class="op">;</span></span>
<span id="cb3-57"><a href="#cb3-57"></a>}</span>
<span id="cb3-58"><a href="#cb3-58"></a><span class="kw">function</span> <span class="fu">safeName</span>(s){ <span class="cf">return</span> <span class="bu">String</span>(s<span class="op">||</span><span class="st">""</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">[^A-Za-z0-9_]+</span><span class="ss">/g</span><span class="op">,</span><span class="st">"_"</span>)<span class="op">;</span> }</span>
<span id="cb3-59"><a href="#cb3-59"></a></span>
<span id="cb3-60"><a href="#cb3-60"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Note</strong>: Reading <strong>from</strong> Excel in JScript is also possible (open workbook, loop rows until blank). For reliability and parsing complexity, prefer CSV for imports, or use the Python importer below.</p>
</section>
<section id="json-pipelines" class="level3" data-number="10.10.5">
<h3 data-number="10.10.5" class="anchored" data-anchor-id="json-pipelines"><span class="header-section-number">10.10.5</span> JSON Pipelines</h3>
<p><strong>Why JSON?</strong> It’s friendly to automation and works nicely in Git. EA’s internal JScript has no JSON parser, so we recommend: <strong>export JSON inside EA</strong>, <strong>import JSON externally</strong> (Python).</p>
<p><strong>Export JSON (simple structure) inside EA</strong></p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 9.4 - ExportJSON_Package.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" data-filename="Example 9.4 - ExportJSON_Package.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">// Example 9.4 - ExportJSON_Package.js – JScript (ES3)</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">// Purpose: Export selected package elements to a JSON file</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">// Usage: Select a package → run script → pick output folder</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">// Notes: JScript has no JSON.stringify, so we build JSON manually.</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">//        Keep values escaped and simple.</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="op">!</span>INC _Common<span class="op">.</span><span class="at">Helpers</span></span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb4-12"><a href="#cb4-12"></a>    <span class="kw">var</span> TAB <span class="op">=</span> <span class="st">"ExportJSON"</span><span class="op">;</span></span>
<span id="cb4-13"><a href="#cb4-13"></a>    <span class="fu">ensureOutputTab</span>(TAB)<span class="op">;</span></span>
<span id="cb4-14"><a href="#cb4-14"></a></span>
<span id="cb4-15"><a href="#cb4-15"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb4-16"><a href="#cb4-16"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb4-17"><a href="#cb4-17"></a></span>
<span id="cb4-18"><a href="#cb4-18"></a>    <span class="kw">var</span> outDir <span class="op">=</span> <span class="fu">browseForFolder</span>(<span class="st">"Select output folder (JSON)"</span>)<span class="op">;</span></span>
<span id="cb4-19"><a href="#cb4-19"></a>    <span class="cf">if</span> (<span class="op">!</span>outDir) { <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Cancelled."</span>)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb4-20"><a href="#cb4-20"></a></span>
<span id="cb4-21"><a href="#cb4-21"></a>    <span class="kw">var</span> stamp <span class="op">=</span> (<span class="kw">new</span> <span class="bu">Date</span>())<span class="op">.</span><span class="fu">getTime</span>()<span class="op">;</span></span>
<span id="cb4-22"><a href="#cb4-22"></a>    <span class="kw">var</span> path  <span class="op">=</span> outDir <span class="op">+</span> <span class="st">"</span><span class="sc">\\</span><span class="st">export_"</span> <span class="op">+</span> <span class="fu">safeName</span>(pkg<span class="op">.</span><span class="at">Name</span>) <span class="op">+</span> <span class="st">"_"</span> <span class="op">+</span> stamp <span class="op">+</span> <span class="st">".json"</span><span class="op">;</span></span>
<span id="cb4-23"><a href="#cb4-23"></a></span>
<span id="cb4-24"><a href="#cb4-24"></a>    <span class="kw">var</span> fso  <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Scripting.FileSystemObject"</span>)<span class="op">;</span></span>
<span id="cb4-25"><a href="#cb4-25"></a>    <span class="kw">var</span> file <span class="op">=</span> fso<span class="op">.</span><span class="fu">OpenTextFile</span>(path<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span> <span class="co">// 2=ForWriting</span></span>
<span id="cb4-26"><a href="#cb4-26"></a></span>
<span id="cb4-27"><a href="#cb4-27"></a>    file<span class="op">.</span><span class="fu">WriteLine</span>(<span class="st">"["</span>)<span class="op">;</span></span>
<span id="cb4-28"><a href="#cb4-28"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb4-29"><a href="#cb4-29"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb4-30"><a href="#cb4-30"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb4-31"><a href="#cb4-31"></a>        <span class="kw">var</span> line <span class="op">=</span> <span class="st">"  {"</span> <span class="op">+</span></span>
<span id="cb4-32"><a href="#cb4-32"></a>            <span class="st">"</span><span class="sc">\"</span><span class="st">elementId</span><span class="sc">\"</span><span class="st">:"</span> <span class="op">+</span> e<span class="op">.</span><span class="at">ElementID</span> <span class="op">+</span> <span class="st">","</span> <span class="op">+</span></span>
<span id="cb4-33"><a href="#cb4-33"></a>            <span class="st">"</span><span class="sc">\"</span><span class="st">guid</span><span class="sc">\"</span><span class="st">:</span><span class="sc">\"</span><span class="st">"</span> <span class="op">+</span> <span class="fu">jsonEscape</span>(e<span class="op">.</span><span class="at">ElementGUID</span>) <span class="op">+</span> <span class="st">"</span><span class="sc">\"</span><span class="st">,"</span> <span class="op">+</span></span>
<span id="cb4-34"><a href="#cb4-34"></a>            <span class="st">"</span><span class="sc">\"</span><span class="st">name</span><span class="sc">\"</span><span class="st">:</span><span class="sc">\"</span><span class="st">"</span> <span class="op">+</span> <span class="fu">jsonEscape</span>(e<span class="op">.</span><span class="at">Name</span>) <span class="op">+</span> <span class="st">"</span><span class="sc">\"</span><span class="st">,"</span> <span class="op">+</span></span>
<span id="cb4-35"><a href="#cb4-35"></a>            <span class="st">"</span><span class="sc">\"</span><span class="st">type</span><span class="sc">\"</span><span class="st">:</span><span class="sc">\"</span><span class="st">"</span> <span class="op">+</span> <span class="fu">jsonEscape</span>(e<span class="op">.</span><span class="at">Type</span>) <span class="op">+</span> <span class="st">"</span><span class="sc">\"</span><span class="st">,"</span> <span class="op">+</span></span>
<span id="cb4-36"><a href="#cb4-36"></a>            <span class="st">"</span><span class="sc">\"</span><span class="st">stereotype</span><span class="sc">\"</span><span class="st">:</span><span class="sc">\"</span><span class="st">"</span> <span class="op">+</span> <span class="fu">jsonEscape</span>(<span class="bu">String</span>(e<span class="op">.</span><span class="at">Stereotype</span><span class="op">||</span><span class="st">""</span>)) <span class="op">+</span> <span class="st">"</span><span class="sc">\"</span><span class="st">"</span> <span class="op">+</span></span>
<span id="cb4-37"><a href="#cb4-37"></a>        <span class="st">"}"</span><span class="op">;</span></span>
<span id="cb4-38"><a href="#cb4-38"></a>        <span class="cf">if</span> (i <span class="op">&lt;</span> els<span class="op">.</span><span class="at">Count</span><span class="op">-</span><span class="dv">1</span>) line <span class="op">+=</span> <span class="st">","</span><span class="op">;</span></span>
<span id="cb4-39"><a href="#cb4-39"></a>        file<span class="op">.</span><span class="fu">WriteLine</span>(line)<span class="op">;</span></span>
<span id="cb4-40"><a href="#cb4-40"></a>    }</span>
<span id="cb4-41"><a href="#cb4-41"></a>    file<span class="op">.</span><span class="fu">WriteLine</span>(<span class="st">"]"</span>)<span class="op">;</span></span>
<span id="cb4-42"><a href="#cb4-42"></a></span>
<span id="cb4-43"><a href="#cb4-43"></a>    file<span class="op">.</span><span class="fu">Close</span>()<span class="op">;</span></span>
<span id="cb4-44"><a href="#cb4-44"></a>    <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"JSON written → "</span> <span class="op">+</span> path)<span class="op">;</span></span>
<span id="cb4-45"><a href="#cb4-45"></a>}</span>
<span id="cb4-46"><a href="#cb4-46"></a><span class="kw">function</span> <span class="fu">jsonEscape</span>(s){ s<span class="op">=</span><span class="bu">String</span>(s<span class="op">||</span><span class="st">""</span>)<span class="op">;</span> <span class="cf">return</span> s<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\\</span><span class="ss">/g</span><span class="op">,</span><span class="st">"</span><span class="sc">\\\\</span><span class="st">"</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/"/g</span><span class="op">,</span><span class="st">'</span><span class="sc">\\</span><span class="st">"'</span>)<span class="op">;</span> }</span>
<span id="cb4-47"><a href="#cb4-47"></a><span class="kw">function</span> <span class="fu">safeName</span>(s){ <span class="cf">return</span> <span class="bu">String</span>(s<span class="op">||</span><span class="st">""</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">[^A-Za-z0-9_]+</span><span class="ss">/g</span><span class="op">,</span><span class="st">"_"</span>)<span class="op">;</span> }</span>
<span id="cb4-48"><a href="#cb4-48"></a></span>
<span id="cb4-49"><a href="#cb4-49"></a><span class="fu">main</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="import-json-externally-python" class="level3" data-number="10.10.6">
<h3 data-number="10.10.6" class="anchored" data-anchor-id="import-json-externally-python"><span class="header-section-number">10.10.6</span> Import JSON externally (Python)</h3>
<p>This importer:</p>
<ul>
<li><p>Tries <strong>GUID</strong> first (GetElementByGuid/GetElementByGUID).</p></li>
<li><p>Falls back to <strong>name + type within a package</strong> (to avoid dupes).</p></li>
<li><p>Creates new elements if missing <em>(note: EA does not let you set GUIDs via API; new elements get new GUIDs—store a mapping if you need cross-walks)</em>.</p></li>
</ul>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 9.5 - import_json_into_ea.py – Python 3 (pywin32)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" data-filename="Example 9.5 - import_json_into_ea.py – Python 3 (pywin32)"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># -------------------------------------------------------</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># Example 9.5 - import_json_into_ea.py – Python 3 (pywin32)</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># Purpose: Import elements from JSON into a target package</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co"># Usage: python import_json_into_ea.py "C:\...\export_Package_123.json" 1234</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#   where 1234 is the target PackageID in EA</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co"># Safety:</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#   - Avoid duplicates by GUID first, else by (name,type,package)</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#   - Log new GUIDs so you can maintain a cross-walk</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co"># -------------------------------------------------------</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="im">import</span> sys, json, win32com.client</span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="kw">def</span> find_by_name_type(pkg, name, etype):</span>
<span id="cb5-13"><a href="#cb5-13"></a>    els <span class="op">=</span> pkg.Elements</span>
<span id="cb5-14"><a href="#cb5-14"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(els.Count):</span>
<span id="cb5-15"><a href="#cb5-15"></a>        e <span class="op">=</span> els.GetAt(i)</span>
<span id="cb5-16"><a href="#cb5-16"></a>        <span class="cf">if</span> e.Name <span class="op">==</span> name <span class="kw">and</span> e.Type <span class="op">==</span> etype:</span>
<span id="cb5-17"><a href="#cb5-17"></a>            <span class="cf">return</span> e</span>
<span id="cb5-18"><a href="#cb5-18"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb5-19"><a href="#cb5-19"></a></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="kw">def</span> main():</span>
<span id="cb5-21"><a href="#cb5-21"></a>    <span class="cf">if</span> <span class="bu">len</span>(sys.argv) <span class="op">&lt;</span> <span class="dv">3</span>:</span>
<span id="cb5-22"><a href="#cb5-22"></a>        <span class="bu">print</span>(<span class="st">"Usage: import_json_into_ea.py &lt;json_path&gt; &lt;target_package_id&gt;"</span>)</span>
<span id="cb5-23"><a href="#cb5-23"></a>        <span class="cf">return</span></span>
<span id="cb5-24"><a href="#cb5-24"></a></span>
<span id="cb5-25"><a href="#cb5-25"></a>    json_path <span class="op">=</span> sys.argv[<span class="dv">1</span>]</span>
<span id="cb5-26"><a href="#cb5-26"></a>    target_pkg_id <span class="op">=</span> <span class="bu">int</span>(sys.argv[<span class="dv">2</span>])</span>
<span id="cb5-27"><a href="#cb5-27"></a></span>
<span id="cb5-28"><a href="#cb5-28"></a>    ea <span class="op">=</span> win32com.client.Dispatch(<span class="st">"EA.App"</span>)</span>
<span id="cb5-29"><a href="#cb5-29"></a>    repo <span class="op">=</span> ea.Repository</span>
<span id="cb5-30"><a href="#cb5-30"></a>    pkg <span class="op">=</span> repo.GetPackageByID(target_pkg_id)</span>
<span id="cb5-31"><a href="#cb5-31"></a>    <span class="cf">if</span> <span class="kw">not</span> pkg:</span>
<span id="cb5-32"><a href="#cb5-32"></a>        <span class="bu">print</span>(<span class="st">"Target package not found:"</span>, target_pkg_id)<span class="op">;</span> <span class="cf">return</span></span>
<span id="cb5-33"><a href="#cb5-33"></a></span>
<span id="cb5-34"><a href="#cb5-34"></a>    data <span class="op">=</span> json.load(<span class="bu">open</span>(json_path, <span class="st">"r"</span>))</span>
<span id="cb5-35"><a href="#cb5-35"></a></span>
<span id="cb5-36"><a href="#cb5-36"></a>    created, updated <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb5-37"><a href="#cb5-37"></a>    <span class="cf">for</span> item <span class="kw">in</span> data:</span>
<span id="cb5-38"><a href="#cb5-38"></a>        guid <span class="op">=</span> item.get(<span class="st">"guid"</span>,<span class="st">""</span>)</span>
<span id="cb5-39"><a href="#cb5-39"></a>        name <span class="op">=</span> item.get(<span class="st">"name"</span>,<span class="st">""</span>)</span>
<span id="cb5-40"><a href="#cb5-40"></a>        etype<span class="op">=</span> item.get(<span class="st">"type"</span>,<span class="st">"Class"</span>)</span>
<span id="cb5-41"><a href="#cb5-41"></a>        stereo<span class="op">=</span>item.get(<span class="st">"stereotype"</span>,<span class="st">""</span>)</span>
<span id="cb5-42"><a href="#cb5-42"></a></span>
<span id="cb5-43"><a href="#cb5-43"></a>        el <span class="op">=</span> <span class="va">None</span></span>
<span id="cb5-44"><a href="#cb5-44"></a>        <span class="cf">if</span> guid:</span>
<span id="cb5-45"><a href="#cb5-45"></a>            <span class="cf">try</span>:</span>
<span id="cb5-46"><a href="#cb5-46"></a>                el <span class="op">=</span> repo.GetElementByGuid(guid)  <span class="co"># newer EA</span></span>
<span id="cb5-47"><a href="#cb5-47"></a>            <span class="cf">except</span>:</span>
<span id="cb5-48"><a href="#cb5-48"></a>                <span class="cf">try</span>:</span>
<span id="cb5-49"><a href="#cb5-49"></a>                    el <span class="op">=</span> repo.GetElementByGUID(guid)  <span class="co"># older EA</span></span>
<span id="cb5-50"><a href="#cb5-50"></a>                <span class="cf">except</span>:</span>
<span id="cb5-51"><a href="#cb5-51"></a>                    el <span class="op">=</span> <span class="va">None</span></span>
<span id="cb5-52"><a href="#cb5-52"></a></span>
<span id="cb5-53"><a href="#cb5-53"></a>        <span class="cf">if</span> <span class="kw">not</span> el:</span>
<span id="cb5-54"><a href="#cb5-54"></a>            el <span class="op">=</span> find_by_name_type(pkg, name, etype)</span>
<span id="cb5-55"><a href="#cb5-55"></a></span>
<span id="cb5-56"><a href="#cb5-56"></a>        <span class="cf">if</span> <span class="kw">not</span> el:</span>
<span id="cb5-57"><a href="#cb5-57"></a>            el <span class="op">=</span> pkg.Elements.AddNew(name, etype)</span>
<span id="cb5-58"><a href="#cb5-58"></a>            el.Stereotype <span class="op">=</span> stereo</span>
<span id="cb5-59"><a href="#cb5-59"></a>            el.Update()</span>
<span id="cb5-60"><a href="#cb5-60"></a>            created <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-61"><a href="#cb5-61"></a>            <span class="co"># </span><span class="al">NOTE</span><span class="co">: el.ElementGUID is NEW and cannot be set via API.</span></span>
<span id="cb5-62"><a href="#cb5-62"></a>            <span class="bu">print</span>(<span class="ss">f"Created: </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>etype<span class="sc">}</span><span class="ss">) NEW_GUID=</span><span class="sc">{</span>el<span class="sc">.</span>ElementGUID<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-63"><a href="#cb5-63"></a>        <span class="cf">else</span>:</span>
<span id="cb5-64"><a href="#cb5-64"></a>            dirty <span class="op">=</span> <span class="va">False</span></span>
<span id="cb5-65"><a href="#cb5-65"></a>            <span class="cf">if</span> stereo <span class="kw">and</span> el.Stereotype <span class="op">!=</span> stereo:</span>
<span id="cb5-66"><a href="#cb5-66"></a>                el.Stereotype <span class="op">=</span> stereo<span class="op">;</span> dirty <span class="op">=</span> <span class="va">True</span></span>
<span id="cb5-67"><a href="#cb5-67"></a>            <span class="cf">if</span> dirty:</span>
<span id="cb5-68"><a href="#cb5-68"></a>                el.Update()<span class="op">;</span> updated <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-69"><a href="#cb5-69"></a></span>
<span id="cb5-70"><a href="#cb5-70"></a>    <span class="cf">if</span> created <span class="kw">or</span> updated:</span>
<span id="cb5-71"><a href="#cb5-71"></a>        repo.RefreshModelView(pkg.PackageID)</span>
<span id="cb5-72"><a href="#cb5-72"></a></span>
<span id="cb5-73"><a href="#cb5-73"></a>    <span class="bu">print</span>(<span class="ss">f"Done. Created=</span><span class="sc">{</span>created<span class="sc">}</span><span class="ss">, Updated=</span><span class="sc">{</span>updated<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-74"><a href="#cb5-74"></a></span>
<span id="cb5-75"><a href="#cb5-75"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb5-76"><a href="#cb5-76"></a>    main()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>GUID reality check</strong>: EA’s API exposes ElementGUID but does <strong>not</strong> let you set it for new elements. If you must preserve GUIDs from an external master, consider <strong>XMI import</strong> or EA’s native importers. Otherwise, store a <strong>cross-walk CSV</strong> of {external_id → EA GUID} after creation.</p>
</section>
</section>
<section id="managing-guids-avoiding-duplicates" class="level2" data-number="10.11">
<h2 data-number="10.11" class="anchored" data-anchor-id="managing-guids-avoiding-duplicates"><span class="header-section-number">10.11</span> Managing GUIDs &amp; Avoiding Duplicates</h2>
<p><strong>Best-practice order of matching:</strong></p>
<ul>
<li><p><strong>GUID</strong> (strongest identity) → GetElementByGUID/GetElementByGuid.</p></li>
<li><p><strong>Stable external key</strong> (your own code) if you maintain one as a tagged value, e.g., ExternalID.</p></li>
<li><p><strong>Name + Type + Package</strong> (weaker; beware rename collisions).</p></li>
</ul>
<p><strong>For new items:</strong></p>
<ul>
<li><p>You cannot set EA GUIDs via API; EA assigns them.</p></li>
<li><p>Immediately log {externalKey → new EA GUID} to a CSV so future updates can target the same element.</p></li>
</ul>
<p><strong>Avoiding duplicates:</strong></p>
<ul>
<li><p>Before creating, <strong>search for existing</strong> by GUID or external key.</p></li>
<li><p>If you must use name/type, scope the search to the target package (or run an <strong>SQLQuery</strong> to check repository-wide).</p></li>
<li><p>Build imports as <strong>two-phase</strong>: curate first, then apply, so humans can resolve ambiguous matches.</p></li>
</ul>
</section>
<section id="scaling-up-performance" class="level2" data-number="10.12">
<h2 data-number="10.12" class="anchored" data-anchor-id="scaling-up-performance"><span class="header-section-number">10.12</span> Scaling Up (Performance)</h2>
<ul>
<li><p>Use <strong>SQL for finding</strong>, <strong>API for writing</strong> (Pattern 5 in Chapter 6).</p></li>
<li><p>Batch large updates (e.g., 250 elements) and refresh the UI at the end.</p></li>
<li><p>Keep logs: write a CSV of every change (old → new).</p></li>
</ul>
<p><strong>Example</strong>: fast existence check before creating</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Example 9.6 - ExistsByNameType_SQL.js – JScript (ES3)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" data-filename="Example 9.6 - ExistsByNameType_SQL.js – JScript (ES3)"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">// Example 9.6 - ExistsByNameType_SQL.js – JScript (ES3)</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">// Purpose: Repository-wide check if (Name,Type) exists; returns first Object_ID</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">// Notes: SQLQuery returns XML; we do a tiny string parse</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="kw">function</span> <span class="fu">existsByNameType</span>(name<span class="op">,</span> type) {</span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="kw">var</span> sql <span class="op">=</span> <span class="st">"SELECT TOP 1 Object_ID FROM t_object WHERE Name='"</span> <span class="op">+</span> <span class="fu">esc</span>(name) <span class="op">+</span> <span class="st">"' AND Object_Type='"</span> <span class="op">+</span> <span class="fu">esc</span>(type) <span class="op">+</span> <span class="st">"'"</span><span class="op">;</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>    <span class="kw">var</span> xml <span class="op">=</span> Repository<span class="op">.</span><span class="fu">SQLQuery</span>(sql)<span class="op">;</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>    <span class="kw">var</span> id <span class="op">=</span> <span class="fu">between</span>(xml<span class="op">,</span> <span class="st">"&lt;Object_ID&gt;"</span><span class="op">,</span> <span class="st">"&lt;/Object_ID&gt;"</span>)<span class="op">;</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>    <span class="cf">return</span> id <span class="op">?</span> <span class="pp">parseInt</span>(id<span class="op">,</span><span class="dv">10</span>) <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>}</span>
<span id="cb6-14"><a href="#cb6-14"></a></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="kw">function</span> <span class="fu">esc</span>(s){ </span>
<span id="cb6-16"><a href="#cb6-16"></a>  <span class="cf">return</span> <span class="bu">String</span>(s<span class="op">||</span><span class="st">""</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/'/g</span><span class="op">,</span><span class="st">"''"</span>)<span class="op">;</span> </span>
<span id="cb6-17"><a href="#cb6-17"></a>}</span>
<span id="cb6-18"><a href="#cb6-18"></a></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="kw">function</span> <span class="fu">between</span>(h<span class="op">,</span> a<span class="op">,</span> b){ </span>
<span id="cb6-20"><a href="#cb6-20"></a>  <span class="kw">var</span> i<span class="op">=</span>h<span class="op">.</span><span class="fu">indexOf</span>(a)<span class="op">;</span> </span>
<span id="cb6-21"><a href="#cb6-21"></a>  <span class="cf">if</span>(i<span class="op">&lt;</span><span class="dv">0</span>) <span class="cf">return</span> <span class="st">""</span><span class="op">;</span> </span>
<span id="cb6-22"><a href="#cb6-22"></a>  <span class="kw">var</span> j<span class="op">=</span>h<span class="op">.</span><span class="fu">indexOf</span>(b<span class="op">,</span>i<span class="op">+</span>a<span class="op">.</span><span class="at">length</span>)<span class="op">;</span> </span>
<span id="cb6-23"><a href="#cb6-23"></a>  <span class="cf">return</span> j<span class="op">&lt;</span><span class="dv">0</span><span class="op">?</span><span class="st">""</span><span class="op">:</span>h<span class="op">.</span><span class="fu">substring</span>(i<span class="op">+</span>a<span class="op">.</span><span class="at">length</span><span class="op">,</span>j)<span class="op">;</span> </span>
<span id="cb6-24"><a href="#cb6-24"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="safety-checklist" class="level2" data-number="10.13">
<h2 data-number="10.13" class="anchored" data-anchor-id="safety-checklist"><span class="header-section-number">10.13</span> Safety Checklist</h2>
<ul>
<li><p><strong>Dry-run first</strong> (or export-curate-apply).</p></li>
<li><p><strong>Back up</strong> repositories (or work on a copy).</p></li>
<li><p><strong>Log everything</strong> (CSV with old/new values).</p></li>
<li><p><strong>Update()</strong> every modified object; <strong>RefreshModelView()</strong> to show changes.</p></li>
<li><p>Prefer <strong>CSV/JSON for input</strong>, Excel only when required.</p></li>
<li><p>For rich parsing, do it <strong>externally</strong> (Python) and keep in-EA scripts small and safe.</p></li>
</ul>
</section>
<section id="what-to-use-when" class="level2" data-number="10.14">
<h2 data-number="10.14" class="anchored" data-anchor-id="what-to-use-when"><span class="header-section-number">10.14</span> What to use when</h2>
<ul>
<li><p>Quick exports for review → CSV export (8.1.1).</p></li>
<li><p>Curated updates → CSV apply (8.1.2) or Python CSV/JSON importer (8.3.2).</p></li>
<li><p>Stakeholder-friendly spreadsheet → Excel export (8.2.1).</p></li>
<li><p>Dev pipelines / Git → JSON export (8.3.1) + Python importer (8.3.2).</p></li>
<li><p>Strong identity → prefer GUIDs or your own ExternalID tagged value.</p></li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script>

document.addEventListener('DOMContentLoaded', function () {

  // Prefer the margin sidebar if it exists; otherwise try the TOC sidebar.

  const margin = document.querySelector('#quarto-margin-sidebar, .margin-sidebar, .column-margin');

  const toc    = document.querySelector('nav#TOC');

  const sidebar = margin || (toc && toc.closest('.sidebar, .quarto-sidebar, .margin-sidebar'));



  if (!sidebar) return; // no margin column on this layout



  const holder = document.createElement('div');

  holder.className = 'cover-above-toc';

  holder.innerHTML = `

    <a href="index.html">

      <img src="images/cover.png" alt="Book cover" class="cover-above-toc__img" width="140" />

    </a>

  `;

  sidebar.prepend(holder);

});

</script>



<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./09-System.Object[].html" class="pagination-link" aria-label="Chapter 8: Object Details">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Chapter 8: Object Details</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./11-System.Object[].html" class="pagination-link" aria-label="Chapter 10: MDG-Aware Scripting">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Chapter 10: MDG-Aware Scripting</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu"># Chapter 9: Imports &amp; Exports</span></span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a>One of the first serious challenges you encounter when scripting</span>
<span id="cb7-4"><a href="#cb7-4"></a>Enterprise Architect is how to move data in and out of the repository. A</span>
<span id="cb7-5"><a href="#cb7-5"></a>model is rarely a self-contained island. Requirements may start life in</span>
<span id="cb7-6"><a href="#cb7-6"></a>Jira or Excel. Application inventories may be stored in a CMDB. Metadata</span>
<span id="cb7-7"><a href="#cb7-7"></a>may need to be exported to registries or analytics platforms. Architects</span>
<span id="cb7-8"><a href="#cb7-8"></a>frequently face the practical need to **import content into EA** or</span>
<span id="cb7-9"><a href="#cb7-9"></a>**export content from EA** to other systems.</span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a>This chapter focuses on imports and exports — arguably the most common</span>
<span id="cb7-12"><a href="#cb7-12"></a>automation tasks in EA. At first glance, they may seem trivial: read</span>
<span id="cb7-13"><a href="#cb7-13"></a>from CSV, create elements, write back. But once you attempt real-world</span>
<span id="cb7-14"><a href="#cb7-14"></a>imports and exports, you quickly discover subtle complexities: handling</span>
<span id="cb7-15"><a href="#cb7-15"></a>GUIDs, avoiding duplicates, ensuring round-trip consistency, and dealing</span>
<span id="cb7-16"><a href="#cb7-16"></a>with encoding.</span>
<span id="cb7-17"><a href="#cb7-17"></a></span>
<span id="cb7-18"><a href="#cb7-18"></a>Understanding these complexities is essential. A poorly designed import</span>
<span id="cb7-19"><a href="#cb7-19"></a>script can flood your repository with duplicates. A naïve export may</span>
<span id="cb7-20"><a href="#cb7-20"></a>omit critical metadata or lose relationships. The goal of this chapter</span>
<span id="cb7-21"><a href="#cb7-21"></a>is to build robust patterns for imports and exports that are safe,</span>
<span id="cb7-22"><a href="#cb7-22"></a>repeatable, and auditable.</span>
<span id="cb7-23"><a href="#cb7-23"></a></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="fu">## Why Imports Matter</span></span>
<span id="cb7-25"><a href="#cb7-25"></a></span>
<span id="cb7-26"><a href="#cb7-26"></a>Imports are the way EA connects to upstream sources of truth. In many</span>
<span id="cb7-27"><a href="#cb7-27"></a>organisations, architects are not the ones who originate requirements,</span>
<span id="cb7-28"><a href="#cb7-28"></a>applications, or datasets. Those live in other systems. EA is where they</span>
<span id="cb7-29"><a href="#cb7-29"></a>are curated, connected, and visualised.</span>
<span id="cb7-30"><a href="#cb7-30"></a></span>
<span id="cb7-31"><a href="#cb7-31"></a>For example:</span>
<span id="cb7-32"><a href="#cb7-32"></a></span>
<span id="cb7-33"><a href="#cb7-33"></a><span class="ss">- </span>Requirements authored in Jira need to be imported into EA for</span>
<span id="cb7-34"><a href="#cb7-34"></a>  traceability.</span>
<span id="cb7-35"><a href="#cb7-35"></a></span>
<span id="cb7-36"><a href="#cb7-36"></a><span class="ss">- </span>Application inventories stored in Excel need to be imported as</span>
<span id="cb7-37"><a href="#cb7-37"></a>  elements with tagged values.</span>
<span id="cb7-38"><a href="#cb7-38"></a></span>
<span id="cb7-39"><a href="#cb7-39"></a><span class="ss">- </span>Data elements defined in a registry need to be imported into EA’s</span>
<span id="cb7-40"><a href="#cb7-40"></a>  logical data model.</span>
<span id="cb7-41"><a href="#cb7-41"></a></span>
<span id="cb7-42"><a href="#cb7-42"></a>Without imports, EA risks becoming a disconnected silo. With imports, it</span>
<span id="cb7-43"><a href="#cb7-43"></a>becomes part of the wider enterprise information flow.</span>
<span id="cb7-44"><a href="#cb7-44"></a></span>
<span id="cb7-45"><a href="#cb7-45"></a><span class="fu">## Why Exports Matter</span></span>
<span id="cb7-46"><a href="#cb7-46"></a></span>
<span id="cb7-47"><a href="#cb7-47"></a>The opposite direction is just as important. Many stakeholders do not</span>
<span id="cb7-48"><a href="#cb7-48"></a>use EA directly. They expect to see outputs in Excel, JSON, Confluence,</span>
<span id="cb7-49"><a href="#cb7-49"></a>or dashboards. Exports make EA’s content consumable.</span>
<span id="cb7-50"><a href="#cb7-50"></a></span>
<span id="cb7-51"><a href="#cb7-51"></a>For example:</span>
<span id="cb7-52"><a href="#cb7-52"></a></span>
<span id="cb7-53"><a href="#cb7-53"></a><span class="ss">- </span>Exporting element inventories to CSV for analysis in Excel.</span>
<span id="cb7-54"><a href="#cb7-54"></a></span>
<span id="cb7-55"><a href="#cb7-55"></a><span class="ss">- </span>Exporting model metadata to JSON for loading into a data catalog.</span>
<span id="cb7-56"><a href="#cb7-56"></a></span>
<span id="cb7-57"><a href="#cb7-57"></a><span class="ss">- </span>Exporting governance reports to Confluence for project teams.</span>
<span id="cb7-58"><a href="#cb7-58"></a></span>
<span id="cb7-59"><a href="#cb7-59"></a>Exports also serve as safety tools: before running a script that</span>
<span id="cb7-60"><a href="#cb7-60"></a>modifies content, export a snapshot for comparison.</span>
<span id="cb7-61"><a href="#cb7-61"></a></span>
<span id="cb7-62"><a href="#cb7-62"></a><span class="fu">## The Round-Trip Challenge</span></span>
<span id="cb7-63"><a href="#cb7-63"></a></span>
<span id="cb7-64"><a href="#cb7-64"></a>In theory, import and export should be symmetrical: export, modify</span>
<span id="cb7-65"><a href="#cb7-65"></a>externally, import back. In practice, this is hard because of</span>
<span id="cb7-66"><a href="#cb7-66"></a>**identity**. How do you know that a row in CSV corresponds to the same</span>
<span id="cb7-67"><a href="#cb7-67"></a>element in EA?</span>
<span id="cb7-68"><a href="#cb7-68"></a></span>
<span id="cb7-69"><a href="#cb7-69"></a>If you match by name, duplicates are inevitable. If you match by ID, the</span>
<span id="cb7-70"><a href="#cb7-70"></a>ID may change across repositories. The robust solution is to use</span>
<span id="cb7-71"><a href="#cb7-71"></a>**GUIDs**. Every element, package, and connector in EA has a GUID. By</span>
<span id="cb7-72"><a href="#cb7-72"></a>exporting and re-importing GUIDs, you can round-trip reliably.</span>
<span id="cb7-73"><a href="#cb7-73"></a></span>
<span id="cb7-74"><a href="#cb7-74"></a>This chapter emphasises the importance of GUID handling in all</span>
<span id="cb7-75"><a href="#cb7-75"></a>import/export scripts.</span>
<span id="cb7-76"><a href="#cb7-76"></a></span>
<span id="cb7-77"><a href="#cb7-77"></a><span class="fu">## Common Pitfalls</span></span>
<span id="cb7-78"><a href="#cb7-78"></a></span>
<span id="cb7-79"><a href="#cb7-79"></a>Beginners often stumble into a few traps when writing import/export</span>
<span id="cb7-80"><a href="#cb7-80"></a>scripts:</span>
<span id="cb7-81"><a href="#cb7-81"></a></span>
<span id="cb7-82"><a href="#cb7-82"></a><span class="ss">- </span>**Duplicate creation**: forgetting to check if an element already</span>
<span id="cb7-83"><a href="#cb7-83"></a>  exists before creating a new one.</span>
<span id="cb7-84"><a href="#cb7-84"></a></span>
<span id="cb7-85"><a href="#cb7-85"></a><span class="ss">- </span>**Lost metadata**: exporting only names, not tags, stereotypes, or</span>
<span id="cb7-86"><a href="#cb7-86"></a>  relationships.</span>
<span id="cb7-87"><a href="#cb7-87"></a></span>
<span id="cb7-88"><a href="#cb7-88"></a><span class="ss">- </span>**Encoding errors**: CSV exports losing accented characters due to</span>
<span id="cb7-89"><a href="#cb7-89"></a>  ANSI encoding.</span>
<span id="cb7-90"><a href="#cb7-90"></a></span>
<span id="cb7-91"><a href="#cb7-91"></a><span class="ss">- </span>**Uncontrolled scope**: importing thousands of rows without dry-run or</span>
<span id="cb7-92"><a href="#cb7-92"></a>  logging.</span>
<span id="cb7-93"><a href="#cb7-93"></a></span>
<span id="cb7-94"><a href="#cb7-94"></a>Each of these pitfalls can damage model integrity. The patterns in this</span>
<span id="cb7-95"><a href="#cb7-95"></a>chapter address them with checks, dry-runs, and logs.</span>
<span id="cb7-96"><a href="#cb7-96"></a></span>
<span id="cb7-97"><a href="#cb7-97"></a><span class="fu">## Choosing a Format</span></span>
<span id="cb7-98"><a href="#cb7-98"></a></span>
<span id="cb7-99"><a href="#cb7-99"></a>The two most common formats for imports and exports are **CSV** and</span>
<span id="cb7-100"><a href="#cb7-100"></a>**JSON**.</span>
<span id="cb7-101"><a href="#cb7-101"></a></span>
<span id="cb7-102"><a href="#cb7-102"></a><span class="ss">- </span>**CSV** is simple, widely supported, and easy to review in Excel. It</span>
<span id="cb7-103"><a href="#cb7-103"></a>  works best for tabular data: lists of requirements, applications, or</span>
<span id="cb7-104"><a href="#cb7-104"></a>  tagged values.</span>
<span id="cb7-105"><a href="#cb7-105"></a></span>
<span id="cb7-106"><a href="#cb7-106"></a><span class="ss">- </span>**JSON** is richer, supporting nested structures and hierarchies. It</span>
<span id="cb7-107"><a href="#cb7-107"></a>  is more natural for hierarchical data, such as package trees or nested</span>
<span id="cb7-108"><a href="#cb7-108"></a>  attributes.</span>
<span id="cb7-109"><a href="#cb7-109"></a></span>
<span id="cb7-110"><a href="#cb7-110"></a>EA scripts can handle CSV easily using FileSystemObject. JSON is</span>
<span id="cb7-111"><a href="#cb7-111"></a>trickier because JScript lacks a parser, but you can still generate JSON</span>
<span id="cb7-112"><a href="#cb7-112"></a>strings. For parsing JSON, external automation (Python, C#) is usually</span>
<span id="cb7-113"><a href="#cb7-113"></a>better.</span>
<span id="cb7-114"><a href="#cb7-114"></a></span>
<span id="cb7-115"><a href="#cb7-115"></a><span class="fu">## GUIDs, Keys, and Identity</span></span>
<span id="cb7-116"><a href="#cb7-116"></a></span>
<span id="cb7-117"><a href="#cb7-117"></a>As mentioned earlier, GUIDs are the key to round-trip imports/exports.</span>
<span id="cb7-118"><a href="#cb7-118"></a>Best practice is:</span>
<span id="cb7-119"><a href="#cb7-119"></a></span>
<span id="cb7-120"><a href="#cb7-120"></a><span class="ss">- </span>**Always export the GUID** alongside names and types.</span>
<span id="cb7-121"><a href="#cb7-121"></a></span>
<span id="cb7-122"><a href="#cb7-122"></a><span class="ss">- </span>**When importing**, check if the GUID exists in EA. If yes, update. If</span>
<span id="cb7-123"><a href="#cb7-123"></a>  no, create.</span>
<span id="cb7-124"><a href="#cb7-124"></a></span>
<span id="cb7-125"><a href="#cb7-125"></a><span class="ss">- </span>**If GUIDs are absent** (e.g., external system), generate your own</span>
<span id="cb7-126"><a href="#cb7-126"></a>  external ID tag (e.g., JiraKey). Use this as the round-trip identity.</span>
<span id="cb7-127"><a href="#cb7-127"></a></span>
<span id="cb7-128"><a href="#cb7-128"></a>Scripts should never rely on element names alone for identity.</span>
<span id="cb7-129"><a href="#cb7-129"></a></span>
<span id="cb7-130"><a href="#cb7-130"></a><span class="fu">## Curated Imports</span></span>
<span id="cb7-131"><a href="#cb7-131"></a></span>
<span id="cb7-132"><a href="#cb7-132"></a>Another best practice is to **curate before commit**. Instead of blindly</span>
<span id="cb7-133"><a href="#cb7-133"></a>importing all rows, first log what would be created or updated. Write</span>
<span id="cb7-134"><a href="#cb7-134"></a>the proposed changes to a CSV, review them, then re-run the script with</span>
<span id="cb7-135"><a href="#cb7-135"></a>DRY_RUN = false.</span>
<span id="cb7-136"><a href="#cb7-136"></a></span>
<span id="cb7-137"><a href="#cb7-137"></a>This two-phase approach mirrors the “Curate-then-Write” pattern</span>
<span id="cb7-138"><a href="#cb7-138"></a>described in Chapter 7. It prevents surprises and builds trust in</span>
<span id="cb7-139"><a href="#cb7-139"></a>automation.</span>
<span id="cb7-140"><a href="#cb7-140"></a></span>
<span id="cb7-141"><a href="#cb7-141"></a><span class="fu">## Safety in Exports</span></span>
<span id="cb7-142"><a href="#cb7-142"></a></span>
<span id="cb7-143"><a href="#cb7-143"></a>Exports may feel safer than imports — after all, they don’t change EA.</span>
<span id="cb7-144"><a href="#cb7-144"></a>But they come with their own risks. An incomplete export can give</span>
<span id="cb7-145"><a href="#cb7-145"></a>stakeholders a misleading picture. An unfiltered export may expose</span>
<span id="cb7-146"><a href="#cb7-146"></a>sensitive data.</span>
<span id="cb7-147"><a href="#cb7-147"></a></span>
<span id="cb7-148"><a href="#cb7-148"></a>Safe export practices include:</span>
<span id="cb7-149"><a href="#cb7-149"></a></span>
<span id="cb7-150"><a href="#cb7-150"></a><span class="ss">- </span>Logging the scope of what was exported.</span>
<span id="cb7-151"><a href="#cb7-151"></a></span>
<span id="cb7-152"><a href="#cb7-152"></a><span class="ss">- </span>Including metadata fields like GUIDs, stereotypes, and tags.</span>
<span id="cb7-153"><a href="#cb7-153"></a></span>
<span id="cb7-154"><a href="#cb7-154"></a><span class="ss">- </span>Confirming encoding (e.g., use external Python for UTF-8).</span>
<span id="cb7-155"><a href="#cb7-155"></a></span>
<span id="cb7-156"><a href="#cb7-156"></a><span class="fu">## Integrating Imports/Exports into Workflows</span></span>
<span id="cb7-157"><a href="#cb7-157"></a></span>
<span id="cb7-158"><a href="#cb7-158"></a>Imports and exports are rarely ends in themselves. They usually form</span>
<span id="cb7-159"><a href="#cb7-159"></a>part of a wider workflow. For example:</span>
<span id="cb7-160"><a href="#cb7-160"></a></span>
<span id="cb7-161"><a href="#cb7-161"></a><span class="ss">1.  </span>Export application inventory from EA to CSV.</span>
<span id="cb7-162"><a href="#cb7-162"></a></span>
<span id="cb7-163"><a href="#cb7-163"></a><span class="ss">2.  </span>Send CSV to data owners for updates.</span>
<span id="cb7-164"><a href="#cb7-164"></a></span>
<span id="cb7-165"><a href="#cb7-165"></a><span class="ss">3.  </span>Import CSV back into EA with changes.</span>
<span id="cb7-166"><a href="#cb7-166"></a></span>
<span id="cb7-167"><a href="#cb7-167"></a>Or:</span>
<span id="cb7-168"><a href="#cb7-168"></a></span>
<span id="cb7-169"><a href="#cb7-169"></a><span class="ss">1.  </span>Import requirements from Jira.</span>
<span id="cb7-170"><a href="#cb7-170"></a></span>
<span id="cb7-171"><a href="#cb7-171"></a><span class="ss">2.  </span>Trace them to capabilities and applications in EA.</span>
<span id="cb7-172"><a href="#cb7-172"></a></span>
<span id="cb7-173"><a href="#cb7-173"></a><span class="ss">3.  </span>Export traceability report to Confluence.</span>
<span id="cb7-174"><a href="#cb7-174"></a></span>
<span id="cb7-175"><a href="#cb7-175"></a>Thinking of imports/exports as workflow steps encourages you to script</span>
<span id="cb7-176"><a href="#cb7-176"></a>them with logging, curation, and repeatability.</span>
<span id="cb7-177"><a href="#cb7-177"></a></span>
<span id="cb7-178"><a href="#cb7-178"></a><span class="fu">## What you’ll use</span></span>
<span id="cb7-179"><a href="#cb7-179"></a></span>
<span id="cb7-180"><a href="#cb7-180"></a>Inside EA: JScript (ES3), FileSystemObject, Excel.Application (ActiveX),</span>
<span id="cb7-181"><a href="#cb7-181"></a>EA API.</span>
<span id="cb7-182"><a href="#cb7-182"></a></span>
<span id="cb7-183"><a href="#cb7-183"></a>Outside EA: Python (pywin32) for JSON parsing and advanced integrations.</span>
<span id="cb7-184"><a href="#cb7-184"></a></span>
<span id="cb7-185"><a href="#cb7-185"></a>We’ll assume you have the **Shared Helpers** from Chapter 6</span>
<span id="cb7-186"><a href="#cb7-186"></a>(<span class="sc">\_</span>Common.Helpers) available: ensureOutputTab, browseForFolder,</span>
<span id="cb7-187"><a href="#cb7-187"></a>CsvWriter, string helpers, and nowMs().</span>
<span id="cb7-188"><a href="#cb7-188"></a></span>
<span id="cb7-189"><a href="#cb7-189"></a><span class="fu">### CSV Round-Trip (in-EA)</span></span>
<span id="cb7-190"><a href="#cb7-190"></a></span>
<span id="cb7-191"><a href="#cb7-191"></a>CSV is the simplest review format for non-technical stakeholders. The</span>
<span id="cb7-192"><a href="#cb7-192"></a>safest pattern is **two-phase**: export a proposal → humans curate in</span>
<span id="cb7-193"><a href="#cb7-193"></a>Excel → apply only rows marked “YES”.</span>
<span id="cb7-194"><a href="#cb7-194"></a></span>
<span id="cb7-195"><a href="#cb7-195"></a><span class="fu">### Export elements (recursive) to CSV</span></span>
<span id="cb7-196"><a href="#cb7-196"></a></span>
<span id="cb7-197"><a href="#cb7-197"></a><span class="in">```{.js filename="Example 9.1 - - ExportCSV_PackageRecursive.js – JScript (ES3)"}</span></span>
<span id="cb7-198"><a href="#cb7-198"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb7-199"><a href="#cb7-199"></a><span class="co">// Example 9.1 - ExportCSV_PackageRecursive.js – JScript (ES3)</span></span>
<span id="cb7-200"><a href="#cb7-200"></a><span class="co">// Purpose: Export elements of the selected package (and subpackages) to CSV</span></span>
<span id="cb7-201"><a href="#cb7-201"></a><span class="co">// Usage: Select a package in the Project Browser → run script</span></span>
<span id="cb7-202"><a href="#cb7-202"></a><span class="co">// Output: directory-only chooser; filename auto-derived</span></span>
<span id="cb7-203"><a href="#cb7-203"></a><span class="co">// Assumptions:</span></span>
<span id="cb7-204"><a href="#cb7-204"></a><span class="co">//   - ES3 only; EA collections use Count/GetAt(i)</span></span>
<span id="cb7-205"><a href="#cb7-205"></a><span class="co">//   - Includes key fields for round-trip (IDs, GUIDs, parent package)</span></span>
<span id="cb7-206"><a href="#cb7-206"></a><span class="co">// Dependencies: _Common.Helpers</span></span>
<span id="cb7-207"><a href="#cb7-207"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb7-208"><a href="#cb7-208"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb7-209"><a href="#cb7-209"></a><span class="op">!</span>INC _Common<span class="op">.</span><span class="at">Helpers</span></span>
<span id="cb7-210"><a href="#cb7-210"></a></span>
<span id="cb7-211"><a href="#cb7-211"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb7-212"><a href="#cb7-212"></a>    <span class="kw">var</span> TAB <span class="op">=</span> <span class="st">"ExportCSV"</span><span class="op">;</span></span>
<span id="cb7-213"><a href="#cb7-213"></a>    <span class="fu">ensureOutputTab</span>(TAB)<span class="op">;</span></span>
<span id="cb7-214"><a href="#cb7-214"></a></span>
<span id="cb7-215"><a href="#cb7-215"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb7-216"><a href="#cb7-216"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package to export."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb7-217"><a href="#cb7-217"></a></span>
<span id="cb7-218"><a href="#cb7-218"></a>    <span class="kw">var</span> outDir <span class="op">=</span> <span class="fu">browseForFolder</span>(<span class="st">"Select output folder (CSV)"</span>)<span class="op">;</span></span>
<span id="cb7-219"><a href="#cb7-219"></a>    <span class="cf">if</span> (<span class="op">!</span>outDir) { <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Cancelled."</span>)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb7-220"><a href="#cb7-220"></a></span>
<span id="cb7-221"><a href="#cb7-221"></a>    <span class="kw">var</span> stamp <span class="op">=</span> (<span class="kw">new</span> <span class="bu">Date</span>())<span class="op">.</span><span class="fu">getTime</span>()<span class="op">;</span></span>
<span id="cb7-222"><a href="#cb7-222"></a>    <span class="kw">var</span> path  <span class="op">=</span> outDir <span class="op">+</span> <span class="st">"</span><span class="sc">\\</span><span class="st">export_elements_"</span> <span class="op">+</span> <span class="fu">safeName</span>(pkg<span class="op">.</span><span class="at">Name</span>) <span class="op">+</span> <span class="st">"_"</span> <span class="op">+</span> stamp <span class="op">+</span> <span class="st">".csv"</span><span class="op">;</span></span>
<span id="cb7-223"><a href="#cb7-223"></a>    <span class="kw">var</span> csv   <span class="op">=</span> <span class="kw">new</span> <span class="fu">CsvWriter</span>(path)<span class="op">;</span></span>
<span id="cb7-224"><a href="#cb7-224"></a>    csv<span class="op">.</span><span class="fu">writeHeader</span>(<span class="st">"Apply,ElementID,GUID,PackageID,PackageName,Name,Type,Stereotype,Status,Notes"</span>)<span class="op">;</span></span>
<span id="cb7-225"><a href="#cb7-225"></a></span>
<span id="cb7-226"><a href="#cb7-226"></a>    <span class="kw">var</span> count <span class="op">=</span> <span class="fu">walkPackage</span>(pkg<span class="op">,</span> <span class="kw">function</span>(el<span class="op">,</span> p) {</span>
<span id="cb7-227"><a href="#cb7-227"></a>        csv<span class="op">.</span><span class="fu">writeRow</span>([</span>
<span id="cb7-228"><a href="#cb7-228"></a>            <span class="st">"NO"</span><span class="op">,</span>                    <span class="co">// Apply = NO by default (curate later)</span></span>
<span id="cb7-229"><a href="#cb7-229"></a>            el<span class="op">.</span><span class="at">ElementID</span><span class="op">,</span></span>
<span id="cb7-230"><a href="#cb7-230"></a>            el<span class="op">.</span><span class="at">ElementGUID</span><span class="op">,</span></span>
<span id="cb7-231"><a href="#cb7-231"></a>            p<span class="op">.</span><span class="at">PackageID</span><span class="op">,</span></span>
<span id="cb7-232"><a href="#cb7-232"></a>            p<span class="op">.</span><span class="at">Name</span><span class="op">,</span></span>
<span id="cb7-233"><a href="#cb7-233"></a>            el<span class="op">.</span><span class="at">Name</span><span class="op">,</span></span>
<span id="cb7-234"><a href="#cb7-234"></a>            el<span class="op">.</span><span class="at">Type</span><span class="op">,</span></span>
<span id="cb7-235"><a href="#cb7-235"></a>            <span class="bu">String</span>(el<span class="op">.</span><span class="at">Stereotype</span><span class="op">||</span><span class="st">""</span>)<span class="op">,</span></span>
<span id="cb7-236"><a href="#cb7-236"></a>            <span class="bu">String</span>(el<span class="op">.</span><span class="at">Status</span><span class="op">||</span><span class="st">""</span>)<span class="op">,</span></span>
<span id="cb7-237"><a href="#cb7-237"></a>            <span class="fu">sanitize</span>(el<span class="op">.</span><span class="at">Notes</span>)</span>
<span id="cb7-238"><a href="#cb7-238"></a>        ])<span class="op">;</span></span>
<span id="cb7-239"><a href="#cb7-239"></a>    })<span class="op">;</span></span>
<span id="cb7-240"><a href="#cb7-240"></a></span>
<span id="cb7-241"><a href="#cb7-241"></a>    csv<span class="op">.</span><span class="fu">close</span>()<span class="op">;</span></span>
<span id="cb7-242"><a href="#cb7-242"></a>    <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Exported "</span> <span class="op">+</span> count <span class="op">+</span> <span class="st">" element(s) → "</span> <span class="op">+</span> path)<span class="op">;</span></span>
<span id="cb7-243"><a href="#cb7-243"></a>}</span>
<span id="cb7-244"><a href="#cb7-244"></a></span>
<span id="cb7-245"><a href="#cb7-245"></a><span class="kw">function</span> <span class="fu">walkPackage</span>(pkg<span class="op">,</span> onElement) {</span>
<span id="cb7-246"><a href="#cb7-246"></a>    <span class="kw">var</span> n <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> i<span class="op">;</span></span>
<span id="cb7-247"><a href="#cb7-247"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb7-248"><a href="#cb7-248"></a>    <span class="cf">for</span> (i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb7-249"><a href="#cb7-249"></a>        <span class="fu">onElement</span>(els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">,</span> pkg)<span class="op">;</span> n<span class="op">++;</span></span>
<span id="cb7-250"><a href="#cb7-250"></a>    }</span>
<span id="cb7-251"><a href="#cb7-251"></a>    <span class="kw">var</span> kids <span class="op">=</span> pkg<span class="op">.</span><span class="at">Packages</span><span class="op">;</span></span>
<span id="cb7-252"><a href="#cb7-252"></a>    <span class="cf">for</span> (i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>kids<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb7-253"><a href="#cb7-253"></a>        n <span class="op">+=</span> <span class="fu">walkPackage</span>(kids<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">,</span> onElement)<span class="op">;</span></span>
<span id="cb7-254"><a href="#cb7-254"></a>    }</span>
<span id="cb7-255"><a href="#cb7-255"></a>    <span class="cf">return</span> n<span class="op">;</span></span>
<span id="cb7-256"><a href="#cb7-256"></a>}</span>
<span id="cb7-257"><a href="#cb7-257"></a></span>
<span id="cb7-258"><a href="#cb7-258"></a><span class="kw">function</span> <span class="fu">sanitize</span>(s) {</span>
<span id="cb7-259"><a href="#cb7-259"></a>    <span class="co">// Compress newlines for CSV readability (optional)</span></span>
<span id="cb7-260"><a href="#cb7-260"></a>    s <span class="op">=</span> <span class="bu">String</span>(s<span class="op">||</span><span class="st">""</span>)<span class="op">;</span></span>
<span id="cb7-261"><a href="#cb7-261"></a>    s <span class="op">=</span> s<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\r\n</span><span class="ss">/g</span><span class="op">,</span> <span class="st">" "</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\n</span><span class="ss">/g</span><span class="op">,</span> <span class="st">" "</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\r</span><span class="ss">/g</span><span class="op">,</span> <span class="st">" "</span>)<span class="op">;</span></span>
<span id="cb7-262"><a href="#cb7-262"></a>    <span class="cf">return</span> s<span class="op">;</span></span>
<span id="cb7-263"><a href="#cb7-263"></a>}</span>
<span id="cb7-264"><a href="#cb7-264"></a><span class="kw">function</span> <span class="fu">safeName</span>(s) { <span class="cf">return</span> <span class="bu">String</span>(s<span class="op">||</span><span class="st">""</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">[^A-Za-z0-9_]+</span><span class="ss">/g</span><span class="op">,</span> <span class="st">"_"</span>)<span class="op">;</span> }</span>
<span id="cb7-265"><a href="#cb7-265"></a></span>
<span id="cb7-266"><a href="#cb7-266"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb7-267"><a href="#cb7-267"></a><span class="in">```</span></span>
<span id="cb7-268"><a href="#cb7-268"></a></span>
<span id="cb7-269"><a href="#cb7-269"></a><span class="fu">### Apply curated CSV to update elements</span></span>
<span id="cb7-270"><a href="#cb7-270"></a></span>
<span id="cb7-271"><a href="#cb7-271"></a>CSV edited by humans is brittle; we keep parsing simple and only support</span>
<span id="cb7-272"><a href="#cb7-272"></a>a few controlled changes. We’ll update Name, Stereotype, Status, and</span>
<span id="cb7-273"><a href="#cb7-273"></a>optionally one tag**ged value** (e.g., Owner). Only rows with Apply=YES</span>
<span id="cb7-274"><a href="#cb7-274"></a>will execute.</span>
<span id="cb7-275"><a href="#cb7-275"></a></span>
<span id="cb7-276"><a href="#cb7-276"></a><span class="in">```{.js filename="Example 9.2 - ImportCSV_UpdateElements.js – JScript (ES3)"}</span></span>
<span id="cb7-277"><a href="#cb7-277"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb7-278"><a href="#cb7-278"></a><span class="co">// Example 9.2 - ImportCSV_UpdateElements.js – JScript (ES3)</span></span>
<span id="cb7-279"><a href="#cb7-279"></a><span class="co">// Purpose: Apply curated updates to elements from a CSV (round-trip)</span></span>
<span id="cb7-280"><a href="#cb7-280"></a><span class="co">// Usage: Place curated CSV in a folder → run script → pick folder</span></span>
<span id="cb7-281"><a href="#cb7-281"></a><span class="co">// Safety: Only Apply=YES rows are executed; ElementID/GUID matching</span></span>
<span id="cb7-282"><a href="#cb7-282"></a><span class="co">// Dependencies: _Common.Helpers</span></span>
<span id="cb7-283"><a href="#cb7-283"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb7-284"><a href="#cb7-284"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb7-285"><a href="#cb7-285"></a><span class="op">!</span>INC _Common<span class="op">.</span><span class="at">Helpers</span></span>
<span id="cb7-286"><a href="#cb7-286"></a></span>
<span id="cb7-287"><a href="#cb7-287"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb7-288"><a href="#cb7-288"></a>    <span class="kw">var</span> TAB <span class="op">=</span> <span class="st">"ImportCSV"</span><span class="op">;</span></span>
<span id="cb7-289"><a href="#cb7-289"></a>    <span class="fu">ensureOutputTab</span>(TAB)<span class="op">;</span></span>
<span id="cb7-290"><a href="#cb7-290"></a></span>
<span id="cb7-291"><a href="#cb7-291"></a>    <span class="kw">var</span> dir <span class="op">=</span> <span class="fu">browseForFolder</span>(<span class="st">"Select folder containing curated CSV (export_elements_*.csv)"</span>)<span class="op">;</span></span>
<span id="cb7-292"><a href="#cb7-292"></a>    <span class="cf">if</span> (<span class="op">!</span>dir) { <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Cancelled."</span>)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb7-293"><a href="#cb7-293"></a></span>
<span id="cb7-294"><a href="#cb7-294"></a>    <span class="kw">var</span> file <span class="op">=</span> <span class="fu">newestCsv</span>(dir<span class="op">,</span> <span class="st">"export_elements_"</span>)<span class="op">;</span></span>
<span id="cb7-295"><a href="#cb7-295"></a>    <span class="cf">if</span> (<span class="op">!</span>file) { <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"No matching CSV found."</span>)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb7-296"><a href="#cb7-296"></a>    <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Applying from: "</span> <span class="op">+</span> file<span class="op">.</span><span class="at">Path</span>)<span class="op">;</span></span>
<span id="cb7-297"><a href="#cb7-297"></a></span>
<span id="cb7-298"><a href="#cb7-298"></a>    <span class="kw">var</span> fso <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Scripting.FileSystemObject"</span>)<span class="op">;</span></span>
<span id="cb7-299"><a href="#cb7-299"></a>    <span class="kw">var</span> ts  <span class="op">=</span> fso<span class="op">.</span><span class="fu">OpenTextFile</span>(file<span class="op">.</span><span class="at">Path</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span> <span class="co">// ForReading</span></span>
<span id="cb7-300"><a href="#cb7-300"></a>    <span class="cf">if</span> (<span class="op">!</span>ts<span class="op">.</span><span class="at">AtEndOfStream</span>) ts<span class="op">.</span><span class="fu">ReadLine</span>()<span class="op">;</span>     <span class="co">// skip header</span></span>
<span id="cb7-301"><a href="#cb7-301"></a></span>
<span id="cb7-302"><a href="#cb7-302"></a>    <span class="kw">var</span> applied<span class="op">=</span><span class="dv">0</span><span class="op">,</span> considered<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-303"><a href="#cb7-303"></a>    <span class="cf">while</span> (<span class="op">!</span>ts<span class="op">.</span><span class="at">AtEndOfStream</span>) {</span>
<span id="cb7-304"><a href="#cb7-304"></a>        <span class="kw">var</span> line  <span class="op">=</span> ts<span class="op">.</span><span class="fu">ReadLine</span>()<span class="op">;</span></span>
<span id="cb7-305"><a href="#cb7-305"></a>        <span class="cf">if</span> (<span class="fu">trim</span>(line) <span class="op">===</span> <span class="st">""</span>) <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb7-306"><a href="#cb7-306"></a>        <span class="kw">var</span> cells <span class="op">=</span> <span class="fu">splitCsvLine</span>(line)<span class="op">;</span>       <span class="co">// naive split (works if reviewers avoided stray commas)</span></span>
<span id="cb7-307"><a href="#cb7-307"></a></span>
<span id="cb7-308"><a href="#cb7-308"></a>        <span class="co">// Expected header: Apply,ElementID,GUID,PackageID,PackageName,Name,Type,Stereotype,Status,Notes</span></span>
<span id="cb7-309"><a href="#cb7-309"></a>        <span class="kw">var</span> apply    <span class="op">=</span> <span class="fu">trim</span>(<span class="fu">getCell</span>(cells<span class="op">,</span><span class="dv">0</span>))<span class="op">;</span></span>
<span id="cb7-310"><a href="#cb7-310"></a>        <span class="kw">var</span> elementID<span class="op">=</span> <span class="pp">parseInt</span>(<span class="fu">getCell</span>(cells<span class="op">,</span><span class="dv">1</span>)<span class="op">,</span><span class="dv">10</span>)<span class="op">;</span></span>
<span id="cb7-311"><a href="#cb7-311"></a>        <span class="kw">var</span> guid     <span class="op">=</span> <span class="fu">trim</span>(<span class="fu">getCell</span>(cells<span class="op">,</span><span class="dv">2</span>))<span class="op">;</span></span>
<span id="cb7-312"><a href="#cb7-312"></a>        <span class="kw">var</span> newName  <span class="op">=</span> <span class="fu">trim</span>(<span class="fu">getCell</span>(cells<span class="op">,</span><span class="dv">5</span>))<span class="op">;</span></span>
<span id="cb7-313"><a href="#cb7-313"></a>        <span class="kw">var</span> newStereo<span class="op">=</span> <span class="fu">trim</span>(<span class="fu">getCell</span>(cells<span class="op">,</span><span class="dv">7</span>))<span class="op">;</span></span>
<span id="cb7-314"><a href="#cb7-314"></a>        <span class="kw">var</span> newStatus<span class="op">=</span> <span class="fu">trim</span>(<span class="fu">getCell</span>(cells<span class="op">,</span><span class="dv">8</span>))<span class="op">;</span></span>
<span id="cb7-315"><a href="#cb7-315"></a></span>
<span id="cb7-316"><a href="#cb7-316"></a>        considered<span class="op">++;</span></span>
<span id="cb7-317"><a href="#cb7-317"></a></span>
<span id="cb7-318"><a href="#cb7-318"></a>        <span class="cf">if</span> (<span class="fu">equalsIgnoreCase</span>(apply<span class="op">,</span><span class="st">"YES"</span>)) {</span>
<span id="cb7-319"><a href="#cb7-319"></a>            <span class="kw">var</span> el <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb7-320"><a href="#cb7-320"></a>            <span class="co">// Prefer GUID match if provided</span></span>
<span id="cb7-321"><a href="#cb7-321"></a>            <span class="cf">if</span> (guid <span class="op">!==</span> <span class="st">""</span>) {</span>
<span id="cb7-322"><a href="#cb7-322"></a>                el <span class="op">=</span> Repository<span class="op">.</span><span class="at">GetElementByGuid</span> <span class="op">?</span> Repository<span class="op">.</span><span class="fu">GetElementByGuid</span>(guid) <span class="op">:</span> Repository<span class="op">.</span><span class="fu">GetElementByGUID</span>(guid)<span class="op">;</span></span>
<span id="cb7-323"><a href="#cb7-323"></a>            }</span>
<span id="cb7-324"><a href="#cb7-324"></a>            <span class="cf">if</span> (<span class="op">!</span>el <span class="op">&amp;&amp;</span> elementID <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb7-325"><a href="#cb7-325"></a>                el <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetElementByID</span>(elementID)<span class="op">;</span></span>
<span id="cb7-326"><a href="#cb7-326"></a>            }</span>
<span id="cb7-327"><a href="#cb7-327"></a>            <span class="cf">if</span> (<span class="op">!</span>el) { <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Row skipped: element not found (GUID="</span><span class="op">+</span>guid<span class="op">+</span><span class="st">" ID="</span><span class="op">+</span>elementID<span class="op">+</span><span class="st">")"</span>)<span class="op">;</span> <span class="cf">continue</span><span class="op">;</span> }</span>
<span id="cb7-328"><a href="#cb7-328"></a></span>
<span id="cb7-329"><a href="#cb7-329"></a>            <span class="kw">var</span> dirty <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb7-330"><a href="#cb7-330"></a>            <span class="cf">if</span> (newName <span class="op">!==</span> <span class="st">""</span> <span class="op">&amp;&amp;</span> el<span class="op">.</span><span class="at">Name</span> <span class="op">!=</span> newName) { el<span class="op">.</span><span class="at">Name</span> <span class="op">=</span> newName<span class="op">;</span> dirty <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> }</span>
<span id="cb7-331"><a href="#cb7-331"></a>            <span class="cf">if</span> (newStereo <span class="op">!==</span> <span class="st">""</span> <span class="op">&amp;&amp;</span> <span class="bu">String</span>(el<span class="op">.</span><span class="at">Stereotype</span><span class="op">||</span><span class="st">""</span>) <span class="op">!=</span> newStereo) { el<span class="op">.</span><span class="at">Stereotype</span> <span class="op">=</span> newStereo<span class="op">;</span> dirty <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> }</span>
<span id="cb7-332"><a href="#cb7-332"></a>            <span class="cf">if</span> (newStatus <span class="op">!==</span> <span class="st">""</span> <span class="op">&amp;&amp;</span> <span class="bu">String</span>(el<span class="op">.</span><span class="at">Status</span><span class="op">||</span><span class="st">""</span>) <span class="op">!=</span> newStatus) { el<span class="op">.</span><span class="at">Status</span> <span class="op">=</span> newStatus<span class="op">;</span> dirty <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> }</span>
<span id="cb7-333"><a href="#cb7-333"></a></span>
<span id="cb7-334"><a href="#cb7-334"></a>            <span class="cf">if</span> (dirty) { el<span class="op">.</span><span class="fu">Update</span>()<span class="op">;</span> applied<span class="op">++;</span> }</span>
<span id="cb7-335"><a href="#cb7-335"></a>        }</span>
<span id="cb7-336"><a href="#cb7-336"></a>    }</span>
<span id="cb7-337"><a href="#cb7-337"></a>    ts<span class="op">.</span><span class="fu">Close</span>()<span class="op">;</span></span>
<span id="cb7-338"><a href="#cb7-338"></a></span>
<span id="cb7-339"><a href="#cb7-339"></a>    <span class="cf">if</span> (applied<span class="op">&gt;</span><span class="dv">0</span>) Repository<span class="op">.</span><span class="fu">RefreshModelView</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb7-340"><a href="#cb7-340"></a>    <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Applied "</span> <span class="op">+</span> applied <span class="op">+</span> <span class="st">" curated change(s) out of "</span> <span class="op">+</span> considered <span class="op">+</span> <span class="st">" row(s)."</span>)<span class="op">;</span></span>
<span id="cb7-341"><a href="#cb7-341"></a>}</span>
<span id="cb7-342"><a href="#cb7-342"></a></span>
<span id="cb7-343"><a href="#cb7-343"></a><span class="co">// Return newest CSV whose name starts with prefix</span></span>
<span id="cb7-344"><a href="#cb7-344"></a><span class="kw">function</span> <span class="fu">newestCsv</span>(dir<span class="op">,</span> prefix) {</span>
<span id="cb7-345"><a href="#cb7-345"></a>    <span class="kw">var</span> fso <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Scripting.FileSystemObject"</span>)<span class="op">;</span></span>
<span id="cb7-346"><a href="#cb7-346"></a>    <span class="kw">var</span> folder <span class="op">=</span> fso<span class="op">.</span><span class="fu">GetFolder</span>(dir)<span class="op">;</span></span>
<span id="cb7-347"><a href="#cb7-347"></a>    <span class="kw">var</span> en <span class="op">=</span> <span class="kw">new</span> <span class="fu">Enumerator</span>(folder<span class="op">.</span><span class="at">Files</span>)<span class="op">;</span></span>
<span id="cb7-348"><a href="#cb7-348"></a>    <span class="kw">var</span> newest<span class="op">=</span><span class="kw">null</span><span class="op">,</span> t<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-349"><a href="#cb7-349"></a>    <span class="cf">for</span> (<span class="op">;</span> <span class="op">!</span>en<span class="op">.</span><span class="fu">atEnd</span>()<span class="op">;</span> en<span class="op">.</span><span class="fu">moveNext</span>()) {</span>
<span id="cb7-350"><a href="#cb7-350"></a>        <span class="kw">var</span> f <span class="op">=</span> en<span class="op">.</span><span class="fu">item</span>()<span class="op">;</span></span>
<span id="cb7-351"><a href="#cb7-351"></a>        <span class="cf">if</span> (<span class="fu">endsWith</span>(f<span class="op">.</span><span class="at">Name</span><span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">,</span> <span class="st">".csv"</span>) <span class="op">&amp;&amp;</span> <span class="fu">startsWith</span>(f<span class="op">.</span><span class="at">Name</span><span class="op">,</span> prefix)) {</span>
<span id="cb7-352"><a href="#cb7-352"></a>            <span class="kw">var</span> m <span class="op">=</span> f<span class="op">.</span><span class="at">DateLastModified</span><span class="op">.</span><span class="fu">getTime</span>()<span class="op">;</span></span>
<span id="cb7-353"><a href="#cb7-353"></a>            <span class="cf">if</span> (m <span class="op">&gt;</span> t) { newest<span class="op">=</span>f<span class="op">;</span> t<span class="op">=</span>m<span class="op">;</span> }</span>
<span id="cb7-354"><a href="#cb7-354"></a>        }</span>
<span id="cb7-355"><a href="#cb7-355"></a>    }</span>
<span id="cb7-356"><a href="#cb7-356"></a>    <span class="cf">return</span> newest<span class="op">;</span></span>
<span id="cb7-357"><a href="#cb7-357"></a>}</span>
<span id="cb7-358"><a href="#cb7-358"></a></span>
<span id="cb7-359"><a href="#cb7-359"></a><span class="co">// Very simple CSV splitting (assumes reviewers didn’t add embedded commas/quotes)</span></span>
<span id="cb7-360"><a href="#cb7-360"></a><span class="kw">function</span> <span class="fu">splitCsvLine</span>(line) { <span class="cf">return</span> line<span class="op">.</span><span class="fu">split</span>(<span class="st">","</span>)<span class="op">;</span> }</span>
<span id="cb7-361"><a href="#cb7-361"></a><span class="kw">function</span> <span class="fu">getCell</span>(arr<span class="op">,</span> idx) { <span class="cf">return</span> idx <span class="op">&lt;</span> arr<span class="op">.</span><span class="at">length</span> <span class="op">?</span> arr[idx] <span class="op">:</span> <span class="st">""</span><span class="op">;</span> }</span>
<span id="cb7-362"><a href="#cb7-362"></a><span class="kw">function</span> <span class="fu">endsWith</span>(s<span class="op">,</span> suffix){ s<span class="op">=</span><span class="bu">String</span>(s<span class="op">||</span><span class="st">""</span>)<span class="op">;</span> <span class="kw">var</span> i<span class="op">=</span>s<span class="op">.</span><span class="fu">lastIndexOf</span>(suffix)<span class="op">;</span> <span class="cf">return</span> i<span class="op">&gt;=</span><span class="dv">0</span> <span class="op">&amp;&amp;</span> (i<span class="op">+</span>suffix<span class="op">.</span><span class="at">length</span><span class="op">===</span>s<span class="op">.</span><span class="at">length</span>)<span class="op">;</span> }</span>
<span id="cb7-363"><a href="#cb7-363"></a></span>
<span id="cb7-364"><a href="#cb7-364"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb7-365"><a href="#cb7-365"></a><span class="in">```</span></span>
<span id="cb7-366"><a href="#cb7-366"></a></span>
<span id="cb7-367"><a href="#cb7-367"></a>**Tip**: If you must support commas/quotes in curated text, switch to</span>
<span id="cb7-368"><a href="#cb7-368"></a>the **external Python importer** in §8.4; it uses the csv module to</span>
<span id="cb7-369"><a href="#cb7-369"></a>parse safely.</span>
<span id="cb7-370"><a href="#cb7-370"></a></span>
<span id="cb7-371"><a href="#cb7-371"></a><span class="fu">### Excel via COM (in-EA)</span></span>
<span id="cb7-372"><a href="#cb7-372"></a></span>
<span id="cb7-373"><a href="#cb7-373"></a>Sometimes you must deliver a real **.xlsx** instead of a CSV. You can</span>
<span id="cb7-374"><a href="#cb7-374"></a>drive Excel via ActiveX.</span>
<span id="cb7-375"><a href="#cb7-375"></a></span>
<span id="cb7-376"><a href="#cb7-376"></a>**Export to Excel (.xlsx)**</span>
<span id="cb7-377"><a href="#cb7-377"></a></span>
<span id="cb7-378"><a href="#cb7-378"></a><span class="in">```{.js filename="Example 9.3 - ExportExcel_PackageSimple.js – JScript (ES3)"}</span></span>
<span id="cb7-379"><a href="#cb7-379"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb7-380"><a href="#cb7-380"></a><span class="co">// Example 9.3 - ExportExcel_PackageSimple.js – JScript (ES3)</span></span>
<span id="cb7-381"><a href="#cb7-381"></a><span class="co">// Purpose: Write selected package elements to an .xlsx via Excel COM</span></span>
<span id="cb7-382"><a href="#cb7-382"></a><span class="co">// Usage: Select a package → run script → pick output folder</span></span>
<span id="cb7-383"><a href="#cb7-383"></a><span class="co">// Requirements: Microsoft Excel installed (same bitness as EA)</span></span>
<span id="cb7-384"><a href="#cb7-384"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb7-385"><a href="#cb7-385"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb7-386"><a href="#cb7-386"></a><span class="op">!</span>INC _Common<span class="op">.</span><span class="at">Helpers</span></span>
<span id="cb7-387"><a href="#cb7-387"></a></span>
<span id="cb7-388"><a href="#cb7-388"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb7-389"><a href="#cb7-389"></a>    <span class="kw">var</span> TAB <span class="op">=</span> <span class="st">"ExportExcel"</span><span class="op">;</span></span>
<span id="cb7-390"><a href="#cb7-390"></a>    <span class="fu">ensureOutputTab</span>(TAB)<span class="op">;</span></span>
<span id="cb7-391"><a href="#cb7-391"></a></span>
<span id="cb7-392"><a href="#cb7-392"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb7-393"><a href="#cb7-393"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb7-394"><a href="#cb7-394"></a></span>
<span id="cb7-395"><a href="#cb7-395"></a>    <span class="kw">var</span> outDir <span class="op">=</span> <span class="fu">browseForFolder</span>(<span class="st">"Select output folder (.xlsx)"</span>)<span class="op">;</span></span>
<span id="cb7-396"><a href="#cb7-396"></a>    <span class="cf">if</span> (<span class="op">!</span>outDir) { <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Cancelled."</span>)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb7-397"><a href="#cb7-397"></a></span>
<span id="cb7-398"><a href="#cb7-398"></a>    <span class="kw">var</span> stamp <span class="op">=</span> (<span class="kw">new</span> <span class="bu">Date</span>())<span class="op">.</span><span class="fu">getTime</span>()<span class="op">;</span></span>
<span id="cb7-399"><a href="#cb7-399"></a>    <span class="kw">var</span> filePath <span class="op">=</span> outDir <span class="op">+</span> <span class="st">"</span><span class="sc">\\</span><span class="st">export_"</span> <span class="op">+</span> <span class="fu">safeName</span>(pkg<span class="op">.</span><span class="at">Name</span>) <span class="op">+</span> <span class="st">"_"</span> <span class="op">+</span> stamp <span class="op">+</span> <span class="st">".xlsx"</span><span class="op">;</span></span>
<span id="cb7-400"><a href="#cb7-400"></a></span>
<span id="cb7-401"><a href="#cb7-401"></a>    <span class="kw">var</span> xl <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Excel.Application"</span>)<span class="op">;</span></span>
<span id="cb7-402"><a href="#cb7-402"></a>    xl<span class="op">.</span><span class="at">Visible</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb7-403"><a href="#cb7-403"></a>    <span class="kw">var</span> wb <span class="op">=</span> xl<span class="op">.</span><span class="at">Workbooks</span><span class="op">.</span><span class="fu">Add</span>()<span class="op">;</span></span>
<span id="cb7-404"><a href="#cb7-404"></a>    <span class="kw">var</span> ws <span class="op">=</span> wb<span class="op">.</span><span class="at">ActiveSheet</span><span class="op">;</span></span>
<span id="cb7-405"><a href="#cb7-405"></a>    ws<span class="op">.</span><span class="at">Name</span> <span class="op">=</span> <span class="st">"Elements"</span><span class="op">;</span></span>
<span id="cb7-406"><a href="#cb7-406"></a></span>
<span id="cb7-407"><a href="#cb7-407"></a>    <span class="co">// Header</span></span>
<span id="cb7-408"><a href="#cb7-408"></a>    ws<span class="op">.</span><span class="fu">Cells</span>(<span class="dv">1</span><span class="op">,</span><span class="dv">1</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> <span class="st">"ElementID"</span><span class="op">;</span></span>
<span id="cb7-409"><a href="#cb7-409"></a>    ws<span class="op">.</span><span class="fu">Cells</span>(<span class="dv">1</span><span class="op">,</span><span class="dv">2</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> <span class="st">"GUID"</span><span class="op">;</span></span>
<span id="cb7-410"><a href="#cb7-410"></a>    ws<span class="op">.</span><span class="fu">Cells</span>(<span class="dv">1</span><span class="op">,</span><span class="dv">3</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> <span class="st">"Name"</span><span class="op">;</span></span>
<span id="cb7-411"><a href="#cb7-411"></a>    ws<span class="op">.</span><span class="fu">Cells</span>(<span class="dv">1</span><span class="op">,</span><span class="dv">4</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> <span class="st">"Type"</span><span class="op">;</span></span>
<span id="cb7-412"><a href="#cb7-412"></a>    ws<span class="op">.</span><span class="fu">Cells</span>(<span class="dv">1</span><span class="op">,</span><span class="dv">5</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> <span class="st">"Stereotype"</span><span class="op">;</span></span>
<span id="cb7-413"><a href="#cb7-413"></a></span>
<span id="cb7-414"><a href="#cb7-414"></a>    <span class="kw">var</span> r <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb7-415"><a href="#cb7-415"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb7-416"><a href="#cb7-416"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++,</span> r<span class="op">++</span>) {</span>
<span id="cb7-417"><a href="#cb7-417"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb7-418"><a href="#cb7-418"></a>        ws<span class="op">.</span><span class="fu">Cells</span>(r<span class="op">,</span><span class="dv">1</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> e<span class="op">.</span><span class="at">ElementID</span><span class="op">;</span></span>
<span id="cb7-419"><a href="#cb7-419"></a>        ws<span class="op">.</span><span class="fu">Cells</span>(r<span class="op">,</span><span class="dv">2</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> e<span class="op">.</span><span class="at">ElementGUID</span><span class="op">;</span></span>
<span id="cb7-420"><a href="#cb7-420"></a>        ws<span class="op">.</span><span class="fu">Cells</span>(r<span class="op">,</span><span class="dv">3</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> e<span class="op">.</span><span class="at">Name</span><span class="op">;</span></span>
<span id="cb7-421"><a href="#cb7-421"></a>        ws<span class="op">.</span><span class="fu">Cells</span>(r<span class="op">,</span><span class="dv">4</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> e<span class="op">.</span><span class="at">Type</span><span class="op">;</span></span>
<span id="cb7-422"><a href="#cb7-422"></a>        ws<span class="op">.</span><span class="fu">Cells</span>(r<span class="op">,</span><span class="dv">5</span>)<span class="op">.</span><span class="at">Value</span> <span class="op">=</span> <span class="bu">String</span>(e<span class="op">.</span><span class="at">Stereotype</span><span class="op">||</span><span class="st">""</span>)<span class="op">;</span></span>
<span id="cb7-423"><a href="#cb7-423"></a>    }</span>
<span id="cb7-424"><a href="#cb7-424"></a></span>
<span id="cb7-425"><a href="#cb7-425"></a>    <span class="co">// Autosize</span></span>
<span id="cb7-426"><a href="#cb7-426"></a>    ws<span class="op">.</span><span class="at">Columns</span><span class="op">.</span><span class="fu">AutoFit</span>()<span class="op">;</span></span>
<span id="cb7-427"><a href="#cb7-427"></a></span>
<span id="cb7-428"><a href="#cb7-428"></a>    <span class="co">// Save and clean up</span></span>
<span id="cb7-429"><a href="#cb7-429"></a>    wb<span class="op">.</span><span class="fu">SaveAs</span>(filePath)<span class="op">;</span></span>
<span id="cb7-430"><a href="#cb7-430"></a>    wb<span class="op">.</span><span class="fu">Close</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb7-431"><a href="#cb7-431"></a>    xl<span class="op">.</span><span class="fu">Quit</span>()<span class="op">;</span></span>
<span id="cb7-432"><a href="#cb7-432"></a></span>
<span id="cb7-433"><a href="#cb7-433"></a>    wb <span class="op">=</span> <span class="kw">null</span><span class="op">;</span> ws <span class="op">=</span> <span class="kw">null</span><span class="op">;</span> xl <span class="op">=</span> <span class="kw">null</span><span class="op">;</span> <span class="co">// release COM references</span></span>
<span id="cb7-434"><a href="#cb7-434"></a>    <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Excel written → "</span> <span class="op">+</span> filePath)<span class="op">;</span></span>
<span id="cb7-435"><a href="#cb7-435"></a>}</span>
<span id="cb7-436"><a href="#cb7-436"></a><span class="kw">function</span> <span class="fu">safeName</span>(s){ <span class="cf">return</span> <span class="bu">String</span>(s<span class="op">||</span><span class="st">""</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">[^A-Za-z0-9_]+</span><span class="ss">/g</span><span class="op">,</span><span class="st">"_"</span>)<span class="op">;</span> }</span>
<span id="cb7-437"><a href="#cb7-437"></a></span>
<span id="cb7-438"><a href="#cb7-438"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb7-439"><a href="#cb7-439"></a><span class="in">```</span></span>
<span id="cb7-440"><a href="#cb7-440"></a></span>
<span id="cb7-441"><a href="#cb7-441"></a>**Note**: Reading **from** Excel in JScript is also possible (open</span>
<span id="cb7-442"><a href="#cb7-442"></a>workbook, loop rows until blank). For reliability and parsing</span>
<span id="cb7-443"><a href="#cb7-443"></a>complexity, prefer CSV for imports, or use the Python importer below.</span>
<span id="cb7-444"><a href="#cb7-444"></a></span>
<span id="cb7-445"><a href="#cb7-445"></a><span class="fu">### JSON Pipelines</span></span>
<span id="cb7-446"><a href="#cb7-446"></a></span>
<span id="cb7-447"><a href="#cb7-447"></a>**Why JSON?** It’s friendly to automation and works nicely in Git. EA’s</span>
<span id="cb7-448"><a href="#cb7-448"></a>internal JScript has no JSON parser, so we recommend: **export JSON</span>
<span id="cb7-449"><a href="#cb7-449"></a>inside EA**, **import JSON externally** (Python).</span>
<span id="cb7-450"><a href="#cb7-450"></a></span>
<span id="cb7-451"><a href="#cb7-451"></a>**Export JSON (simple structure) inside EA**</span>
<span id="cb7-452"><a href="#cb7-452"></a></span>
<span id="cb7-453"><a href="#cb7-453"></a><span class="in">```{.js filename="Example 9.4 - ExportJSON_Package.js – JScript (ES3)"}</span></span>
<span id="cb7-454"><a href="#cb7-454"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb7-455"><a href="#cb7-455"></a><span class="co">// Example 9.4 - ExportJSON_Package.js – JScript (ES3)</span></span>
<span id="cb7-456"><a href="#cb7-456"></a><span class="co">// Purpose: Export selected package elements to a JSON file</span></span>
<span id="cb7-457"><a href="#cb7-457"></a><span class="co">// Usage: Select a package → run script → pick output folder</span></span>
<span id="cb7-458"><a href="#cb7-458"></a><span class="co">// Notes: JScript has no JSON.stringify, so we build JSON manually.</span></span>
<span id="cb7-459"><a href="#cb7-459"></a><span class="co">//        Keep values escaped and simple.</span></span>
<span id="cb7-460"><a href="#cb7-460"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb7-461"><a href="#cb7-461"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb7-462"><a href="#cb7-462"></a><span class="op">!</span>INC _Common<span class="op">.</span><span class="at">Helpers</span></span>
<span id="cb7-463"><a href="#cb7-463"></a></span>
<span id="cb7-464"><a href="#cb7-464"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb7-465"><a href="#cb7-465"></a>    <span class="kw">var</span> TAB <span class="op">=</span> <span class="st">"ExportJSON"</span><span class="op">;</span></span>
<span id="cb7-466"><a href="#cb7-466"></a>    <span class="fu">ensureOutputTab</span>(TAB)<span class="op">;</span></span>
<span id="cb7-467"><a href="#cb7-467"></a></span>
<span id="cb7-468"><a href="#cb7-468"></a>    <span class="kw">var</span> pkg <span class="op">=</span> Repository<span class="op">.</span><span class="fu">GetTreeSelectedPackage</span>()<span class="op">;</span></span>
<span id="cb7-469"><a href="#cb7-469"></a>    <span class="cf">if</span> (<span class="op">!</span>pkg) { Session<span class="op">.</span><span class="fu">Prompt</span>(<span class="st">"Select a package."</span><span class="op">,</span> promptOK)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb7-470"><a href="#cb7-470"></a></span>
<span id="cb7-471"><a href="#cb7-471"></a>    <span class="kw">var</span> outDir <span class="op">=</span> <span class="fu">browseForFolder</span>(<span class="st">"Select output folder (JSON)"</span>)<span class="op">;</span></span>
<span id="cb7-472"><a href="#cb7-472"></a>    <span class="cf">if</span> (<span class="op">!</span>outDir) { <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"Cancelled."</span>)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb7-473"><a href="#cb7-473"></a></span>
<span id="cb7-474"><a href="#cb7-474"></a>    <span class="kw">var</span> stamp <span class="op">=</span> (<span class="kw">new</span> <span class="bu">Date</span>())<span class="op">.</span><span class="fu">getTime</span>()<span class="op">;</span></span>
<span id="cb7-475"><a href="#cb7-475"></a>    <span class="kw">var</span> path  <span class="op">=</span> outDir <span class="op">+</span> <span class="st">"</span><span class="sc">\\</span><span class="st">export_"</span> <span class="op">+</span> <span class="fu">safeName</span>(pkg<span class="op">.</span><span class="at">Name</span>) <span class="op">+</span> <span class="st">"_"</span> <span class="op">+</span> stamp <span class="op">+</span> <span class="st">".json"</span><span class="op">;</span></span>
<span id="cb7-476"><a href="#cb7-476"></a></span>
<span id="cb7-477"><a href="#cb7-477"></a>    <span class="kw">var</span> fso  <span class="op">=</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span>(<span class="st">"Scripting.FileSystemObject"</span>)<span class="op">;</span></span>
<span id="cb7-478"><a href="#cb7-478"></a>    <span class="kw">var</span> file <span class="op">=</span> fso<span class="op">.</span><span class="fu">OpenTextFile</span>(path<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span> <span class="co">// 2=ForWriting</span></span>
<span id="cb7-479"><a href="#cb7-479"></a></span>
<span id="cb7-480"><a href="#cb7-480"></a>    file<span class="op">.</span><span class="fu">WriteLine</span>(<span class="st">"["</span>)<span class="op">;</span></span>
<span id="cb7-481"><a href="#cb7-481"></a>    <span class="kw">var</span> els <span class="op">=</span> pkg<span class="op">.</span><span class="at">Elements</span><span class="op">;</span></span>
<span id="cb7-482"><a href="#cb7-482"></a>    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>els<span class="op">.</span><span class="at">Count</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb7-483"><a href="#cb7-483"></a>        <span class="kw">var</span> e <span class="op">=</span> els<span class="op">.</span><span class="fu">GetAt</span>(i)<span class="op">;</span></span>
<span id="cb7-484"><a href="#cb7-484"></a>        <span class="kw">var</span> line <span class="op">=</span> <span class="st">"  {"</span> <span class="op">+</span></span>
<span id="cb7-485"><a href="#cb7-485"></a>            <span class="st">"</span><span class="sc">\"</span><span class="st">elementId</span><span class="sc">\"</span><span class="st">:"</span> <span class="op">+</span> e<span class="op">.</span><span class="at">ElementID</span> <span class="op">+</span> <span class="st">","</span> <span class="op">+</span></span>
<span id="cb7-486"><a href="#cb7-486"></a>            <span class="st">"</span><span class="sc">\"</span><span class="st">guid</span><span class="sc">\"</span><span class="st">:</span><span class="sc">\"</span><span class="st">"</span> <span class="op">+</span> <span class="fu">jsonEscape</span>(e<span class="op">.</span><span class="at">ElementGUID</span>) <span class="op">+</span> <span class="st">"</span><span class="sc">\"</span><span class="st">,"</span> <span class="op">+</span></span>
<span id="cb7-487"><a href="#cb7-487"></a>            <span class="st">"</span><span class="sc">\"</span><span class="st">name</span><span class="sc">\"</span><span class="st">:</span><span class="sc">\"</span><span class="st">"</span> <span class="op">+</span> <span class="fu">jsonEscape</span>(e<span class="op">.</span><span class="at">Name</span>) <span class="op">+</span> <span class="st">"</span><span class="sc">\"</span><span class="st">,"</span> <span class="op">+</span></span>
<span id="cb7-488"><a href="#cb7-488"></a>            <span class="st">"</span><span class="sc">\"</span><span class="st">type</span><span class="sc">\"</span><span class="st">:</span><span class="sc">\"</span><span class="st">"</span> <span class="op">+</span> <span class="fu">jsonEscape</span>(e<span class="op">.</span><span class="at">Type</span>) <span class="op">+</span> <span class="st">"</span><span class="sc">\"</span><span class="st">,"</span> <span class="op">+</span></span>
<span id="cb7-489"><a href="#cb7-489"></a>            <span class="st">"</span><span class="sc">\"</span><span class="st">stereotype</span><span class="sc">\"</span><span class="st">:</span><span class="sc">\"</span><span class="st">"</span> <span class="op">+</span> <span class="fu">jsonEscape</span>(<span class="bu">String</span>(e<span class="op">.</span><span class="at">Stereotype</span><span class="op">||</span><span class="st">""</span>)) <span class="op">+</span> <span class="st">"</span><span class="sc">\"</span><span class="st">"</span> <span class="op">+</span></span>
<span id="cb7-490"><a href="#cb7-490"></a>        <span class="st">"}"</span><span class="op">;</span></span>
<span id="cb7-491"><a href="#cb7-491"></a>        <span class="cf">if</span> (i <span class="op">&lt;</span> els<span class="op">.</span><span class="at">Count</span><span class="op">-</span><span class="dv">1</span>) line <span class="op">+=</span> <span class="st">","</span><span class="op">;</span></span>
<span id="cb7-492"><a href="#cb7-492"></a>        file<span class="op">.</span><span class="fu">WriteLine</span>(line)<span class="op">;</span></span>
<span id="cb7-493"><a href="#cb7-493"></a>    }</span>
<span id="cb7-494"><a href="#cb7-494"></a>    file<span class="op">.</span><span class="fu">WriteLine</span>(<span class="st">"]"</span>)<span class="op">;</span></span>
<span id="cb7-495"><a href="#cb7-495"></a></span>
<span id="cb7-496"><a href="#cb7-496"></a>    file<span class="op">.</span><span class="fu">Close</span>()<span class="op">;</span></span>
<span id="cb7-497"><a href="#cb7-497"></a>    <span class="fu">log</span>(TAB<span class="op">,</span> <span class="st">"JSON written → "</span> <span class="op">+</span> path)<span class="op">;</span></span>
<span id="cb7-498"><a href="#cb7-498"></a>}</span>
<span id="cb7-499"><a href="#cb7-499"></a><span class="kw">function</span> <span class="fu">jsonEscape</span>(s){ s<span class="op">=</span><span class="bu">String</span>(s<span class="op">||</span><span class="st">""</span>)<span class="op">;</span> <span class="cf">return</span> s<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\\</span><span class="ss">/g</span><span class="op">,</span><span class="st">"</span><span class="sc">\\\\</span><span class="st">"</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/"/g</span><span class="op">,</span><span class="st">'</span><span class="sc">\\</span><span class="st">"'</span>)<span class="op">;</span> }</span>
<span id="cb7-500"><a href="#cb7-500"></a><span class="kw">function</span> <span class="fu">safeName</span>(s){ <span class="cf">return</span> <span class="bu">String</span>(s<span class="op">||</span><span class="st">""</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">[^A-Za-z0-9_]+</span><span class="ss">/g</span><span class="op">,</span><span class="st">"_"</span>)<span class="op">;</span> }</span>
<span id="cb7-501"><a href="#cb7-501"></a></span>
<span id="cb7-502"><a href="#cb7-502"></a><span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb7-503"><a href="#cb7-503"></a><span class="in">```</span></span>
<span id="cb7-504"><a href="#cb7-504"></a></span>
<span id="cb7-505"><a href="#cb7-505"></a><span class="fu">### Import JSON externally (Python)</span></span>
<span id="cb7-506"><a href="#cb7-506"></a></span>
<span id="cb7-507"><a href="#cb7-507"></a>This importer:</span>
<span id="cb7-508"><a href="#cb7-508"></a></span>
<span id="cb7-509"><a href="#cb7-509"></a><span class="ss">- </span>Tries **GUID** first (GetElementByGuid/GetElementByGUID).</span>
<span id="cb7-510"><a href="#cb7-510"></a></span>
<span id="cb7-511"><a href="#cb7-511"></a><span class="ss">- </span>Falls back to **name + type within a package** (to avoid dupes).</span>
<span id="cb7-512"><a href="#cb7-512"></a></span>
<span id="cb7-513"><a href="#cb7-513"></a><span class="ss">- </span>Creates new elements if missing *(note: EA does not let you set GUIDs</span>
<span id="cb7-514"><a href="#cb7-514"></a>  via API; new elements get new GUIDs—store a mapping if you need</span>
<span id="cb7-515"><a href="#cb7-515"></a>  cross-walks)*.</span>
<span id="cb7-516"><a href="#cb7-516"></a></span>
<span id="cb7-517"><a href="#cb7-517"></a><span class="in">```{.py filename="Example 9.5 - import_json_into_ea.py – Python 3 (pywin32)"}</span></span>
<span id="cb7-518"><a href="#cb7-518"></a><span class="co"># -------------------------------------------------------</span></span>
<span id="cb7-519"><a href="#cb7-519"></a><span class="co"># Example 9.5 - import_json_into_ea.py – Python 3 (pywin32)</span></span>
<span id="cb7-520"><a href="#cb7-520"></a><span class="co"># Purpose: Import elements from JSON into a target package</span></span>
<span id="cb7-521"><a href="#cb7-521"></a><span class="co"># Usage: python import_json_into_ea.py "C:\...\export_Package_123.json" 1234</span></span>
<span id="cb7-522"><a href="#cb7-522"></a><span class="co">#   where 1234 is the target PackageID in EA</span></span>
<span id="cb7-523"><a href="#cb7-523"></a><span class="co"># Safety:</span></span>
<span id="cb7-524"><a href="#cb7-524"></a><span class="co">#   - Avoid duplicates by GUID first, else by (name,type,package)</span></span>
<span id="cb7-525"><a href="#cb7-525"></a><span class="co">#   - Log new GUIDs so you can maintain a cross-walk</span></span>
<span id="cb7-526"><a href="#cb7-526"></a><span class="co"># -------------------------------------------------------</span></span>
<span id="cb7-527"><a href="#cb7-527"></a><span class="im">import</span> sys, json, win32com.client</span>
<span id="cb7-528"><a href="#cb7-528"></a></span>
<span id="cb7-529"><a href="#cb7-529"></a><span class="kw">def</span> find_by_name_type(pkg, name, etype):</span>
<span id="cb7-530"><a href="#cb7-530"></a>    els <span class="op">=</span> pkg.Elements</span>
<span id="cb7-531"><a href="#cb7-531"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(els.Count):</span>
<span id="cb7-532"><a href="#cb7-532"></a>        e <span class="op">=</span> els.GetAt(i)</span>
<span id="cb7-533"><a href="#cb7-533"></a>        <span class="cf">if</span> e.Name <span class="op">==</span> name <span class="kw">and</span> e.Type <span class="op">==</span> etype:</span>
<span id="cb7-534"><a href="#cb7-534"></a>            <span class="cf">return</span> e</span>
<span id="cb7-535"><a href="#cb7-535"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb7-536"><a href="#cb7-536"></a></span>
<span id="cb7-537"><a href="#cb7-537"></a><span class="kw">def</span> main():</span>
<span id="cb7-538"><a href="#cb7-538"></a>    <span class="cf">if</span> <span class="bu">len</span>(sys.argv) <span class="op">&lt;</span> <span class="dv">3</span>:</span>
<span id="cb7-539"><a href="#cb7-539"></a>        <span class="bu">print</span>(<span class="st">"Usage: import_json_into_ea.py &lt;json_path&gt; &lt;target_package_id&gt;"</span>)</span>
<span id="cb7-540"><a href="#cb7-540"></a>        <span class="cf">return</span></span>
<span id="cb7-541"><a href="#cb7-541"></a></span>
<span id="cb7-542"><a href="#cb7-542"></a>    json_path <span class="op">=</span> sys.argv[<span class="dv">1</span>]</span>
<span id="cb7-543"><a href="#cb7-543"></a>    target_pkg_id <span class="op">=</span> <span class="bu">int</span>(sys.argv[<span class="dv">2</span>])</span>
<span id="cb7-544"><a href="#cb7-544"></a></span>
<span id="cb7-545"><a href="#cb7-545"></a>    ea <span class="op">=</span> win32com.client.Dispatch(<span class="st">"EA.App"</span>)</span>
<span id="cb7-546"><a href="#cb7-546"></a>    repo <span class="op">=</span> ea.Repository</span>
<span id="cb7-547"><a href="#cb7-547"></a>    pkg <span class="op">=</span> repo.GetPackageByID(target_pkg_id)</span>
<span id="cb7-548"><a href="#cb7-548"></a>    <span class="cf">if</span> <span class="kw">not</span> pkg:</span>
<span id="cb7-549"><a href="#cb7-549"></a>        <span class="bu">print</span>(<span class="st">"Target package not found:"</span>, target_pkg_id)<span class="op">;</span> <span class="cf">return</span></span>
<span id="cb7-550"><a href="#cb7-550"></a></span>
<span id="cb7-551"><a href="#cb7-551"></a>    data <span class="op">=</span> json.load(<span class="bu">open</span>(json_path, <span class="st">"r"</span>))</span>
<span id="cb7-552"><a href="#cb7-552"></a></span>
<span id="cb7-553"><a href="#cb7-553"></a>    created, updated <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb7-554"><a href="#cb7-554"></a>    <span class="cf">for</span> item <span class="kw">in</span> data:</span>
<span id="cb7-555"><a href="#cb7-555"></a>        guid <span class="op">=</span> item.get(<span class="st">"guid"</span>,<span class="st">""</span>)</span>
<span id="cb7-556"><a href="#cb7-556"></a>        name <span class="op">=</span> item.get(<span class="st">"name"</span>,<span class="st">""</span>)</span>
<span id="cb7-557"><a href="#cb7-557"></a>        etype<span class="op">=</span> item.get(<span class="st">"type"</span>,<span class="st">"Class"</span>)</span>
<span id="cb7-558"><a href="#cb7-558"></a>        stereo<span class="op">=</span>item.get(<span class="st">"stereotype"</span>,<span class="st">""</span>)</span>
<span id="cb7-559"><a href="#cb7-559"></a></span>
<span id="cb7-560"><a href="#cb7-560"></a>        el <span class="op">=</span> <span class="va">None</span></span>
<span id="cb7-561"><a href="#cb7-561"></a>        <span class="cf">if</span> guid:</span>
<span id="cb7-562"><a href="#cb7-562"></a>            <span class="cf">try</span>:</span>
<span id="cb7-563"><a href="#cb7-563"></a>                el <span class="op">=</span> repo.GetElementByGuid(guid)  <span class="co"># newer EA</span></span>
<span id="cb7-564"><a href="#cb7-564"></a>            <span class="cf">except</span>:</span>
<span id="cb7-565"><a href="#cb7-565"></a>                <span class="cf">try</span>:</span>
<span id="cb7-566"><a href="#cb7-566"></a>                    el <span class="op">=</span> repo.GetElementByGUID(guid)  <span class="co"># older EA</span></span>
<span id="cb7-567"><a href="#cb7-567"></a>                <span class="cf">except</span>:</span>
<span id="cb7-568"><a href="#cb7-568"></a>                    el <span class="op">=</span> <span class="va">None</span></span>
<span id="cb7-569"><a href="#cb7-569"></a></span>
<span id="cb7-570"><a href="#cb7-570"></a>        <span class="cf">if</span> <span class="kw">not</span> el:</span>
<span id="cb7-571"><a href="#cb7-571"></a>            el <span class="op">=</span> find_by_name_type(pkg, name, etype)</span>
<span id="cb7-572"><a href="#cb7-572"></a></span>
<span id="cb7-573"><a href="#cb7-573"></a>        <span class="cf">if</span> <span class="kw">not</span> el:</span>
<span id="cb7-574"><a href="#cb7-574"></a>            el <span class="op">=</span> pkg.Elements.AddNew(name, etype)</span>
<span id="cb7-575"><a href="#cb7-575"></a>            el.Stereotype <span class="op">=</span> stereo</span>
<span id="cb7-576"><a href="#cb7-576"></a>            el.Update()</span>
<span id="cb7-577"><a href="#cb7-577"></a>            created <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb7-578"><a href="#cb7-578"></a>            <span class="co"># </span><span class="al">NOTE</span><span class="co">: el.ElementGUID is NEW and cannot be set via API.</span></span>
<span id="cb7-579"><a href="#cb7-579"></a>            <span class="bu">print</span>(<span class="ss">f"Created: </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>etype<span class="sc">}</span><span class="ss">) NEW_GUID=</span><span class="sc">{</span>el<span class="sc">.</span>ElementGUID<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-580"><a href="#cb7-580"></a>        <span class="cf">else</span>:</span>
<span id="cb7-581"><a href="#cb7-581"></a>            dirty <span class="op">=</span> <span class="va">False</span></span>
<span id="cb7-582"><a href="#cb7-582"></a>            <span class="cf">if</span> stereo <span class="kw">and</span> el.Stereotype <span class="op">!=</span> stereo:</span>
<span id="cb7-583"><a href="#cb7-583"></a>                el.Stereotype <span class="op">=</span> stereo<span class="op">;</span> dirty <span class="op">=</span> <span class="va">True</span></span>
<span id="cb7-584"><a href="#cb7-584"></a>            <span class="cf">if</span> dirty:</span>
<span id="cb7-585"><a href="#cb7-585"></a>                el.Update()<span class="op">;</span> updated <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb7-586"><a href="#cb7-586"></a></span>
<span id="cb7-587"><a href="#cb7-587"></a>    <span class="cf">if</span> created <span class="kw">or</span> updated:</span>
<span id="cb7-588"><a href="#cb7-588"></a>        repo.RefreshModelView(pkg.PackageID)</span>
<span id="cb7-589"><a href="#cb7-589"></a></span>
<span id="cb7-590"><a href="#cb7-590"></a>    <span class="bu">print</span>(<span class="ss">f"Done. Created=</span><span class="sc">{</span>created<span class="sc">}</span><span class="ss">, Updated=</span><span class="sc">{</span>updated<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-591"><a href="#cb7-591"></a></span>
<span id="cb7-592"><a href="#cb7-592"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb7-593"><a href="#cb7-593"></a>    main()</span>
<span id="cb7-594"><a href="#cb7-594"></a><span class="in">```</span></span>
<span id="cb7-595"><a href="#cb7-595"></a></span>
<span id="cb7-596"><a href="#cb7-596"></a>**GUID reality check**: EA’s API exposes ElementGUID but does **not**</span>
<span id="cb7-597"><a href="#cb7-597"></a>let you set it for new elements. If you must preserve GUIDs from an</span>
<span id="cb7-598"><a href="#cb7-598"></a>external master, consider **XMI import** or EA’s native importers.</span>
<span id="cb7-599"><a href="#cb7-599"></a>Otherwise, store a **cross-walk CSV** of {external_id → EA GUID} after</span>
<span id="cb7-600"><a href="#cb7-600"></a>creation.</span>
<span id="cb7-601"><a href="#cb7-601"></a></span>
<span id="cb7-602"><a href="#cb7-602"></a><span class="fu">## Managing GUIDs &amp; Avoiding Duplicates</span></span>
<span id="cb7-603"><a href="#cb7-603"></a></span>
<span id="cb7-604"><a href="#cb7-604"></a>**Best-practice order of matching:**</span>
<span id="cb7-605"><a href="#cb7-605"></a></span>
<span id="cb7-606"><a href="#cb7-606"></a><span class="ss">- </span>**GUID** (strongest identity) → GetElementByGUID/GetElementByGuid.</span>
<span id="cb7-607"><a href="#cb7-607"></a></span>
<span id="cb7-608"><a href="#cb7-608"></a><span class="ss">- </span>**Stable external key** (your own code) if you maintain one as a</span>
<span id="cb7-609"><a href="#cb7-609"></a>  tagged value, e.g., ExternalID.</span>
<span id="cb7-610"><a href="#cb7-610"></a></span>
<span id="cb7-611"><a href="#cb7-611"></a><span class="ss">- </span>**Name + Type + Package** (weaker; beware rename collisions).</span>
<span id="cb7-612"><a href="#cb7-612"></a></span>
<span id="cb7-613"><a href="#cb7-613"></a>**For new items:**</span>
<span id="cb7-614"><a href="#cb7-614"></a></span>
<span id="cb7-615"><a href="#cb7-615"></a><span class="ss">- </span>You cannot set EA GUIDs via API; EA assigns them.</span>
<span id="cb7-616"><a href="#cb7-616"></a></span>
<span id="cb7-617"><a href="#cb7-617"></a><span class="ss">- </span>Immediately log {externalKey → new EA GUID} to a CSV so future updates</span>
<span id="cb7-618"><a href="#cb7-618"></a>  can target the same element.</span>
<span id="cb7-619"><a href="#cb7-619"></a></span>
<span id="cb7-620"><a href="#cb7-620"></a>**Avoiding duplicates:**</span>
<span id="cb7-621"><a href="#cb7-621"></a></span>
<span id="cb7-622"><a href="#cb7-622"></a><span class="ss">- </span>Before creating, **search for existing** by GUID or external key.</span>
<span id="cb7-623"><a href="#cb7-623"></a></span>
<span id="cb7-624"><a href="#cb7-624"></a><span class="ss">- </span>If you must use name/type, scope the search to the target package (or</span>
<span id="cb7-625"><a href="#cb7-625"></a>  run an **SQLQuery** to check repository-wide).</span>
<span id="cb7-626"><a href="#cb7-626"></a></span>
<span id="cb7-627"><a href="#cb7-627"></a><span class="ss">- </span>Build imports as **two-phase**: curate first, then apply, so humans</span>
<span id="cb7-628"><a href="#cb7-628"></a>  can resolve ambiguous matches.</span>
<span id="cb7-629"><a href="#cb7-629"></a></span>
<span id="cb7-630"><a href="#cb7-630"></a><span class="fu">## Scaling Up (Performance)</span></span>
<span id="cb7-631"><a href="#cb7-631"></a></span>
<span id="cb7-632"><a href="#cb7-632"></a><span class="ss">- </span>Use **SQL for finding**, **API for writing** (Pattern 5 in Chapter 6).</span>
<span id="cb7-633"><a href="#cb7-633"></a></span>
<span id="cb7-634"><a href="#cb7-634"></a><span class="ss">- </span>Batch large updates (e.g., 250 elements) and refresh the UI at the</span>
<span id="cb7-635"><a href="#cb7-635"></a>  end.</span>
<span id="cb7-636"><a href="#cb7-636"></a></span>
<span id="cb7-637"><a href="#cb7-637"></a><span class="ss">- </span>Keep logs: write a CSV of every change (old → new).</span>
<span id="cb7-638"><a href="#cb7-638"></a></span>
<span id="cb7-639"><a href="#cb7-639"></a>**Example**: fast existence check before creating</span>
<span id="cb7-640"><a href="#cb7-640"></a></span>
<span id="cb7-641"><a href="#cb7-641"></a><span class="in">```{.js filename="Example 9.6 - ExistsByNameType_SQL.js – JScript (ES3)"}</span></span>
<span id="cb7-642"><a href="#cb7-642"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb7-643"><a href="#cb7-643"></a><span class="co">// Example 9.6 - ExistsByNameType_SQL.js – JScript (ES3)</span></span>
<span id="cb7-644"><a href="#cb7-644"></a><span class="co">// Purpose: Repository-wide check if (Name,Type) exists; returns first Object_ID</span></span>
<span id="cb7-645"><a href="#cb7-645"></a><span class="co">// Notes: SQLQuery returns XML; we do a tiny string parse</span></span>
<span id="cb7-646"><a href="#cb7-646"></a><span class="co">// -------------------------------------------------------</span></span>
<span id="cb7-647"><a href="#cb7-647"></a><span class="op">!</span>INC Local Scripts<span class="op">.</span><span class="at">EAConstants</span><span class="op">-</span>JScript</span>
<span id="cb7-648"><a href="#cb7-648"></a></span>
<span id="cb7-649"><a href="#cb7-649"></a><span class="kw">function</span> <span class="fu">existsByNameType</span>(name<span class="op">,</span> type) {</span>
<span id="cb7-650"><a href="#cb7-650"></a>    <span class="kw">var</span> sql <span class="op">=</span> <span class="st">"SELECT TOP 1 Object_ID FROM t_object WHERE Name='"</span> <span class="op">+</span> <span class="fu">esc</span>(name) <span class="op">+</span> <span class="st">"' AND Object_Type='"</span> <span class="op">+</span> <span class="fu">esc</span>(type) <span class="op">+</span> <span class="st">"'"</span><span class="op">;</span></span>
<span id="cb7-651"><a href="#cb7-651"></a>    <span class="kw">var</span> xml <span class="op">=</span> Repository<span class="op">.</span><span class="fu">SQLQuery</span>(sql)<span class="op">;</span></span>
<span id="cb7-652"><a href="#cb7-652"></a>    <span class="kw">var</span> id <span class="op">=</span> <span class="fu">between</span>(xml<span class="op">,</span> <span class="st">"&lt;Object_ID&gt;"</span><span class="op">,</span> <span class="st">"&lt;/Object_ID&gt;"</span>)<span class="op">;</span></span>
<span id="cb7-653"><a href="#cb7-653"></a>    <span class="cf">return</span> id <span class="op">?</span> <span class="pp">parseInt</span>(id<span class="op">,</span><span class="dv">10</span>) <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-654"><a href="#cb7-654"></a>}</span>
<span id="cb7-655"><a href="#cb7-655"></a></span>
<span id="cb7-656"><a href="#cb7-656"></a><span class="kw">function</span> <span class="fu">esc</span>(s){ </span>
<span id="cb7-657"><a href="#cb7-657"></a>  <span class="cf">return</span> <span class="bu">String</span>(s<span class="op">||</span><span class="st">""</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/'/g</span><span class="op">,</span><span class="st">"''"</span>)<span class="op">;</span> </span>
<span id="cb7-658"><a href="#cb7-658"></a>}</span>
<span id="cb7-659"><a href="#cb7-659"></a></span>
<span id="cb7-660"><a href="#cb7-660"></a><span class="kw">function</span> <span class="fu">between</span>(h<span class="op">,</span> a<span class="op">,</span> b){ </span>
<span id="cb7-661"><a href="#cb7-661"></a>  <span class="kw">var</span> i<span class="op">=</span>h<span class="op">.</span><span class="fu">indexOf</span>(a)<span class="op">;</span> </span>
<span id="cb7-662"><a href="#cb7-662"></a>  <span class="cf">if</span>(i<span class="op">&lt;</span><span class="dv">0</span>) <span class="cf">return</span> <span class="st">""</span><span class="op">;</span> </span>
<span id="cb7-663"><a href="#cb7-663"></a>  <span class="kw">var</span> j<span class="op">=</span>h<span class="op">.</span><span class="fu">indexOf</span>(b<span class="op">,</span>i<span class="op">+</span>a<span class="op">.</span><span class="at">length</span>)<span class="op">;</span> </span>
<span id="cb7-664"><a href="#cb7-664"></a>  <span class="cf">return</span> j<span class="op">&lt;</span><span class="dv">0</span><span class="op">?</span><span class="st">""</span><span class="op">:</span>h<span class="op">.</span><span class="fu">substring</span>(i<span class="op">+</span>a<span class="op">.</span><span class="at">length</span><span class="op">,</span>j)<span class="op">;</span> </span>
<span id="cb7-665"><a href="#cb7-665"></a>}</span>
<span id="cb7-666"><a href="#cb7-666"></a><span class="in">```</span></span>
<span id="cb7-667"><a href="#cb7-667"></a></span>
<span id="cb7-668"><a href="#cb7-668"></a><span class="fu">## Safety Checklist</span></span>
<span id="cb7-669"><a href="#cb7-669"></a></span>
<span id="cb7-670"><a href="#cb7-670"></a><span class="ss">- </span>**Dry-run first** (or export-curate-apply).</span>
<span id="cb7-671"><a href="#cb7-671"></a></span>
<span id="cb7-672"><a href="#cb7-672"></a><span class="ss">- </span>**Back up** repositories (or work on a copy).</span>
<span id="cb7-673"><a href="#cb7-673"></a></span>
<span id="cb7-674"><a href="#cb7-674"></a><span class="ss">- </span>**Log everything** (CSV with old/new values).</span>
<span id="cb7-675"><a href="#cb7-675"></a></span>
<span id="cb7-676"><a href="#cb7-676"></a><span class="ss">- </span>**Update()** every modified object; **RefreshModelView()** to show</span>
<span id="cb7-677"><a href="#cb7-677"></a>  changes.</span>
<span id="cb7-678"><a href="#cb7-678"></a></span>
<span id="cb7-679"><a href="#cb7-679"></a><span class="ss">- </span>Prefer **CSV/JSON for input**, Excel only when required.</span>
<span id="cb7-680"><a href="#cb7-680"></a></span>
<span id="cb7-681"><a href="#cb7-681"></a><span class="ss">- </span>For rich parsing, do it **externally** (Python) and keep in-EA scripts</span>
<span id="cb7-682"><a href="#cb7-682"></a>  small and safe.</span>
<span id="cb7-683"><a href="#cb7-683"></a></span>
<span id="cb7-684"><a href="#cb7-684"></a><span class="fu">## What to use when</span></span>
<span id="cb7-685"><a href="#cb7-685"></a></span>
<span id="cb7-686"><a href="#cb7-686"></a><span class="ss">- </span>Quick exports for review → CSV export (8.1.1).</span>
<span id="cb7-687"><a href="#cb7-687"></a></span>
<span id="cb7-688"><a href="#cb7-688"></a><span class="ss">- </span>Curated updates → CSV apply (8.1.2) or Python CSV/JSON importer</span>
<span id="cb7-689"><a href="#cb7-689"></a>  (8.3.2).</span>
<span id="cb7-690"><a href="#cb7-690"></a></span>
<span id="cb7-691"><a href="#cb7-691"></a><span class="ss">- </span>Stakeholder-friendly spreadsheet → Excel export (8.2.1).</span>
<span id="cb7-692"><a href="#cb7-692"></a></span>
<span id="cb7-693"><a href="#cb7-693"></a><span class="ss">- </span>Dev pipelines / Git → JSON export (8.3.1) + Python importer (8.3.2).</span>
<span id="cb7-694"><a href="#cb7-694"></a></span>
<span id="cb7-695"><a href="#cb7-695"></a><span class="ss">- </span>Strong identity → prefer GUIDs or your own ExternalID tagged value.</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>